/*! For license information please see e42127896f084e84aee9.js.LICENSE.txt */
function ownKeys(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,a)}return t}function _objectSpread(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(t),!0).forEach(function(n){_defineProperty(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function _defineProperty(e,n,t){return(n=_toPropertyKey(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function _toPropertyKey(e){var n=_toPrimitive(e,"string");return"symbol"==_typeof(n)?n:n+""}function _toPrimitive(e,n){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,n||"default");if("object"!=_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}function _slicedToArray(e,n){return _arrayWithHoles(e)||_iterableToArrayLimit(e,n)||_unsupportedIterableToArray(e,n)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,o,r,i,l=[],c=!0,s=!1;try{if(r=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(a=r.call(t)).done)&&(l.push(a.value),l.length!==n);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=_unsupportedIterableToArray(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){l=!0,r=e},f:function(){try{i||null==t.return||t.return()}finally{if(l)throw r}}}}function _unsupportedIterableToArray(e,n){if(e){if("string"==typeof e)return _arrayLikeToArray(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,n):void 0}}function _arrayLikeToArray(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=Array(n);t<n;t++)a[t]=e[t];return a}function _regenerator(){var e,n,t="function"==typeof Symbol?Symbol:{},a=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function r(t,a,o,r){var c=a&&a.prototype instanceof l?a:l,s=Object.create(c.prototype);return _regeneratorDefine2(s,"_invoke",function(t,a,o){var r,l,c,s=0,d=o||[],u=!1,p={p:0,n:0,v:e,a:y,f:y.bind(e,4),d:function(n,t){return r=n,l=0,c=e,p.n=t,i}};function y(t,a){for(l=t,c=a,n=0;!u&&s&&!o&&n<d.length;n++){var o,r=d[n],y=p.p,f=r[2];t>3?(o=f===a)&&(c=r[(l=r[4])?5:(l=3,3)],r[4]=r[5]=e):r[0]<=y&&((o=t<2&&y<r[1])?(l=0,p.v=a,p.n=r[1]):y<f&&(o=t<3||r[0]>a||a>f)&&(r[4]=t,r[5]=a,p.n=f,l=0))}if(o||t>1)return i;throw u=!0,a}return function(o,d,f){if(s>1)throw TypeError("Generator is already running");for(u&&1===d&&y(d,f),l=d,c=f;(n=l<2?e:c)||!u;){r||(l?l<3?(l>1&&(p.n=-1),y(l,c)):p.n=c:p.v=c);try{if(s=2,r){if(l||(o="next"),n=r[o]){if(!(n=n.call(r,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,l<2&&(l=0)}else 1===l&&(n=r.return)&&n.call(r),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);r=e}else if((n=(u=p.n<0)?c:t.call(a,p))!==i)break}catch(n){r=e,l=1,c=n}finally{s=1}}return{value:n,done:u}}}(t,o,r),!0),s}var i={};function l(){}function c(){}function s(){}n=Object.getPrototypeOf;var d=[][a]?n(n([][a]())):(_regeneratorDefine2(n={},a,function(){return this}),n),u=s.prototype=l.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return c.prototype=s,_regeneratorDefine2(u,"constructor",s),_regeneratorDefine2(s,"constructor",c),c.displayName="GeneratorFunction",_regeneratorDefine2(s,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,a,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:r,m:p}})()}function _regeneratorDefine2(e,n,t,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_regeneratorDefine2=function(e,n,t,a){function r(n,t){_regeneratorDefine2(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[n]=t:(r("next",0),r("throw",1),r("return",2))},_regeneratorDefine2(e,n,t,a)}function asyncGeneratorStep(e,n,t,a,o,r,i){try{var l=e[r](i),c=l.value}catch(e){return void t(e)}l.done?n(c):Promise.resolve(c).then(a,o)}function _asyncToGenerator(e){return function(){var n=this,t=arguments;return new Promise(function(a,o){var r=e.apply(n,t);function i(e){asyncGeneratorStep(r,a,o,i,l,"next",e)}function l(e){asyncGeneratorStep(r,a,o,i,l,"throw",e)}i(void 0)})}}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}import{CalendarSyncManager}from"./calendarSync.js";import{MultiAccountUI}from"./multiAccountUI.js";var syncManager,multiAccountUI;function showContextGuidance(){document.getElementById("sideload-msg").innerHTML='\n    <div style="color: #d63031; padding: 15px; border: 1px solid #d63031; border-radius: 8px; margin: 10px;">\n      <h3>üö® Office.js Context Required</h3>\n      <p><strong>Issue:</strong> This add-in needs to run within Microsoft Outlook to access Office.js APIs.</p>\n      \n      <h4>üìã How to test this add-in properly:</h4>\n      <ol style="text-align: left; margin: 10px 0;">\n        <li><strong>Deploy the manifest:</strong> Upload <code>manifest.xml</code> to Microsoft 365 Admin Center</li>\n        <li><strong>Open Outlook:</strong> Use Outlook desktop app or Outlook on the web</li>\n        <li><strong>Find the add-in:</strong> Look for "Sync Calendars" button in the ribbon</li>\n        <li><strong>Click to open:</strong> The add-in will load in a proper Office.js context</li>\n      </ol>\n      \n      <h4>üîß For development testing:</h4>\n      <ul style="text-align: left; margin: 10px 0;">\n        <li>Use <code>npm run dev-server</code> and sideload in Outlook</li>\n        <li>Or use Office Add-in Development Tools</li>\n        <li>Direct browser testing won\'t have full Office.js capabilities</li>\n      </ul>\n      \n      <p><strong>Current context:</strong> '.concat(window.location.href,'</p>\n      <button onclick="testMockMode();" style="background: #0984e3; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin: 5px;">\n        Test with Mock Data\n      </button>\n      <button onclick="location.reload();" style="background: #636e72; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin: 5px;">\n        Refresh\n      </button>\n    </div>\n  ')}function testMockMode(){console.log("üß™ Enabling mock mode for testing without Office.js"),document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var e=new Date("2025-08-12");document.getElementById("sync-date").value=e.toISOString().split("T")[0],syncManager=new CalendarSyncManager,initializeApp()}function initializeApp(){return _initializeApp.apply(this,arguments)}function _initializeApp(){return(_initializeApp=_asyncToGenerator(_regenerator().m(function e(){var n,t,a;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("ÔøΩ Starting Multi-Tenant Calendar Sync initialization..."),window.multiTenantManager?(multiAccountUI=new MultiAccountUI(window.multiTenantManager),window.multiAccountUI=multiAccountUI,multiAccountUI.initialize(),n=document.getElementById("status-section"),t=document.getElementById("calendar-section"),n&&(n.style.display="none"),t&&(t.style.display="none"),console.log("‚úÖ Multi-account interface initialized")):(console.warn("‚ö†Ô∏è Multi-tenant manager not available, falling back to simple mode"),window.calendarAuth&&window.calendarAuth.renderAuthenticationOptions()),setupEventListeners(),e.n=1,syncManager.initialize();case 1:updateSyncStatus("ready","Ready to sync"),console.log("‚úÖ Multi-tenant calendar sync initialized successfully"),e.n=3;break;case 2:e.p=2,a=e.v,console.error("‚ùå App initialization failed:",a),updateSyncStatus("error","Initialization failed: ".concat(a.message)),showContextGuidance();case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function setupEventListeners(){console.log("‚öôÔ∏è Setting up event listeners...");var e=document.getElementById("run-diagnostic");e&&e.addEventListener("click",runCalendarDiagnostic);var n=document.getElementById("run-sync");n&&n.addEventListener("click",runSync);var t=document.getElementById("configure");t&&t.addEventListener("click",showSettings),console.log("‚úÖ Event listeners set up")}function runCalendarDiagnostic(){return _runCalendarDiagnostic.apply(this,arguments)}function _runCalendarDiagnostic(){return(_runCalendarDiagnostic=_asyncToGenerator(_regenerator().m(function e(){var n,t,a,o,r,i,l,c;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return console.log("üîç Running calendar discovery diagnostic..."),n=document.getElementById("run-diagnostic"),t=document.getElementById("diagnostic-results"),n&&(n.disabled=!0,n.innerHTML='<span class="ms-Button-label">üîÑ Checking...</span>'),e.p=1,a=new CalendarDiscoveryDiagnostic,e.n=2,a.runFullDiagnostic();case 2:o=e.v,t&&(r=o.graphApiResults.calendarsFound.length,i=o.graphApiResults.accessTokenObtained,t.innerHTML='\n        <div class="diagnostic-summary">\n          <h4>üìä Discovery Results:</h4>\n          <p><strong>Graph API Auth:</strong> '.concat(i?"‚úÖ Working":"‚ùå Failed","</p>\n          <p><strong>Calendars Found:</strong> ").concat(r," calendar(s)</p>\n          ").concat(r>0?'\n            <div class="calendar-list">\n              <strong>Found calendars:</strong>\n              <ul>\n                '.concat(o.graphApiResults.calendarsFound.map(function(e){return"<li>üìÖ ".concat(e.name," ").concat(e.isDefaultCalendar?"(Default)":"","</li>")}).join(""),"\n              </ul>\n            </div>\n          "):"\n            <p><em>This means Graph API can only see calendars from your current Office 365/Exchange account.</em></p>\n            <p><em>Connected accounts (Gmail, other Exchange) won't appear here.</em></p>\n          ",'\n          <button id="add-external-calendar" class="ms-Button" style="margin-top: 10px;">\n            <span class="ms-Button-label">‚ûï Add External Calendar</span>\n          </button>\n        </div>\n      '),(l=document.getElementById("add-external-calendar"))&&l.addEventListener("click",showAddExternalCalendar)),e.n=4;break;case 3:e.p=3,c=e.v,console.error("‚ùå Diagnostic failed:",c),t&&(t.innerHTML='\n        <div class="error-message">\n          <p><strong>‚ùå Diagnostic Failed:</strong> '.concat(c.message,"</p>\n          <p><em>This likely means you're not in a proper Office.js context or don't have the necessary permissions.</em></p>\n        </div>\n      "));case 4:return e.p=4,n&&(n.disabled=!1,n.innerHTML='<span class="ms-Button-label">üîç Check My Calendars</span>'),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}))).apply(this,arguments)}function showAddExternalCalendar(){var e=document.getElementById("diagnostic-results");e&&(e.innerHTML+='\n    <div class="add-calendar-section" style="margin-top: 15px; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">\n      <h4>‚ûï Add External Calendar</h4>\n      <p>To sync calendars from other accounts, choose an option:</p>\n      \n      <div class="calendar-options">\n        <button class="calendar-type-btn" onclick="addGoogleCalendar()">\n          üìß Google Calendar\n        </button>\n        <button class="calendar-type-btn" onclick="addOutlookCalendar()">\n          üìÆ Outlook.com/Hotmail\n        </button>\n        <button class="calendar-type-btn" onclick="addExchangeCalendar()">\n          üè¢ Exchange Server\n        </button>\n        <button class="calendar-type-btn" onclick="addICSCalendar()">\n          üîó ICS/WebCal URL\n        </button>\n      </div>\n      \n      <div id="calendar-form-container" style="margin-top: 10px;">\n        \x3c!-- Calendar form will be inserted here --\x3e\n      </div>\n    </div>\n  ')}function loadCalendars(){return _loadCalendars.apply(this,arguments)}function _loadCalendars(){return(_loadCalendars=_asyncToGenerator(_regenerator().m(function e(){var n;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,syncManager.getAvailableCalendars();case 1:displayCalendars(e.v),e.n=3;break;case 2:e.p=2,n=e.v,console.error("Failed to load calendars:",n),document.getElementById("calendar-list").innerHTML='<div class="error">Failed to load calendars. Please check permissions.</div>';case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function displayCalendars(e){var n=document.getElementById("calendar-list");0!==e.length?n.innerHTML=e.map(function(e){return'\n    <div class="calendar-item">\n      <div>\n        <div class="calendar-name">'.concat(e.name,'</div>\n        <div class="calendar-status">').concat(e.type," ‚Ä¢ ").concat(e.itemCount,' items</div>\n      </div>\n      <div class="calendar-toggle">\n        <div class="toggle-switch ').concat(e.syncEnabled?"active":"",'" \n             data-calendar-id="').concat(e.id,'"\n             onclick="toggleCalendarSync(\'').concat(e.id,"')\">\n        </div>\n      </div>\n    </div>\n  ")}).join(""):n.innerHTML='<div class="no-activity">No calendars found</div>'}function handleSyncNow(){return _handleSyncNow.apply(this,arguments)}function _handleSyncNow(){return(_handleSyncNow=_asyncToGenerator(_regenerator().m(function e(){var n,t,a,o;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=document.getElementById("sync-date").value){e.n=1;break}return updateStatus("Error","Please select a date to sync"),e.a(2);case 1:return t=new Date(n),updateStatus("Syncing","Syncing ".concat(t.toLocaleDateString(),"...")),updateSyncButton(!0),e.n=2,syncManager.performSync(t);case 2:a=e.v,updateStatus("Active","Sync completed for ".concat(t.toLocaleDateString(),". ").concat(a.blocksCreated," blocks created, ").concat(a.blocksRemoved," removed.")),addActivityLog("Sync completed for ".concat(t.toLocaleDateString(),": ").concat(a.blocksCreated," created, ").concat(a.blocksRemoved," removed")),e.n=4;break;case 3:e.p=3,o=e.v,console.error("Sync failed:",o),updateStatus("Error","Sync failed: ".concat(o.message)),addActivityLog("Sync failed: ".concat(o.message));case 4:return e.p=4,updateSyncButton(!1),e.f(4);case 5:return e.a(2)}},e,null,[[0,3,4,5]])}))).apply(this,arguments)}function handleConfigure(){return _handleConfigure.apply(this,arguments)}function _handleConfigure(){return(_handleConfigure=_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:console.log("Configure clicked");case 1:return e.a(2)}},e)}))).apply(this,arguments)}function toggleCalendarSync(e){return _toggleCalendarSync.apply(this,arguments)}function _toggleCalendarSync(){return(_toggleCalendarSync=_asyncToGenerator(_regenerator().m(function e(n){var t,a,o;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,syncManager.toggleCalendarSync(n);case 1:t=e.v,(a=document.querySelector('[data-calendar-id="'.concat(n,'"]')))&&a.classList.toggle("active",t),addActivityLog("Calendar sync ".concat(t?"enabled":"disabled"," for calendar")),e.n=3;break;case 2:e.p=2,o=e.v,console.error("Failed to toggle calendar sync:",o),addActivityLog("Failed to toggle calendar sync: ".concat(o.message));case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function updateSyncStatus(){return _updateSyncStatus.apply(this,arguments)}function _updateSyncStatus(){return(_updateSyncStatus=_asyncToGenerator(_regenerator().m(function e(){var n,t;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,syncManager.getSyncStatus();case 1:updateStatus((n=e.v).state,n.message),n.lastSync&&(document.getElementById("last-sync").textContent="Last sync: ".concat(new Date(n.lastSync).toLocaleString())),e.n=3;break;case 2:e.p=2,t=e.v,console.error("Failed to get sync status:",t),updateStatus("Error","Unable to check sync status");case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function updateStatus(e,n){var t=document.getElementById("status-dot"),a=document.getElementById("status-text");switch(t.classList.remove("active","syncing"),e.toLowerCase()){case"active":t.classList.add("active");break;case"syncing":t.classList.add("syncing")}a.textContent=n}function updateSyncButton(e){var n=document.getElementById("sync-now"),t=n.querySelector(".ms-Button-label");n.style.opacity=e?"0.6":"1",n.style.pointerEvents=e?"none":"auto",t.textContent=e?"Syncing...":"Sync Now"}function addActivityLog(e){var n=document.getElementById("activity-log"),t=n.querySelector(".no-activity");t&&t.remove();var a=document.createElement("div");a.className="activity-item",a.innerHTML='\n    <div class="activity-time">'.concat((new Date).toLocaleTimeString(),"</div>\n    <div>").concat(e,"</div>\n  "),n.insertBefore(a,n.firstChild);var o=n.querySelectorAll(".activity-item");o.length>10&&o[o.length-1].remove()}function showCalendarForm(e,n,t){var a=document.getElementById("calendar-form-container");if(a){var o=t.fields.map(function(e){return'\n    <div class="form-field" style="margin: 10px 0;">\n      <label for="'.concat(e.name,'" style="display: block; font-weight: bold; margin-bottom: 5px;">\n        ').concat(e.label," ").concat(e.required?"*":"",'\n      </label>\n      <input \n        type="').concat(e.type,'" \n        id="').concat(e.name,'" \n        name="').concat(e.name,'"\n        placeholder="').concat(e.placeholder||"",'"\n        value="').concat(e.value||"",'"\n        ').concat(e.required?"required":"",'\n        style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;"\n      />\n    </div>\n  ')}).join("");a.innerHTML='\n    <div class="calendar-form">\n      <h5>üìù Add '.concat(n,'</h5>\n      <p style="font-size: 0.9em; color: #666;">').concat(t.instructions,'</p>\n      \n      <form id="add-calendar-form">\n        <input type="hidden" name="type" value="').concat(e,'" />\n        ').concat(o,'\n        \n        <div class="form-actions" style="margin-top: 15px;">\n          <button type="submit" class="ms-Button ms-Button--primary">\n            <span class="ms-Button-label">üîó Connect Calendar</span>\n          </button>\n          <button type="button" onclick="cancelCalendarForm()" class="ms-Button" style="margin-left: 10px;">\n            <span class="ms-Button-label">Cancel</span>\n          </button>\n        </div>\n      </form>\n    </div>\n  ');var r=document.getElementById("add-calendar-form");r&&r.addEventListener("submit",handleCalendarFormSubmit)}}function handleCalendarFormSubmit(e){return _handleCalendarFormSubmit.apply(this,arguments)}function _handleCalendarFormSubmit(){return(_handleCalendarFormSubmit=_asyncToGenerator(_regenerator().m(function e(n){var t,a,o,r,i,l,c,s,d,u,p;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:n.preventDefault(),t=new FormData(n.target),a={},o=_createForOfIteratorHelper(t.entries());try{for(o.s();!(r=o.n()).done;)i=_slicedToArray(r.value,2),l=i[0],c=i[1],a[l]=c}catch(e){o.e(e)}finally{o.f()}return console.log("üìù Calendar form submitted:",a),e.p=1,(s=n.target.querySelector('button[type="submit"]'))&&(s.disabled=!0,s.innerHTML='<span class="ms-Button-label">üîÑ Connecting...</span>'),e.n=2,addExternalCalendarConnection(a);case 2:(d=document.getElementById("calendar-form-container"))&&(d.innerHTML='\n        <div class="success-message" style="color: green; padding: 10px; border: 1px solid green; border-radius: 4px;">\n          ‚úÖ Calendar "'.concat(a.name||a.email,'" has been added successfully!\n          <button onclick="runCalendarDiagnostic()" style="margin-left: 10px;">Refresh List</button>\n        </div>\n      ')),e.n=4;break;case 3:e.p=3,p=e.v,console.error("‚ùå Failed to add calendar:",p),(u=document.getElementById("calendar-form-container"))&&(u.innerHTML='\n        <div class="error-message" style="color: red; padding: 10px; border: 1px solid red; border-radius: 4px;">\n          ‚ùå Failed to add calendar: '.concat(p.message,'\n          <button onclick="showAddExternalCalendar()" style="margin-left: 10px;">Try Again</button>\n        </div>\n      '));case 4:return e.a(2)}},e,null,[[1,3]])}))).apply(this,arguments)}function addExternalCalendarConnection(e){return _addExternalCalendarConnection.apply(this,arguments)}function _addExternalCalendarConnection(){return(_addExternalCalendarConnection=_asyncToGenerator(_regenerator().m(function e(n){var t,a;return _regenerator().w(function(e){for(;;)if(0===e.n)return console.log("üîó Adding ".concat(n.type," calendar:"),n),t=_objectSpread(_objectSpread({id:"".concat(n.type,"-").concat(Date.now()),type:n.type,name:n.name||"".concat(n.type," (").concat(n.email,")"),email:n.email},n),{},{status:"pending_implementation",added:(new Date).toISOString()}),(a=JSON.parse(localStorage.getItem("externalCalendars")||"[]")).push(t),localStorage.setItem("externalCalendars",JSON.stringify(a)),console.log("üìÖ ".concat(n.type," Calendar connection prepared:"),t),e.a(2,t)},e)}))).apply(this,arguments)}Office.onReady(function(e){try{var n,t;if(console.log("üöÄ Office.onReady called with info:",e),console.log("üìä Office.js diagnostics:"),console.log("  - Office object type:","undefined"==typeof Office?"undefined":_typeof(Office)),console.log("  - Office.context type:",_typeof(null===(n=Office)||void 0===n?void 0:n.context)),console.log("  - Office.context.auth type:",_typeof(null===(t=Office)||void 0===t||null===(t=t.context)||void 0===t?void 0:t.auth)),console.log("  - Host detected:",null==e?void 0:e.host),console.log("  - Host type comparison:",(null==e?void 0:e.host)===Office.HostType.Outlook),console.log("  - Platform:",null==e?void 0:e.platform),e.host===Office.HostType.Outlook||"Outlook"===e.host||window.Office){console.log("‚úÖ Host validated as Outlook-compatible"),document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var a=new Date("2025-08-12");document.getElementById("sync-date").value=a.toISOString().split("T")[0],syncManager=new CalendarSyncManager,initializeApp()}else console.warn("‚ö†Ô∏è Unsupported or unrecognized host application. Host info:",e),document.getElementById("sideload-msg").innerHTML='\n        <div style="color: orange; padding: 10px; border: 1px solid orange; border-radius: 5px;">\n          <h3>üîç Host Detection Diagnostic</h3>\n          <p><strong>Detected host:</strong> '.concat((null==e?void 0:e.host)||"Unknown","</p>\n          <p><strong>Expected:</strong> Outlook</p>\n          <p><strong>Platform:</strong> ").concat((null==e?void 0:e.platform)||"Unknown","</p>\n          <p><strong>Office.js available:</strong> ").concat(window.Office?"Yes":"No","</p>\n          <p><strong>Status:</strong> Attempting to continue with limited functionality...</p>\n          <button onclick=\"this.parentElement.style.display='none'; document.getElementById('app-body').style.display='flex';\">Continue Anyway</button>\n        </div>\n      "),setTimeout(function(){try{syncManager=new CalendarSyncManager,initializeApp()}catch(e){console.error("‚ùå Delayed initialization failed:",e)}},1e3)}catch(e){console.error("‚ùå Office.onReady error:",e),document.getElementById("sideload-msg").innerHTML='\n      <div style="color: red; padding: 10px; border: 1px solid red; border-radius: 5px;">\n        <h3>üö® Initialization Error</h3>\n        <p><strong>Error:</strong> '.concat(e.message,"</p>\n        <p><strong>Suggestion:</strong> Please ensure this add-in is loaded within Outlook</p>\n        <p><strong>Current URL:</strong> ").concat(window.location.href,"</p>\n        <button onclick=\"location.reload();\">Refresh Page</button>\n        <button onclick=\"this.parentElement.style.display='none'; document.getElementById('app-body').style.display='flex';\">Try Anyway</button>\n      </div>\n    ")}}),window.addEventListener("DOMContentLoaded",function(){setTimeout(function(){if(!syncManager)if(console.log("üîÑ Fallback initialization triggered - Office.onReady may not have fired"),console.log("üîç Office.js status check:"),console.log("  - window.Office available:",!!window.Office),console.log("  - Current URL:",window.location.href),console.log("  - User Agent:",navigator.userAgent),window.Office){console.log("‚úÖ Office.js detected, attempting manual initialization");try{document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var e=new Date("2025-08-12");document.getElementById("sync-date").value=e.toISOString().split("T")[0],syncManager=new CalendarSyncManager,initializeApp()}catch(e){console.error("‚ùå Fallback initialization failed:",e),showContextGuidance()}}else console.warn("‚ö†Ô∏è Office.js not available - showing context guidance"),showContextGuidance()},2e3)}),window.toggleCalendarSync=toggleCalendarSync,window.addGoogleCalendar=function(){showCalendarForm("google","Google Calendar",{fields:[{name:"email",label:"Google Account Email",type:"email",required:!0},{name:"calendarId",label:"Calendar ID (optional - leave blank for primary)",type:"text",required:!1}],instructions:"You'll need to authenticate with Google Calendar API. We'll redirect you to Google for permission."})},window.addOutlookCalendar=function(){showCalendarForm("outlook","Outlook.com/Hotmail",{fields:[{name:"email",label:"Outlook.com Email",type:"email",required:!0},{name:"calendarName",label:"Calendar Name (optional)",type:"text",required:!1}],instructions:"We'll authenticate with Microsoft Graph API for your personal Outlook.com account."})},window.addExchangeCalendar=function(){showCalendarForm("exchange","Exchange Server",{fields:[{name:"email",label:"Exchange Email",type:"email",required:!0},{name:"serverUrl",label:"Exchange Server URL",type:"url",required:!0,placeholder:"https://mail.company.com/ews/exchange.asmx"},{name:"domain",label:"Domain (optional)",type:"text",required:!1}],instructions:"We'll connect to your Exchange server using EWS (Exchange Web Services)."})},window.addICSCalendar=function(){showCalendarForm("ics","ICS/WebCal Calendar",{fields:[{name:"name",label:"Calendar Name",type:"text",required:!0},{name:"url",label:"Calendar URL",type:"url",required:!0,placeholder:"https://calendar.google.com/calendar/ical/...ics"},{name:"refreshInterval",label:"Refresh Interval (minutes)",type:"number",required:!1,value:"60"}],instructions:"Enter the ICS or WebCal URL. This is read-only and will be refreshed periodically."})},window.cancelCalendarForm=function(){var e=document.getElementById("calendar-form-container");e&&(e.innerHTML="")};