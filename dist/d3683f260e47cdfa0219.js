/*! For license information please see d3683f260e47cdfa0219.js.LICENSE.txt */
function _typeof(n){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_typeof(n)}function _regenerator(){var n,t,e="function"==typeof Symbol?Symbol:{},c=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function a(e,c,o,a){var r=c&&c.prototype instanceof s?c:s,l=Object.create(r.prototype);return _regeneratorDefine2(l,"_invoke",function(e,c,o){var a,s,r,l=0,u=o||[],d=!1,y={p:0,n:0,v:n,a:f,f:f.bind(n,4),d:function(t,e){return a=t,s=0,r=n,y.n=e,i}};function f(e,c){for(s=e,r=c,t=0;!d&&l&&!o&&t<u.length;t++){var o,a=u[t],f=y.p,v=a[2];e>3?(o=v===c)&&(r=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=n):a[0]<=f&&((o=e<2&&f<a[1])?(s=0,y.v=c,y.n=a[1]):f<v&&(o=e<3||a[0]>c||c>v)&&(a[4]=e,a[5]=c,y.n=v,s=0))}if(o||e>1)return i;throw d=!0,c}return function(o,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,v),s=u,r=v;(t=s<2?n:r)||!d;){a||(s?s<3?(s>1&&(y.n=-1),f(s,r)):y.n=r:y.v=r);try{if(l=2,a){if(s||(o="next"),t=a[o]){if(!(t=t.call(a,r)))throw TypeError("iterator result is not an object");if(!t.done)return t;r=t.value,s<2&&(s=0)}else 1===s&&(t=a.return)&&t.call(a),s<2&&(r=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=n}else if((t=(d=y.n<0)?r:e.call(c,y))!==i)break}catch(t){a=n,s=1,r=t}finally{l=1}}return{value:t,done:d}}}(e,o,a),!0),l}var i={};function s(){}function r(){}function l(){}t=Object.getPrototypeOf;var u=[][c]?t(t([][c]())):(_regeneratorDefine2(t={},c,function(){return this}),t),d=l.prototype=s.prototype=Object.create(u);function y(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,l):(n.__proto__=l,_regeneratorDefine2(n,o,"GeneratorFunction")),n.prototype=Object.create(d),n}return r.prototype=l,_regeneratorDefine2(d,"constructor",l),_regeneratorDefine2(l,"constructor",r),r.displayName="GeneratorFunction",_regeneratorDefine2(l,o,"GeneratorFunction"),_regeneratorDefine2(d),_regeneratorDefine2(d,o,"Generator"),_regeneratorDefine2(d,c,function(){return this}),_regeneratorDefine2(d,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:a,m:y}})()}function _regeneratorDefine2(n,t,e,c){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}_regeneratorDefine2=function(n,t,e,c){function a(t,e){_regeneratorDefine2(n,t,function(n){return this._invoke(t,e,n)})}t?o?o(n,t,{value:e,enumerable:!c,configurable:!c,writable:!c}):n[t]=e:(a("next",0),a("throw",1),a("return",2))},_regeneratorDefine2(n,t,e,c)}function asyncGeneratorStep(n,t,e,c,o,a,i){try{var s=n[a](i),r=s.value}catch(n){return void e(n)}s.done?t(r):Promise.resolve(r).then(c,o)}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(c,o){var a=n.apply(t,e);function i(n){asyncGeneratorStep(a,c,o,i,s,"next",n)}function s(n){asyncGeneratorStep(a,c,o,i,s,"throw",n)}i(void 0)})}}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(n,t){for(var e=0;e<t.length;e++){var c=t[e];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(n,_toPropertyKey(c.key),c)}}function _createClass(n,t,e){return t&&_defineProperties(n.prototype,t),e&&_defineProperties(n,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function _toPropertyKey(n){var t=_toPrimitive(n,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(n,t){if("object"!=_typeof(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var c=e.call(n,t||"default");if("object"!=_typeof(c))return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}export var MultiAccountUI=function(){return _createClass(function n(t){_classCallCheck(this,n),this.manager=t,this.currentView="overview"},[{key:"initialize",value:function(){this.createAccountManagementUI(),this.bindEvents(),this.refreshAccountsList()}},{key:"createAccountManagementUI",value:function(){var n=document.getElementById("auth-container")||document.getElementById("calendar-list")||document.createElement("div");n.innerHTML='\n      <div class="multi-account-manager">\n        \x3c!-- Header --\x3e\n        <div class="account-header">\n          <h2>üìÖ Multi-Tenant Calendar Sync</h2>\n          <p>Connect your calendars across different organizations and services</p>\n        </div>\n\n        \x3c!-- Navigation Tabs --\x3e\n        <div class="account-tabs">\n          <button class="tab-btn active" data-tab="overview">Overview</button>\n          <button class="tab-btn" data-tab="add-account">Add Account</button>\n          <button class="tab-btn" data-tab="sync-status">Sync Status</button>\n        </div>\n\n        \x3c!-- Overview Tab --\x3e\n        <div class="tab-content active" id="overview-tab">\n          <div class="accounts-summary">\n            <h3>Connected Accounts</h3>\n            <div id="accounts-list" class="accounts-list">\n              <div class="loading">Loading accounts...</div>\n            </div>\n            <div class="sync-actions">\n              <button id="sync-all-btn" class="btn-primary">üîÑ Sync All Calendars</button>\n              <button id="test-mode-btn" class="btn-secondary">üß™ Load Test Accounts</button>\n            </div>\n          </div>\n          \n          <div class="sync-overview">\n            <h3>Sync Configuration</h3>\n            <div class="sync-settings">\n              <label>\n                <input type="checkbox" id="auto-sync" checked> \n                Enable automatic synchronization\n              </label>\n              <label>\n                Sync interval: \n                <select id="sync-interval">\n                  <option value="5">5 minutes</option>\n                  <option value="15" selected>15 minutes</option>\n                  <option value="30">30 minutes</option>\n                  <option value="60">1 hour</option>\n                </select>\n              </label>\n            </div>\n          </div>\n        </div>\n\n        \x3c!-- Add Account Tab --\x3e\n        <div class="tab-content" id="add-account-tab">\n          <div class="add-account-form">\n            <h3>Add New Calendar Account</h3>\n            \n            <div class="account-type-selection">\n              <h4>Select Account Type:</h4>\n              \n              <div class="account-type-grid">\n                <div class="account-type-card" data-type="office365">\n                  <div class="account-icon">üè¢</div>\n                  <h4>Office 365</h4>\n                  <p>Business Microsoft account from another organization</p>\n                  <button class="select-type-btn">Connect</button>\n                </div>\n                \n                <div class="account-type-card" data-type="gmail">\n                  <div class="account-icon">üìß</div>\n                  <h4>Gmail</h4>\n                  <p>Google Calendar from Gmail account</p>\n                  <button class="select-type-btn">Connect</button>\n                </div>\n                \n                <div class="account-type-card" data-type="outlook_com">\n                  <div class="account-icon">üì®</div>\n                  <h4>Outlook.com</h4>\n                  <p>Personal Microsoft account</p>\n                  <button class="select-type-btn">Connect</button>\n                </div>\n                \n                <div class="account-type-card" data-type="exchange">\n                  <div class="account-icon">üèõÔ∏è</div>\n                  <h4>Exchange Server</h4>\n                  <p>On-premises Exchange calendar</p>\n                  <button class="select-type-btn">Connect</button>\n                </div>\n              </div>\n            </div>\n\n            \x3c!-- Account Configuration Form --\x3e\n            <div class="account-config-form" id="account-config-form" style="display: none;">\n              <h4 id="config-form-title">Configure Account</h4>\n              \n              <div class="form-group">\n                <label for="account-email">Email Address:</label>\n                <input type="email" id="account-email" placeholder="your.name@company.com" required>\n              </div>\n              \n              <div class="form-group">\n                <label for="account-display-name">Display Name:</label>\n                <input type="text" id="account-display-name" placeholder="Company Name" required>\n              </div>\n              \n              <div class="form-group" id="tenant-config" style="display: none;">\n                <label for="tenant-id">Tenant ID (for Office 365):</label>\n                <input type="text" id="tenant-id" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">\n                <small>Found in Azure AD > Properties > Directory ID</small>\n              </div>\n              \n              <div class="form-group" id="client-config" style="display: none;">\n                <label for="client-id">Client ID:</label>\n                <input type="text" id="client-id" placeholder="Application ID from app registration">\n                <small>Create an app registration in Azure AD / Google Console</small>\n              </div>\n              \n              <div class="form-actions">\n                <button type="button" id="save-account-btn" class="btn-primary">Save & Connect</button>\n                <button type="button" id="cancel-config-btn" class="btn-secondary">Cancel</button>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        \x3c!-- Sync Status Tab --\x3e\n        <div class="tab-content" id="sync-status-tab">\n          <div class="sync-status-view">\n            <h3>Synchronization Status</h3>\n            \n            <div class="sync-timeline">\n              <h4>Recent Sync Activity</h4>\n              <div id="sync-timeline-list" class="timeline-list">\n                <div class="timeline-item">\n                  <div class="timeline-time">2:30 PM</div>\n                  <div class="timeline-content">\n                    <strong>‚úÖ Sync completed</strong><br>\n                    All accounts synchronized successfully\n                  </div>\n                </div>\n                <div class="timeline-item">\n                  <div class="timeline-time">2:15 PM</div>\n                  <div class="timeline-content">\n                    <strong>üîÑ Sync started</strong><br>\n                    Processing 5 connected accounts\n                  </div>\n                </div>\n              </div>\n            </div>\n            \n            <div class="sync-conflicts">\n              <h4>Conflicts & Issues</h4>\n              <div id="conflicts-list" class="conflicts-list">\n                <div class="no-conflicts">No conflicts detected</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    ',document.getElementById("auth-container")||document.body.appendChild(n)}},{key:"bindEvents",value:function(){var n,t,e,c,o=this;document.querySelectorAll(".tab-btn").forEach(function(n){n.addEventListener("click",function(n){o.switchTab(n.target.dataset.tab)})}),document.querySelectorAll(".account-type-card").forEach(function(n){n.addEventListener("click",function(n){var t=n.target.closest(".account-type-card").querySelector(".select-type-btn");t&&t.click()})}),document.querySelectorAll(".select-type-btn").forEach(function(n){n.addEventListener("click",function(n){n.stopPropagation();var t=n.target.closest(".account-type-card").dataset.type;o.showAccountConfigForm(t)})}),null===(n=document.getElementById("save-account-btn"))||void 0===n||n.addEventListener("click",function(){o.saveAccountConfiguration()}),null===(t=document.getElementById("cancel-config-btn"))||void 0===t||t.addEventListener("click",function(){o.hideAccountConfigForm()}),null===(e=document.getElementById("sync-all-btn"))||void 0===e||e.addEventListener("click",function(){o.syncAllAccounts()}),null===(c=document.getElementById("test-mode-btn"))||void 0===c||c.addEventListener("click",function(){o.loadTestAccounts()})}},{key:"switchTab",value:function(n){document.querySelectorAll(".tab-btn").forEach(function(t){t.classList.toggle("active",t.dataset.tab===n)}),document.querySelectorAll(".tab-content").forEach(function(t){t.classList.toggle("active",t.id==="".concat(n,"-tab"))}),this.currentView=n,"overview"===n?this.refreshAccountsList():"sync-status"===n&&this.refreshSyncStatus()}},{key:"showAccountConfigForm",value:function(n){var t=document.getElementById("account-config-form"),e=document.getElementById("config-form-title"),c=document.getElementById("tenant-config"),o=document.getElementById("client-config");switch(n){case"office365":e.textContent="Configure Office 365 Account",c.style.display="block",o.style.display="block";break;case"gmail":e.textContent="Configure Gmail Account",c.style.display="none",o.style.display="block";break;case"outlook_com":e.textContent="Configure Outlook.com Account",c.style.display="none",o.style.display="block";break;case"exchange":e.textContent="Configure Exchange Server",c.style.display="none",o.style.display="none"}t.style.display="block",t.dataset.accountType=n}},{key:"hideAccountConfigForm",value:function(){document.getElementById("account-config-form").style.display="none",document.getElementById("account-email").value="",document.getElementById("account-display-name").value="",document.getElementById("tenant-id").value="",document.getElementById("client-id").value=""}},{key:"saveAccountConfiguration",value:(e=_asyncToGenerator(_regenerator().m(function n(){var t,e,c,o;return _regenerator().w(function(n){for(;;)switch(n.p=n.n){case 0:if(t=document.getElementById("account-config-form"),e=t.dataset.accountType,(c={id:"account-".concat(Date.now()),type:e,email:document.getElementById("account-email").value,displayName:document.getElementById("account-display-name").value,tenantId:document.getElementById("tenant-id").value,clientId:document.getElementById("client-id").value}).email&&c.displayName){n.n=1;break}return alert("Please fill in all required fields"),n.a(2);case 1:return n.p=1,console.log("üîó Adding new account:",c),n.n=2,this.manager.addAccount(c);case 2:this.hideAccountConfigForm(),this.switchTab("overview"),this.refreshAccountsList(),this.showMessage("Successfully connected ".concat(c.displayName,"!"),"success"),n.n=4;break;case 3:n.p=3,o=n.v,console.error("‚ùå Failed to add account:",o),this.showMessage("Failed to connect account: ".concat(o.message),"error");case 4:return n.a(2)}},n,this,[[1,3]])})),function(){return e.apply(this,arguments)})},{key:"loadTestAccounts",value:function(){console.log("üß™ Loading test accounts..."),this.manager.createMockAccounts(),this.refreshAccountsList(),this.showMessage("Test accounts loaded successfully!","success")}},{key:"refreshAccountsList",value:function(){var n=this,t=document.getElementById("accounts-list");if(t){var e=this.manager.getAccountsSummary();0!==e.length?t.innerHTML=e.map(function(t){return'\n      <div class="account-item '.concat(t.isAuthenticated?"authenticated":"not-authenticated",'">\n        <div class="account-info">\n          <div class="account-header">\n            <span class="account-type-icon">').concat(n.getAccountTypeIcon(t.type),'</span>\n            <div class="account-details">\n              <h4>').concat(t.displayName,"</h4>\n              <p>").concat(t.email,'</p>\n            </div>\n            <div class="account-status">\n              ').concat(t.isAuthenticated?'<span class="status-badge success">‚úÖ Connected</span>':'<span class="status-badge error">‚ùå Disconnected</span>','\n            </div>\n          </div>\n          \n          <div class="account-stats">\n            <span class="stat">üìÖ ').concat(t.calendarCount,' calendars</span>\n            <span class="stat">üîÑ ').concat(t.syncEnabled?"Sync enabled":"Sync disabled","</span>\n            ").concat(t.lastSync?'<span class="stat">‚è∞ Last sync: '.concat(new Date(t.lastSync).toLocaleTimeString(),"</span>"):'<span class="stat">‚è∞ Never synced</span>','\n          </div>\n        </div>\n        \n        <div class="account-actions">\n          <button class="btn-small" onclick="multiAccountUI.configureAccount(\'').concat(t.id,'\')">\n            ‚öôÔ∏è Configure\n          </button>\n          <button class="btn-small" onclick="multiAccountUI.syncAccount(\'').concat(t.id,'\')">\n            üîÑ Sync Now\n          </button>\n          <button class="btn-small danger" onclick="multiAccountUI.removeAccount(\'').concat(t.id,"')\">\n            üóëÔ∏è Remove\n          </button>\n        </div>\n      </div>\n    ")}).join(""):t.innerHTML='\n        <div class="no-accounts">\n          <div class="no-accounts-icon">üìÖ</div>\n          <h4>No accounts connected</h4>\n          <p>Add your first calendar account to start syncing</p>\n          <button onclick="document.querySelector(\'[data-tab=add-account]\').click()" class="btn-primary">\n            Add Account\n          </button>\n        </div>\n      '}}},{key:"getAccountTypeIcon",value:function(n){var t={office365:"üè¢",gmail:"üìß",outlook_com:"üì®",exchange:"üèõÔ∏è",other:"üìÖ"};return t[n]||t.other}},{key:"syncAllAccounts",value:(t=_asyncToGenerator(_regenerator().m(function n(){var t,e,c;return _regenerator().w(function(n){for(;;)switch(n.p=n.n){case 0:return t=document.getElementById("sync-all-btn"),e=t.textContent,t.textContent="üîÑ Syncing...",t.disabled=!0,n.p=1,console.log("üîÑ Starting sync for all accounts..."),n.n=2,new Promise(function(n){return setTimeout(n,2e3)});case 2:this.showMessage("All accounts synchronized successfully!","success"),this.refreshAccountsList(),n.n=4;break;case 3:n.p=3,c=n.v,console.error("‚ùå Sync failed:",c),this.showMessage("Sync failed: ".concat(c.message),"error");case 4:return n.p=4,t.textContent=e,t.disabled=!1,n.f(4);case 5:return n.a(2)}},n,this,[[1,3,4,5]])})),function(){return t.apply(this,arguments)})},{key:"showMessage",value:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",e=document.getElementById("message-display");e||((e=document.createElement("div")).id="message-display",e.className="message-display",document.querySelector(".multi-account-manager").prepend(e)),e.className="message-display ".concat(t),e.textContent=n,e.style.display="block",setTimeout(function(){e.style.display="none"},5e3)}},{key:"configureAccount",value:function(n){console.log("‚öôÔ∏è Configuring account: ".concat(n))}},{key:"syncAccount",value:(n=_asyncToGenerator(_regenerator().m(function n(t){return _regenerator().w(function(n){for(;;)switch(n.n){case 0:console.log("üîÑ Syncing account: ".concat(t));case 1:return n.a(2)}},n)})),function(t){return n.apply(this,arguments)})},{key:"removeAccount",value:function(n){confirm("Are you sure you want to remove this account?")&&(console.log("üóëÔ∏è Removing account: ".concat(n)),this.refreshAccountsList())}},{key:"refreshSyncStatus",value:function(){console.log("üîÑ Refreshing sync status...")}}]);var n,t,e}();window.MultiAccountUI=MultiAccountUI;