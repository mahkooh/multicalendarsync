/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var n={58394:function(n,e,t){n.exports=t.p+"4724c5daddbe7d202087.css"},98362:function(n,e,t){n.exports=t.p+"assets/logo-filled.png"}},e={};function t(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={exports:{}};return n[r](a,a.exports,t),a.exports}t.m=n,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},function(){var n;t.g.importScripts&&(n=t.g.location+"");var e=t.g.document;if(!n&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(n=e.currentScript.src),!n)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!n||!/^http(s?):/.test(n));)n=r[o--].src}if(!n)throw new Error("Automatic publicPath is not supported in this browser");n=n.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=n}(),t.b=document.baseURI||self.location.href,function(){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},n(e)}function e(n){return function(n){if(Array.isArray(n))return a(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||o(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var r,o,a,c,i=[],s=!0,l=!1;try{if(a=(t=t.call(n)).next,0===e){if(Object(t)!==t)return;s=!1}else for(;!(s=(r=a.call(t)).done)&&(i.push(r.value),i.length!==e);s=!0);}catch(n){l=!0,o=n}finally{try{if(!s&&null!=t.return&&(c=t.return(),Object(c)!==c))return}finally{if(l)throw o}}return i}}(n,e)||o(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(n,e){var t="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=o(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,i=!0,s=!1;return{s:function(){t=t.call(n)},n:function(){var n=t.next();return i=n.done,n},e:function(n){s=!0,c=n},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw c}}}}function o(n,e){if(n){if("string"==typeof n)return a(n,e);var t={}.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(n,e):void 0}}function a(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function c(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),t.push.apply(t,r)}return t}function i(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?c(Object(t),!0).forEach(function(e){s(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}function s(n,e,t){return(e=p(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function l(){var n,e,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function a(t,r,o,a){var s=r&&r.prototype instanceof i?r:i,l=Object.create(s.prototype);return u(l,"_invoke",function(t,r,o){var a,i,s,l=0,u=o||[],f=!1,y={p:0,n:0,v:n,a:d,f:d.bind(n,4),d:function(e,t){return a=e,i=0,s=n,y.n=t,c}};function d(t,r){for(i=t,s=r,e=0;!f&&l&&!o&&e<u.length;e++){var o,a=u[e],d=y.p,p=a[2];t>3?(o=p===r)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=n):a[0]<=d&&((o=t<2&&d<a[1])?(i=0,y.v=r,y.n=a[1]):d<p&&(o=t<3||a[0]>r||r>p)&&(a[4]=t,a[5]=r,y.n=p,i=0))}if(o||t>1)return c;throw f=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,p),i=u,s=p;(e=i<2?n:s)||!f;){a||(i?i<3?(i>1&&(y.n=-1),d(i,s)):y.n=s:y.v=s);try{if(l=2,a){if(i||(o="next"),e=a[o]){if(!(e=e.call(a,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,i<2&&(i=0)}else 1===i&&(e=a.return)&&e.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=n}else if((e=(f=y.n<0)?s:t.call(r,y))!==c)break}catch(e){a=n,i=1,s=e}finally{l=1}}return{value:e,done:f}}}(t,o,a),!0),l}var c={};function i(){}function s(){}function f(){}e=Object.getPrototypeOf;var y=[][r]?e(e([][r]())):(u(e={},r,function(){return this}),e),d=f.prototype=i.prototype=Object.create(y);function p(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,u(n,o,"GeneratorFunction")),n.prototype=Object.create(d),n}return s.prototype=f,u(d,"constructor",f),u(f,"constructor",s),s.displayName="GeneratorFunction",u(f,o,"GeneratorFunction"),u(d),u(d,o,"Generator"),u(d,r,function(){return this}),u(d,"toString",function(){return"[object Generator]"}),(l=function(){return{w:a,m:p}})()}function u(n,e,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}u=function(n,e,t,r){function a(e,t){u(n,e,function(n){return this._invoke(e,t,n)})}e?o?o(n,e,{value:t,enumerable:!r,configurable:!r,writable:!r}):n[e]=t:(a("next",0),a("throw",1),a("return",2))},u(n,e,t,r)}function f(n,e,t,r,o,a,c){try{var i=n[a](c),s=i.value}catch(n){return void t(n)}i.done?e(s):Promise.resolve(s).then(r,o)}function y(n){return function(){var e=this,t=arguments;return new Promise(function(r,o){var a=n.apply(e,t);function c(n){f(a,r,o,c,i,"next",n)}function i(n){f(a,r,o,c,i,"throw",n)}c(void 0)})}}function d(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,p(r.key),r)}}function p(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var v,h=function(){return n=function n(){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.syncEnabled=!1,this.calendars=new Map,this.syncInterval=null,this.lastSync=null,this.syncInProgress=!1,this.config={syncIntervalMinutes:15,busyBlockSubject:"[Auto-Sync] Busy",busyBlockCategory:"Auto-Sync",lookAheadDays:0,lookBehindDays:0}},o=[{key:"initialize",value:(w=y(l().m(function n(){var e;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,console.log("Initializing Calendar Sync Manager..."),n.n=1,this.requestPermissions();case 1:return this.loadConfiguration(),n.n=2,this.discoverCalendars();case 2:this.syncEnabled&&this.startAutoSync(),console.log("Calendar Sync Manager initialized successfully"),n.n=4;break;case 3:throw n.p=3,e=n.v,console.error("Failed to initialize Calendar Sync Manager:",e),e;case 4:return n.a(2)}},n,this,[[0,3]])})),function(){return w.apply(this,arguments)})},{key:"requestPermissions",value:(b=y(l().m(function n(){return l().w(function(n){for(;;)if(0===n.n)return n.a(2,new Promise(function(n,e){"Outlook"===Office.context.mailbox.diagnostics.hostName?n():e(new Error("Unsupported host application"))}))},n)})),function(){return b.apply(this,arguments)})},{key:"loadConfiguration",value:function(){try{var n=localStorage.getItem("calendarSync_config");if(n){var e=JSON.parse(n);this.config=i(i({},this.config),e)}var t=localStorage.getItem("calendarSync_enabled");this.syncEnabled="true"===t}catch(n){console.warn("Failed to load configuration:",n)}}},{key:"saveConfiguration",value:function(){try{localStorage.setItem("calendarSync_config",JSON.stringify(this.config)),localStorage.setItem("calendarSync_enabled",this.syncEnabled.toString())}catch(n){console.warn("Failed to save configuration:",n)}}},{key:"discoverCalendars",value:(g=y(l().m(function n(){var e,t,r=this;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:n.p=0,e=[{id:"calendar-1",name:"Company A Calendar",type:"Exchange",syncEnabled:!0,itemCount:12},{id:"calendar-2",name:"Company B Calendar",type:"Office 365",syncEnabled:!0,itemCount:8},{id:"calendar-3",name:"Company C Calendar",type:"Exchange",syncEnabled:!1,itemCount:5},{id:"calendar-4",name:"Personal Calendar",type:"Outlook.com",syncEnabled:!0,itemCount:15},{id:"calendar-5",name:"Project Calendar",type:"SharePoint",syncEnabled:!1,itemCount:3}],this.calendars.clear(),e.forEach(function(n){r.calendars.set(n.id,n)}),console.log("Discovered ".concat(this.calendars.size," calendars")),n.n=2;break;case 1:throw n.p=1,t=n.v,console.error("Failed to discover calendars:",t),t;case 2:return n.a(2)}},n,this,[[0,1]])})),function(){return g.apply(this,arguments)})},{key:"getAvailableCalendars",value:(m=y(l().m(function n(){return l().w(function(n){for(;;)if(0===n.n)return n.a(2,Array.from(this.calendars.values()))},n,this)})),function(){return m.apply(this,arguments)})},{key:"toggleCalendarSync",value:function(){var n=y(l().m(function n(e){var t;return l().w(function(n){for(;;)switch(n.n){case 0:if(t=this.calendars.get(e)){n.n=1;break}throw new Error("Calendar not found");case 1:return t.syncEnabled=!t.syncEnabled,this.saveConfiguration(),console.log("Calendar sync ".concat(t.syncEnabled?"enabled":"disabled"," for ").concat(t.name)),n.a(2,t.syncEnabled)}},n,this)}));return function(e){return n.apply(this,arguments)}}()},{key:"performSync",value:(h=y(l().m(function n(){var e,t,r,o,a,c,i,s=arguments;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:if(e=s.length>0&&void 0!==s[0]?s[0]:null,!this.syncInProgress){n.n=1;break}throw new Error("Sync already in progress");case 1:if(this.syncInProgress=!0,n.p=2,t=e||new Date,console.log("Starting calendar synchronization for ".concat(t.toLocaleDateString(),"...")),new Date(t).setHours(0,0,0,0),new Date(t).setHours(23,59,59,999),!((r=Array.from(this.calendars.values()).filter(function(n){return n.syncEnabled})).length<2)){n.n=3;break}throw new Error("At least 2 calendars must be enabled for synchronization");case 3:return n.n=4,this.getBusyTimesFromCalendars(r);case 4:return o=n.v,n.n=5,this.removeExistingSyncBlocks(r);case 5:return a=n.v,n.n=6,this.createSyncBlocks(r,o);case 6:return c=n.v,this.lastSync=new Date,console.log("Sync completed: ".concat(c," blocks created, ").concat(a," blocks removed")),n.a(2,{blocksCreated:c,blocksRemoved:a,syncTime:this.lastSync});case 7:throw n.p=7,i=n.v,console.error("Sync failed:",i),i;case 8:return n.p=8,this.syncInProgress=!1,n.f(8);case 9:return n.a(2)}},n,this,[[2,7,8,9]])})),function(){return h.apply(this,arguments)})},{key:"getBusyTimesFromCalendars",value:(v=y(l().m(function n(e){var t,o,a,c,i,s,u;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:t=new Map,o=r(e),n.p=1,o.s();case 2:if((a=o.n()).done){n.n=7;break}return c=a.value,n.p=3,n.n=4,this.simulateGetBusyTimes(c);case 4:i=n.v,t.set(c.id,i),n.n=6;break;case 5:n.p=5,s=n.v,console.warn("Failed to get busy times for ".concat(c.name,":"),s),t.set(c.id,[]);case 6:n.n=2;break;case 7:n.n=9;break;case 8:n.p=8,u=n.v,o.e(u);case 9:return n.p=9,o.f(),n.f(9);case 10:return n.a(2,t)}},n,this,[[3,5],[1,8,9,10]])})),function(n){return v.apply(this,arguments)})},{key:"simulateGetBusyTimes",value:(p=y(l().m(function n(e){var t,r,o,a,c,i;return l().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,new Promise(function(n){return setTimeout(n,100)});case 1:for(t=new Date,r=[],o=0;o<Math.floor(5*Math.random())+1;o++)a=new Date(t.getTime()+7*Math.random()*24*60*60*1e3),c=60*(3*Math.random()+.5)*60*1e3,i=new Date(a.getTime()+c),r.push({start:a,end:i,subject:"Meeting in ".concat(e.name),isPrivate:!1});return n.a(2,r)}},n)})),function(n){return p.apply(this,arguments)})},{key:"removeExistingSyncBlocks",value:(f=y(l().m(function n(e){var t,o,a,c,i,s,u;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:t=0,o=r(e),n.p=1,o.s();case 2:if((a=o.n()).done){n.n=7;break}return c=a.value,n.p=3,n.n=4,this.simulateRemoveSyncBlocks(c);case 4:i=n.v,t+=i,n.n=6;break;case 5:n.p=5,s=n.v,console.warn("Failed to remove sync blocks from ".concat(c.name,":"),s);case 6:n.n=2;break;case 7:n.n=9;break;case 8:n.p=8,u=n.v,o.e(u);case 9:return n.p=9,o.f(),n.f(9);case 10:return n.a(2,t)}},n,this,[[3,5],[1,8,9,10]])})),function(n){return f.apply(this,arguments)})},{key:"simulateRemoveSyncBlocks",value:(u=y(l().m(function n(e){return l().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,new Promise(function(n){return setTimeout(n,50)});case 1:return n.a(2,Math.floor(3*Math.random()))}},n)})),function(n){return u.apply(this,arguments)})},{key:"createSyncBlocks",value:(s=y(l().m(function n(o,a){var c,i,s,u,f,y,d,p,v,h,m,g,b;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:c=0,i=r(o),n.p=1,i.s();case 2:if((s=i.n()).done){n.n=7;break}u=s.value,n.p=3,f=[],y=r(a);try{for(y.s();!(d=y.n()).done;)p=t(d.value,2),v=p[0],h=p[1],v!==u.id&&f.push.apply(f,e(h))}catch(n){y.e(n)}finally{y.f()}return n.n=4,this.simulateCreateSyncBlocks(u,f);case 4:m=n.v,c+=m,n.n=6;break;case 5:n.p=5,g=n.v,console.warn("Failed to create sync blocks in ".concat(u.name,":"),g);case 6:n.n=2;break;case 7:n.n=9;break;case 8:n.p=8,b=n.v,i.e(b);case 9:return n.p=9,i.f(),n.f(9);case 10:return n.a(2,c)}},n,this,[[3,5],[1,8,9,10]])})),function(n,e){return s.apply(this,arguments)})},{key:"simulateCreateSyncBlocks",value:(c=y(l().m(function n(e,t){return l().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,new Promise(function(n){return setTimeout(n,100)});case 1:return console.log("Would create ".concat(t.length," sync blocks in ").concat(e.name)),n.a(2,t.length)}},n)})),function(n,e){return c.apply(this,arguments)})},{key:"startAutoSync",value:function(){var n=this;this.syncInterval&&clearInterval(this.syncInterval);var e=60*this.config.syncIntervalMinutes*1e3;this.syncInterval=setInterval(function(){n.performSync().catch(function(n){console.error("Auto-sync failed:",n)})},e),console.log("Auto-sync started with ".concat(this.config.syncIntervalMinutes," minute interval"))}},{key:"stopAutoSync",value:function(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null,console.log("Auto-sync stopped"))}},{key:"getSyncStatus",value:(a=y(l().m(function n(){var e;return l().w(function(n){for(;;)switch(n.n){case 0:if(!this.syncInProgress){n.n=1;break}return n.a(2,{state:"Syncing",message:"Synchronization in progress...",lastSync:this.lastSync});case 1:if(this.syncEnabled){n.n=2;break}return n.a(2,{state:"Stopped",message:"Synchronization disabled",lastSync:this.lastSync});case 2:if(!((e=Array.from(this.calendars.values()).filter(function(n){return n.syncEnabled}).length)<2)){n.n=3;break}return n.a(2,{state:"Error",message:"Need at least 2 enabled calendars",lastSync:this.lastSync});case 3:return n.a(2,{state:"Active",message:"Monitoring ".concat(e," calendars"),lastSync:this.lastSync})}},n,this)})),function(){return a.apply(this,arguments)})},{key:"setSyncInterval",value:function(n){this.config.syncIntervalMinutes=n,this.saveConfiguration(),this.syncInterval&&this.startAutoSync()}},{key:"setBusyBlockSubject",value:function(n){this.config.busyBlockSubject=n,this.saveConfiguration()}},{key:"setLookAheadDays",value:function(n){this.config.lookAheadDays=n,this.saveConfiguration()}},{key:"getConfiguration",value:function(){return i({},this.config)}}],o&&d(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o,a,c,s,u,f,p,v,h,m,g,b,w}();function m(){var n,e,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function a(t,r,o,a){var s=r&&r.prototype instanceof i?r:i,l=Object.create(s.prototype);return g(l,"_invoke",function(t,r,o){var a,i,s,l=0,u=o||[],f=!1,y={p:0,n:0,v:n,a:d,f:d.bind(n,4),d:function(e,t){return a=e,i=0,s=n,y.n=t,c}};function d(t,r){for(i=t,s=r,e=0;!f&&l&&!o&&e<u.length;e++){var o,a=u[e],d=y.p,p=a[2];t>3?(o=p===r)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=n):a[0]<=d&&((o=t<2&&d<a[1])?(i=0,y.v=r,y.n=a[1]):d<p&&(o=t<3||a[0]>r||r>p)&&(a[4]=t,a[5]=r,y.n=p,i=0))}if(o||t>1)return c;throw f=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,p),i=u,s=p;(e=i<2?n:s)||!f;){a||(i?i<3?(i>1&&(y.n=-1),d(i,s)):y.n=s:y.v=s);try{if(l=2,a){if(i||(o="next"),e=a[o]){if(!(e=e.call(a,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,i<2&&(i=0)}else 1===i&&(e=a.return)&&e.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=n}else if((e=(f=y.n<0)?s:t.call(r,y))!==c)break}catch(e){a=n,i=1,s=e}finally{l=1}}return{value:e,done:f}}}(t,o,a),!0),l}var c={};function i(){}function s(){}function l(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(g(e={},r,function(){return this}),e),f=l.prototype=i.prototype=Object.create(u);function y(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,l):(n.__proto__=l,g(n,o,"GeneratorFunction")),n.prototype=Object.create(f),n}return s.prototype=l,g(f,"constructor",l),g(l,"constructor",s),s.displayName="GeneratorFunction",g(l,o,"GeneratorFunction"),g(f),g(f,o,"Generator"),g(f,r,function(){return this}),g(f,"toString",function(){return"[object Generator]"}),(m=function(){return{w:a,m:y}})()}function g(n,e,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}g=function(n,e,t,r){function a(e,t){g(n,e,function(n){return this._invoke(e,t,n)})}e?o?o(n,e,{value:t,enumerable:!r,configurable:!r,writable:!r}):n[e]=t:(a("next",0),a("throw",1),a("return",2))},g(n,e,t,r)}function b(n,e,t,r,o,a,c){try{var i=n[a](c),s=i.value}catch(n){return void t(n)}i.done?e(s):Promise.resolve(s).then(r,o)}function w(n){return function(){var e=this,t=arguments;return new Promise(function(r,o){var a=n.apply(e,t);function c(n){b(a,r,o,c,i,"next",n)}function i(n){b(a,r,o,c,i,"throw",n)}c(void 0)})}}function S(){return(S=w(m().m(function n(){var e;return m().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,document.getElementById("sync-now").onclick=O,document.getElementById("configure").onclick=j,n.n=1,v.initialize();case 1:return n.n=2,k();case 2:return n.n=3,B();case 3:setInterval(B,3e4),n.n=5;break;case 4:n.p=4,e=n.v,console.error("Failed to initialize app:",e),x("Error","Initialization failed: ".concat(e.message));case 5:return n.a(2)}},n,null,[[0,4]])}))).apply(this,arguments)}function k(){return E.apply(this,arguments)}function E(){return(E=w(m().m(function n(){var e;return m().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,v.getAvailableCalendars();case 1:C(n.v),n.n=3;break;case 2:n.p=2,e=n.v,console.error("Failed to load calendars:",e),document.getElementById("calendar-list").innerHTML='<div class="error">Failed to load calendars. Please check permissions.</div>';case 3:return n.a(2)}},n,null,[[0,2]])}))).apply(this,arguments)}function C(n){var e=document.getElementById("calendar-list");0!==n.length?e.innerHTML=n.map(function(n){return'\n    <div class="calendar-item">\n      <div>\n        <div class="calendar-name">'.concat(n.name,'</div>\n        <div class="calendar-status">').concat(n.type," • ").concat(n.itemCount,' items</div>\n      </div>\n      <div class="calendar-toggle">\n        <div class="toggle-switch ').concat(n.syncEnabled?"active":"",'" \n             data-calendar-id="').concat(n.id,'"\n             onclick="toggleCalendarSync(\'').concat(n.id,"')\">\n        </div>\n      </div>\n    </div>\n  ")}).join(""):e.innerHTML='<div class="no-activity">No calendars found</div>'}function O(){return I.apply(this,arguments)}function I(){return(I=w(m().m(function n(){var e,t,r,o;return m().w(function(n){for(;;)switch(n.p=n.n){case 0:if(n.p=0,e=document.getElementById("sync-date").value){n.n=1;break}return x("Error","Please select a date to sync"),n.a(2);case 1:return t=new Date(e),x("Syncing","Syncing ".concat(t.toLocaleDateString(),"...")),D(!0),n.n=2,v.performSync(t);case 2:r=n.v,x("Active","Sync completed for ".concat(t.toLocaleDateString(),". ").concat(r.blocksCreated," blocks created, ").concat(r.blocksRemoved," removed.")),F("Sync completed for ".concat(t.toLocaleDateString(),": ").concat(r.blocksCreated," created, ").concat(r.blocksRemoved," removed")),n.n=4;break;case 3:n.p=3,o=n.v,console.error("Sync failed:",o),x("Error","Sync failed: ".concat(o.message)),F("Sync failed: ".concat(o.message));case 4:return n.p=4,D(!1),n.f(4);case 5:return n.a(2)}},n,null,[[0,3,4,5]])}))).apply(this,arguments)}function j(){return P.apply(this,arguments)}function P(){return(P=w(m().m(function n(){return m().w(function(n){for(;;)switch(n.n){case 0:console.log("Configure clicked");case 1:return n.a(2)}},n)}))).apply(this,arguments)}function T(){return(T=w(m().m(function n(e){var t,r,o;return m().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,v.toggleCalendarSync(e);case 1:t=n.v,(r=document.querySelector('[data-calendar-id="'.concat(e,'"]')))&&r.classList.toggle("active",t),F("Calendar sync ".concat(t?"enabled":"disabled"," for calendar")),n.n=3;break;case 2:n.p=2,o=n.v,console.error("Failed to toggle calendar sync:",o),F("Failed to toggle calendar sync: ".concat(o.message));case 3:return n.a(2)}},n,null,[[0,2]])}))).apply(this,arguments)}function B(){return A.apply(this,arguments)}function A(){return(A=w(m().m(function n(){var e,t;return m().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,v.getSyncStatus();case 1:x((e=n.v).state,e.message),e.lastSync&&(document.getElementById("last-sync").textContent="Last sync: ".concat(new Date(e.lastSync).toLocaleString())),n.n=3;break;case 2:n.p=2,t=n.v,console.error("Failed to get sync status:",t),x("Error","Unable to check sync status");case 3:return n.a(2)}},n,null,[[0,2]])}))).apply(this,arguments)}function x(n,e){var t=document.getElementById("status-dot"),r=document.getElementById("status-text");switch(t.classList.remove("active","syncing"),n.toLowerCase()){case"active":t.classList.add("active");break;case"syncing":t.classList.add("syncing")}r.textContent=e}function D(n){var e=document.getElementById("sync-now"),t=e.querySelector(".ms-Button-label");e.style.opacity=n?"0.6":"1",e.style.pointerEvents=n?"none":"auto",t.textContent=n?"Syncing...":"Sync Now"}function F(n){var e=document.getElementById("activity-log"),t=e.querySelector(".no-activity");t&&t.remove();var r=document.createElement("div");r.className="activity-item",r.innerHTML='\n    <div class="activity-time">'.concat((new Date).toLocaleTimeString(),"</div>\n    <div>").concat(n,"</div>\n  "),e.insertBefore(r,e.firstChild);var o=e.querySelectorAll(".activity-item");o.length>10&&o[o.length-1].remove()}Office.onReady(function(n){if(n.host===Office.HostType.Outlook){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var e=new Date("2025-08-12");document.getElementById("sync-date").value=e.toISOString().split("T")[0],v=new h,function(){S.apply(this,arguments)}()}}),window.toggleCalendarSync=function(n){return T.apply(this,arguments)}}(),new URL(t(58394),t.b),new URL(t(98362),t.b)}();
//# sourceMappingURL=taskpane.js.map