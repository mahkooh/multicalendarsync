/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,n,t){e.exports=t.p+"4724c5daddbe7d202087.css"},98362:function(e,n,t){e.exports=t.p+"assets/logo-filled.png"}},n={};function t(o){var r=n[o];if(void 0!==r)return r.exports;var a=n[o]={exports:{}};return e[o](a,a.exports,t),a.exports}t.m=e,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var o=n.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=o[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e}(),t.b=document.baseURI||self.location.href,function(){function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,r,a,c,i=[],s=!0,l=!1;try{if(a=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(o=a.call(t)).done)&&(i.push(o.value),i.length!==n);s=!0);}catch(e){l=!0,r=e}finally{try{if(!s&&null!=t.return&&(c=t.return(),Object(c)!==c))return}finally{if(l)throw r}}return i}}(e,n)||r(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=r(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,i=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){s=!0,c=e},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw c}}}}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,n){if(e){if("string"==typeof e)return a(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(e,n):void 0}}function a(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=Array(n);t<n;t++)o[t]=e[t];return o}function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,o)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach(function(n){s(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function s(e,n,t){return(n=y(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(){var e,n,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function a(t,o,r,a){var s=o&&o.prototype instanceof i?o:i,l=Object.create(s.prototype);return u(l,"_invoke",function(t,o,r){var a,i,s,l=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return a=n,i=0,s=e,f.n=t,c}};function p(t,o){for(i=t,s=o,n=0;!d&&l&&!r&&n<u.length;n++){var r,a=u[n],p=f.p,y=a[2];t>3?(r=y===o)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((r=t<2&&p<a[1])?(i=0,f.v=o,f.n=a[1]):p<y&&(r=t<3||a[0]>o||o>y)&&(a[4]=t,a[5]=o,f.n=y,i=0))}if(r||t>1)return c;throw d=!0,o}return function(r,u,y){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,y),i=u,s=y;(n=i<2?e:s)||!d;){a||(i?i<3?(i>1&&(f.n=-1),p(i,s)):f.n=s:f.v=s);try{if(l=2,a){if(i||(r="next"),n=a[r]){if(!(n=n.call(a,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,i<2&&(i=0)}else 1===i&&(n=a.return)&&n.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),i=1);a=e}else if((n=(d=f.n<0)?s:t.call(o,f))!==c)break}catch(n){a=e,i=1,s=n}finally{l=1}}return{value:n,done:d}}}(t,r,a),!0),l}var c={};function i(){}function s(){}function d(){}n=Object.getPrototypeOf;var f=[][o]?n(n([][o]())):(u(n={},o,function(){return this}),n),p=d.prototype=i.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,r,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=d,u(p,"constructor",d),u(d,"constructor",s),s.displayName="GeneratorFunction",u(d,r,"GeneratorFunction"),u(p),u(p,r,"Generator"),u(p,o,function(){return this}),u(p,"toString",function(){return"[object Generator]"}),(l=function(){return{w:a,m:y}})()}function u(e,n,t,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}u=function(e,n,t,o){function a(n,t){u(e,n,function(e){return this._invoke(n,t,e)})}n?r?r(e,n,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},u(e,n,t,o)}function d(e,n,t,o,r,a,c){try{var i=e[a](c),s=i.value}catch(e){return void t(e)}i.done?n(s):Promise.resolve(s).then(o,r)}function f(e){return function(){var n=this,t=arguments;return new Promise(function(o,r){var a=e.apply(n,t);function c(e){d(a,o,r,c,i,"next",e)}function i(e){d(a,o,r,c,i,"throw",e)}c(void 0)})}}function p(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,y(o.key),o)}}function y(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}var h,m=function(){return r=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.syncEnabled=!1,this.calendars=new Map,this.syncInterval=null,this.lastSync=null,this.syncInProgress=!1,this.config={syncIntervalMinutes:15,busyBlockSubject:"[Auto-Sync] Busy",busyBlockCategory:"Auto-Sync",lookAheadDays:0,lookBehindDays:0}},a=[{key:"initialize",value:(I=f(l().m(function e(){var n,t;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,console.log("Initializing Calendar Sync Manager..."),window.Office){e.n=1;break}throw new Error("Office.js is not loaded");case 1:return Office.context&&Office.context.mailbox||console.warn("Limited Office context detected, some features may not work"),console.log("Office context available:",!!Office.context),console.log("Mailbox available:",!(null===(n=Office.context)||void 0===n||!n.mailbox)),e.n=2,this.requestPermissions();case 2:return this.loadConfiguration(),e.n=3,this.discoverCalendars();case 3:this.syncEnabled&&this.startAutoSync(),console.log("Calendar Sync Manager initialized successfully"),e.n=5;break;case 4:throw e.p=4,t=e.v,console.error("Failed to initialize Calendar Sync Manager:",t),t;case 5:return e.a(2)}},e,this,[[0,4]])})),function(){return I.apply(this,arguments)})},{key:"requestPermissions",value:(A=f(l().m(function e(){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){try{if(!Office.context||!Office.context.mailbox)return console.warn("Limited Office context, proceeding with basic initialization"),void e();var t=Office.context.mailbox.diagnostics,o=null==t?void 0:t.hostName;console.log("Host diagnostics:",{hostName:o,hostVersion:null==t?void 0:t.hostVersion,platform:null==t?void 0:t.platform}),"Outlook"!==o&&"OutlookWebApp"!==o&&"OutlookIOS"!==o&&"OutlookAndroid"!==o&&o?(console.warn("Unknown host detected, proceeding anyway:",o),e()):(console.log("Host validation passed for:",o||"unknown host"),e())}catch(n){console.error("Error in requestPermissions:",n),e()}}))},e)})),function(){return A.apply(this,arguments)})},{key:"loadConfiguration",value:function(){try{var e=localStorage.getItem("calendarSync_config");if(e){var n=JSON.parse(e);this.config=i(i({},this.config),n)}var t=localStorage.getItem("calendarSync_enabled");this.syncEnabled="true"===t}catch(e){console.warn("Failed to load configuration:",e)}}},{key:"saveConfiguration",value:function(){try{localStorage.setItem("calendarSync_config",JSON.stringify(this.config)),localStorage.setItem("calendarSync_enabled",this.syncEnabled.toString())}catch(e){console.warn("Failed to save configuration:",e)}}},{key:"discoverCalendars",value:(x=f(l().m(function e(){var n,t,o,r=this;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Discovering real Microsoft accounts and calendars..."),e.n=1,this.getGraphCalendars();case 1:if(!((n=e.v)&&n.length>0)){e.n=2;break}this.calendars.clear(),n.forEach(function(e){r.calendars.set(e.id,e)}),console.log("✅ Discovered ".concat(this.calendars.size," real calendars from Graph API:")),Array.from(this.calendars.values()).forEach(function(e){console.log("  📅 ".concat(e.name," (").concat(e.userEmail,") - Default: ").concat(e.isDefaultCalendar))}),e.n=3;break;case 2:throw new Error("No calendars returned from Graph API");case 3:case 6:e.n=8;break;case 4:return e.p=4,t=e.v,console.warn("⚠️ Graph API discovery failed, checking why:",t),e.p=5,e.n=6,this.tryAlternativeDiscovery();case 7:return e.p=7,o=e.v,console.warn("⚠️ Alternative discovery also failed:",o),console.log("📝 Using enhanced mock data with email simulation..."),e.n=8,this.discoverEnhancedMockCalendars();case 8:return e.a(2)}},e,this,[[5,7],[0,4]])})),function(){return x.apply(this,arguments)})},{key:"tryAlternativeDiscovery",value:(C=f(l().m(function e(){var n,t,o,r,a,c,i,s,u=this;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.getGraphAccessToken();case 1:return n=e.v,console.log("🔍 Testing Graph API access with user profile..."),e.n=2,fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}});case 2:if((t=e.v).ok){e.n=3;break}throw new Error("Profile API error: ".concat(t.status," ").concat(t.statusText));case 3:return e.n=4,t.json();case 4:return o=e.v,console.log("✅ Authenticated as: ".concat(o.displayName," (").concat(o.mail||o.userPrincipalName,")")),e.n=5,fetch("https://graph.microsoft.com/v1.0/me/calendars",{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}});case 5:if((r=e.v).ok){e.n=7;break}return e.n=6,r.text();case 6:throw a=e.v,new Error("Calendars API error: ".concat(r.status," ").concat(r.statusText," - ").concat(a));case 7:return e.n=8,r.json();case 8:c=e.v,console.log("📅 Raw calendar data from Graph:",c),i=o.mail||o.userPrincipalName,s=c.value.map(function(e){var n;return{id:e.id,name:e.name,userEmail:(null===(n=e.owner)||void 0===n||null===(n=n.emailAddress)||void 0===n?void 0:n.address)||i,type:"Microsoft Graph",syncEnabled:!0,canEdit:e.canEdit||!1,isDefaultCalendar:e.isDefaultCalendar||!1}}),this.calendars.clear(),s.forEach(function(e){u.calendars.set(e.id,e)}),console.log("✅ Successfully discovered ".concat(s.length," calendars with emails"));case 9:return e.a(2)}},e,this)})),function(){return C.apply(this,arguments)})},{key:"discoverEnhancedMockCalendars",value:(E=f(l().m(function e(){var n,t=this;return l().w(function(e){for(;;)switch(e.n){case 0:n=[{id:"calendar-1",name:"Primary Work Calendar",userEmail:"dan.hookham@company1.com",type:"Exchange Online",syncEnabled:!0,isDefaultCalendar:!0},{id:"calendar-2",name:"Secondary Work Calendar",userEmail:"dan.hookham@company2.com",type:"Office 365",syncEnabled:!0,isDefaultCalendar:!1},{id:"calendar-3",name:"Personal Calendar",userEmail:"dan.hookham@outlook.com",type:"Outlook.com",syncEnabled:!0,isDefaultCalendar:!1},{id:"calendar-4",name:"Project Calendar",userEmail:"dan.hookham@company3.com",type:"Exchange",syncEnabled:!0,isDefaultCalendar:!1},{id:"calendar-5",name:"Client Calendar",userEmail:"dan.hookham@company4.com",type:"Office 365",syncEnabled:!0,isDefaultCalendar:!1}],this.calendars.clear(),n.forEach(function(e){t.calendars.set(e.id,e)}),console.log("📝 Using enhanced mock calendars with email addresses:"),n.forEach(function(e){console.log("  📅 ".concat(e.name," (").concat(e.userEmail,")"))});case 1:return e.a(2)}},e,this)})),function(){return E.apply(this,arguments)})},{key:"getGraphCalendars",value:(O=f(l().m(function e(){var n,t,r,a,c,i,s,u,d,f,p,y,h,m,v,g;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.getGraphAccessToken();case 1:return n=e.v,console.log("🔐 Graph access token obtained, fetching calendars..."),e.n=2,fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}});case 2:if((t=e.v).ok){e.n=3;break}throw new Error("Profile API failed: ".concat(t.status));case 3:return e.n=4,t.json();case 4:return r=e.v,a=r.mail||r.userPrincipalName,console.log("👤 Primary user: ".concat(r.displayName," (").concat(a,")")),e.n=5,fetch("https://graph.microsoft.com/v1.0/me/calendars?$select=id,name,canEdit,isDefaultCalendar,owner",{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}});case 5:if((c=e.v).ok){e.n=7;break}return e.n=6,c.text();case 6:throw i=e.v,console.error("Calendar API error response:",i),new Error("Calendar API failed: ".concat(c.status," - ").concat(i));case 7:return e.n=8,c.json();case 8:if(s=e.v,console.log("📊 Raw Graph calendar response:",s),s.value&&0!==s.value.length){e.n=9;break}return console.warn("⚠️ No calendars found in Graph response"),e.a(2,[]);case 9:return u=[],e.p=10,e.n=11,fetch("https://graph.microsoft.com/v1.0/me/calendarGroups?$expand=calendars",{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}});case 11:if(!(d=e.v).ok){e.n=13;break}return e.n=12,d.json();case 12:p=e.v,console.log("📂 Calendar groups found:",p),null===(f=p.value)||void 0===f||f.forEach(function(e){e.calendars&&u.push.apply(u,o(e.calendars))});case 13:e.n=15;break;case 14:e.p=14,v=e.v,console.log("ℹ️ Calendar groups not accessible (normal for some accounts):",v.message);case 15:return y=[].concat(o(s.value),u),h=y.filter(function(e,n,t){return n===t.findIndex(function(n){return n.id===e.id})}),console.log("📅 Found ".concat(h.length," total calendars (").concat(s.value.length," primary + ").concat(u.length," from groups)")),m=h.map(function(e){var n,t=(null===(n=e.owner)||void 0===n||null===(n=n.emailAddress)||void 0===n?void 0:n.address)||a;return{id:e.id,name:e.name||"Unnamed Calendar",userEmail:t,type:"Microsoft Graph",syncEnabled:!0,canEdit:!1!==e.canEdit,isDefaultCalendar:e.isDefaultCalendar||!1}}),console.log("✅ Processed calendars:"),m.forEach(function(e){console.log('  📅 "'.concat(e.name,'" owned by ').concat(e.userEmail," (Default: ").concat(e.isDefaultCalendar,", Editable: ").concat(e.canEdit,")"))}),e.a(2,m);case 16:throw e.p=16,g=e.v,console.error("❌ getGraphCalendars failed:",g),console.log("🔄 Will attempt alternative discovery or fall back to mock data"),g;case 17:return e.a(2)}},e,this,[[10,14],[0,16]])})),function(){return O.apply(this,arguments)})},{key:"getGraphAccessToken",value:(S=f(l().m(function e(){var n,o,r,a,c,i;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,console.log("🔐 Requesting Graph access token..."),console.log("🔍 Checking Office.js availability:"),console.log("  - Office object:","undefined"==typeof Office?"undefined":t(Office)),console.log("  - Office.context:",t(null===(n=Office)||void 0===n?void 0:n.context)),console.log("  - Office.context.auth:",t(null===(o=Office)||void 0===o||null===(o=o.context)||void 0===o?void 0:o.auth)),console.log("  - getAccessToken method:",t(null===(r=Office)||void 0===r||null===(r=r.context)||void 0===r||null===(r=r.auth)||void 0===r?void 0:r.getAccessToken)),null!==(a=Office)&&void 0!==a&&null!==(a=a.context)&&void 0!==a&&a.host&&(console.log("🏢 Host application:",Office.context.host),console.log("📱 Platform:",Office.context.platform),console.log("🔧 Requirements:",Office.context.requirements)),null!==(c=Office)&&void 0!==c&&null!==(c=c.context)&&void 0!==c&&null!==(c=c.auth)&&void 0!==c&&c.getAccessToken){e.n=2;break}if(console.warn("⚠️ Office.js authentication not available in this context"),console.log("🔄 Attempting alternative authentication methods..."),"undefined"==typeof window||!window.location){e.n=1;break}throw console.log("🌐 Running in web context:",window.location.href),new Error("Office.js SSO not available - add-in may need to be loaded in proper Office context");case 1:throw new Error("Office.js authentication not available in this context");case 2:return console.log("✅ Office.js authentication is available, requesting token..."),e.a(2,new Promise(function(e,n){var t={allowSignInPrompt:!0,allowConsentPrompt:!0,forMSGraphAccess:!0};console.log("📋 Token request options:",t),Office.context.auth.getAccessToken(t,function(t){if(console.log("🔍 Auth result status:",t.status),console.log("🔍 Full auth result:",t),t.status===Office.AsyncResultStatus.Succeeded)console.log("✅ Access token obtained successfully"),console.log("🎫 Token preview:",t.value.substring(0,20)+"..."),console.log("🎫 Token length:",t.value.length),e(t.value);else{var o,r,a,c,i,s,l,u,d,f,p;console.error("❌ Authentication failed:",t.error),console.error("Error code:",null===(o=t.error)||void 0===o?void 0:o.code),console.error("Error message:",null===(r=t.error)||void 0===r?void 0:r.message),console.error("Error name:",null===(a=t.error)||void 0===a?void 0:a.name),console.error("Error tracing:",null===(c=t.error)||void 0===c?void 0:c.tracing);var y="Authentication failed: ".concat((null===(i=t.error)||void 0===i?void 0:i.message)||"Unknown error");13001===(null===(s=t.error)||void 0===s?void 0:s.code)?y+=" (User not signed in - this may require signing into Office)":13002===(null===(l=t.error)||void 0===l?void 0:l.code)?y+=" (User consent required - admin may need to grant permissions)":13003===(null===(u=t.error)||void 0===u?void 0:u.code)?y+=" (Invalid audience - token scope issue)":13006===(null===(d=t.error)||void 0===d?void 0:d.code)?y+=" (Invalid request - check add-in manifest permissions)":13007===(null===(f=t.error)||void 0===f?void 0:f.code)?y+=" (Invalid grant - user may need to re-authenticate)":13012===(null===(p=t.error)||void 0===p?void 0:p.code)&&(y+=" (Add-in not trusted - may need admin consent)"),n(new Error(y))}})}));case 3:throw e.p=3,i=e.v,console.error("❌ Failed to get Graph access token:",i),console.log("💡 Troubleshooting suggestions:"),console.log("  1. Ensure add-in is loaded in Outlook (not just web browser)"),console.log("  2. Check that manifest is properly deployed"),console.log("  3. Verify Office.js is fully loaded"),console.log("  4. Check manifest WebApplicationInfo configuration"),new Error("Authentication setup failed: ".concat(i.message));case 4:return e.a(2)}},e,null,[[0,3]])})),function(){return S.apply(this,arguments)})},{key:"discoverMockCalendars",value:(k=f(l().m(function e(){var n,t=this;return l().w(function(e){for(;;)switch(e.n){case 0:n=[{id:"calendar-1",name:"Primary Work Calendar",userEmail:"user@company1.com",type:"Exchange",syncEnabled:!0,isDefaultCalendar:!0},{id:"calendar-2",name:"Secondary Work Calendar",userEmail:"user@company2.com",type:"Office 365",syncEnabled:!0,isDefaultCalendar:!1},{id:"calendar-3",name:"Personal Calendar",userEmail:"personal@outlook.com",type:"Outlook.com",syncEnabled:!0,isDefaultCalendar:!1}],this.calendars.clear(),n.forEach(function(e){t.calendars.set(e.id,e)}),console.log("Using mock calendars for testing");case 1:return e.a(2)}},e,this)})),function(){return k.apply(this,arguments)})},{key:"getAvailableCalendars",value:(w=f(l().m(function e(){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,Array.from(this.calendars.values()))},e,this)})),function(){return w.apply(this,arguments)})},{key:"toggleCalendarSync",value:function(){var e=f(l().m(function e(n){var t;return l().w(function(e){for(;;)switch(e.n){case 0:if(t=this.calendars.get(n)){e.n=1;break}throw new Error("Calendar not found");case 1:return t.syncEnabled=!t.syncEnabled,this.saveConfiguration(),console.log("Calendar sync ".concat(t.syncEnabled?"enabled":"disabled"," for ").concat(t.name)),e.a(2,t.syncEnabled)}},e,this)}));return function(n){return e.apply(this,arguments)}}()},{key:"performSync",value:(b=f(l().m(function e(){var n,t,o,r,a,c,i,s=arguments;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=s.length>0&&void 0!==s[0]?s[0]:null,!this.syncInProgress){e.n=1;break}throw new Error("Sync already in progress");case 1:if(this.syncInProgress=!0,e.p=2,t=n||new Date,console.log("Starting calendar synchronization for ".concat(t.toLocaleDateString(),"...")),new Date(t).setHours(0,0,0,0),new Date(t).setHours(23,59,59,999),!((o=Array.from(this.calendars.values()).filter(function(e){return e.syncEnabled})).length<2)){e.n=3;break}throw new Error("At least 2 calendars must be enabled for synchronization");case 3:return e.n=4,this.getBusyTimesFromCalendars(o);case 4:return r=e.v,e.n=5,this.removeExistingSyncBlocks(o);case 5:return a=e.v,e.n=6,this.createSyncBlocks(o,r);case 6:return c=e.v,this.lastSync=new Date,console.log("Sync completed: ".concat(c," blocks created, ").concat(a," blocks removed")),e.a(2,{blocksCreated:c,blocksRemoved:a,syncTime:this.lastSync});case 7:throw e.p=7,i=e.v,console.error("Sync failed:",i),i;case 8:return e.p=8,this.syncInProgress=!1,e.f(8);case 9:return e.a(2)}},e,this,[[2,7,8,9]])})),function(){return b.apply(this,arguments)})},{key:"getBusyTimesFromCalendars",value:(g=f(l().m(function e(t){var o,r,a,c,i,s,u,d;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:o=new Map,r=n(t),e.p=1,r.s();case 2:if((a=r.n()).done){e.n=8;break}return c=a.value,e.p=3,console.log("Fetching busy times for ".concat(c.name," (").concat(c.userEmail,")")),e.n=4,this.getRealBusyTimes(c);case 4:i=e.v,o.set(c.id,i),console.log("Found ".concat(i.length," busy times in ").concat(c.name)),e.n=7;break;case 5:return e.p=5,u=e.v,console.warn("Failed to get busy times for ".concat(c.name,":"),u),e.n=6,this.simulateGetBusyTimes(c);case 6:s=e.v,o.set(c.id,s);case 7:e.n=2;break;case 8:e.n=10;break;case 9:e.p=9,d=e.v,r.e(d);case 10:return e.p=10,r.f(),e.f(10);case 11:return e.a(2,o)}},e,this,[[3,5],[1,9,10,11]])})),function(e){return g.apply(this,arguments)})},{key:"getRealBusyTimes",value:(v=f(l().m(function e(n){var t,o,r,a,c,i,s,u;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.getGraphAccessToken();case 1:return t=e.v,o=this.targetDate||new Date,(r=new Date(o)).setHours(0,0,0,0),(a=new Date(o)).setHours(23,59,59,999),c="https://graph.microsoft.com/v1.0/me/calendars/".concat(n.id,"/events")+"?$filter=start/dateTime ge '".concat(r.toISOString(),"' and end/dateTime le '").concat(a.toISOString(),"'")+"&$select=subject,start,end,showAs,isPrivate",e.n=2,fetch(c,{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});case 2:if((i=e.v).ok){e.n=3;break}throw new Error("Graph API error: ".concat(i.status," ").concat(i.statusText));case 3:return e.n=4,i.json();case 4:return s=e.v,e.a(2,s.value.filter(function(e){return"busy"===e.showAs||"tentative"===e.showAs}).map(function(e){return{start:new Date(e.start.dateTime),end:new Date(e.end.dateTime),subject:e.isPrivate?"[Private]":e.subject||"[No Subject]",isPrivate:e.isPrivate||!1}}));case 5:throw e.p=5,u=e.v,console.error("Graph API call failed for ".concat(n.name,":"),u),u;case 6:return e.a(2)}},e,this,[[0,5]])})),function(e){return v.apply(this,arguments)})},{key:"simulateGetBusyTimes",value:(m=f(l().m(function e(n){var t,o,r,a,c,i;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,new Promise(function(e){return setTimeout(e,100)});case 1:for(t=new Date,o=[],r=0;r<Math.floor(5*Math.random())+1;r++)a=new Date(t.getTime()+7*Math.random()*24*60*60*1e3),c=60*(3*Math.random()+.5)*60*1e3,i=new Date(a.getTime()+c),o.push({start:a,end:i,subject:"Meeting in ".concat(n.name),isPrivate:!1});return e.a(2,o)}},e)})),function(e){return m.apply(this,arguments)})},{key:"removeExistingSyncBlocks",value:(h=f(l().m(function e(t){var o,r,a,c,i,s,u;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:o=0,r=n(t),e.p=1,r.s();case 2:if((a=r.n()).done){e.n=7;break}return c=a.value,e.p=3,e.n=4,this.simulateRemoveSyncBlocks(c);case 4:i=e.v,o+=i,e.n=6;break;case 5:e.p=5,s=e.v,console.warn("Failed to remove sync blocks from ".concat(c.name,":"),s);case 6:e.n=2;break;case 7:e.n=9;break;case 8:e.p=8,u=e.v,r.e(u);case 9:return e.p=9,r.f(),e.f(9);case 10:return e.a(2,o)}},e,this,[[3,5],[1,8,9,10]])})),function(e){return h.apply(this,arguments)})},{key:"simulateRemoveSyncBlocks",value:(y=f(l().m(function e(n){return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,new Promise(function(e){return setTimeout(e,50)});case 1:return e.a(2,Math.floor(3*Math.random()))}},e)})),function(e){return y.apply(this,arguments)})},{key:"createSyncBlocks",value:(d=f(l().m(function t(r,a){var c,i,s,u,d,f,p,y,h,m,v,g,b;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:c=0,i=n(r),t.p=1,i.s();case 2:if((s=i.n()).done){t.n=7;break}u=s.value,t.p=3,d=[],f=n(a);try{for(f.s();!(p=f.n()).done;)y=e(p.value,2),h=y[0],m=y[1],h!==u.id&&d.push.apply(d,o(m))}catch(e){f.e(e)}finally{f.f()}return t.n=4,this.simulateCreateSyncBlocks(u,d);case 4:v=t.v,c+=v,t.n=6;break;case 5:t.p=5,g=t.v,console.warn("Failed to create sync blocks in ".concat(u.name,":"),g);case 6:t.n=2;break;case 7:t.n=9;break;case 8:t.p=8,b=t.v,i.e(b);case 9:return t.p=9,i.f(),t.f(9);case 10:return t.a(2,c)}},t,this,[[3,5],[1,8,9,10]])})),function(e,n){return d.apply(this,arguments)})},{key:"simulateCreateSyncBlocks",value:(u=f(l().m(function e(n,t){var o,r;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.createRealSyncBlocks(n,t);case 1:return e.a(2,e.v);case 2:return e.p=2,r=e.v,console.warn("Graph API failed, simulating for ".concat(n.name,":"),r),e.n=3,new Promise(function(e){return setTimeout(e,100)});case 3:return o=n.userEmail?"".concat(n.name," (").concat(n.userEmail,")"):n.name,console.log("Would create ".concat(t.length," sync blocks in ").concat(o)),e.a(2,t.length)}},e,this,[[0,2]])})),function(e,n){return u.apply(this,arguments)})},{key:"createRealSyncBlocks",value:(s=f(l().m(function e(t,o){var r,a,c,i,s,u,d,f,p;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this.getGraphAccessToken();case 1:r=e.v,a=0,c=n(o),e.p=2,c.s();case 3:if((i=c.n()).done){e.n=8;break}return s=i.value,e.p=4,u={subject:this.config.busyBlockSubject,start:{dateTime:s.start.toISOString(),timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},end:{dateTime:s.end.toISOString(),timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},showAs:"busy",isPrivate:!0,categories:[this.config.busyBlockCategory],body:{contentType:"text",content:"Auto-synchronized busy time from another calendar"}},e.n=5,fetch("https://graph.microsoft.com/v1.0/me/calendars/".concat(t.id,"/events"),{method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify(u)});case 5:(d=e.v).ok?(a++,console.log("Created sync block in ".concat(t.name,": ").concat(s.start.toLocaleTimeString()," - ").concat(s.end.toLocaleTimeString()))):console.warn("Failed to create sync block in ".concat(t.name,": ").concat(d.status)),e.n=7;break;case 6:e.p=6,f=e.v,console.error("Error creating sync block in ".concat(t.name,":"),f);case 7:e.n=3;break;case 8:e.n=10;break;case 9:e.p=9,p=e.v,c.e(p);case 10:return e.p=10,c.f(),e.f(10);case 11:return console.log("Created ".concat(a," real sync blocks in ").concat(t.name," (").concat(t.userEmail,")")),e.a(2,a)}},e,this,[[4,6],[2,9,10,11]])})),function(e,n){return s.apply(this,arguments)})},{key:"startAutoSync",value:function(){var e=this;this.syncInterval&&clearInterval(this.syncInterval);var n=60*this.config.syncIntervalMinutes*1e3;this.syncInterval=setInterval(function(){e.performSync().catch(function(e){console.error("Auto-sync failed:",e)})},n),console.log("Auto-sync started with ".concat(this.config.syncIntervalMinutes," minute interval"))}},{key:"stopAutoSync",value:function(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null,console.log("Auto-sync stopped"))}},{key:"getSyncStatus",value:(c=f(l().m(function e(){var n;return l().w(function(e){for(;;)switch(e.n){case 0:if(!this.syncInProgress){e.n=1;break}return e.a(2,{state:"Syncing",message:"Synchronization in progress...",lastSync:this.lastSync});case 1:if(this.syncEnabled){e.n=2;break}return e.a(2,{state:"Stopped",message:"Synchronization disabled",lastSync:this.lastSync});case 2:if(!((n=Array.from(this.calendars.values()).filter(function(e){return e.syncEnabled}).length)<2)){e.n=3;break}return e.a(2,{state:"Error",message:"Need at least 2 enabled calendars",lastSync:this.lastSync});case 3:return e.a(2,{state:"Active",message:"Monitoring ".concat(n," calendars"),lastSync:this.lastSync})}},e,this)})),function(){return c.apply(this,arguments)})},{key:"setSyncInterval",value:function(e){this.config.syncIntervalMinutes=e,this.saveConfiguration(),this.syncInterval&&this.startAutoSync()}},{key:"setBusyBlockSubject",value:function(e){this.config.busyBlockSubject=e,this.saveConfiguration()}},{key:"setLookAheadDays",value:function(e){this.config.lookAheadDays=e,this.saveConfiguration()}},{key:"getConfiguration",value:function(){return i({},this.config)}}],a&&p(r.prototype,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,a,c,s,u,d,y,h,m,v,g,b,w,k,S,O,E,C,x,A,I}();function v(){var e,n,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function a(t,o,r,a){var s=o&&o.prototype instanceof i?o:i,l=Object.create(s.prototype);return g(l,"_invoke",function(t,o,r){var a,i,s,l=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return a=n,i=0,s=e,f.n=t,c}};function p(t,o){for(i=t,s=o,n=0;!d&&l&&!r&&n<u.length;n++){var r,a=u[n],p=f.p,y=a[2];t>3?(r=y===o)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((r=t<2&&p<a[1])?(i=0,f.v=o,f.n=a[1]):p<y&&(r=t<3||a[0]>o||o>y)&&(a[4]=t,a[5]=o,f.n=y,i=0))}if(r||t>1)return c;throw d=!0,o}return function(r,u,y){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,y),i=u,s=y;(n=i<2?e:s)||!d;){a||(i?i<3?(i>1&&(f.n=-1),p(i,s)):f.n=s:f.v=s);try{if(l=2,a){if(i||(r="next"),n=a[r]){if(!(n=n.call(a,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,i<2&&(i=0)}else 1===i&&(n=a.return)&&n.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),i=1);a=e}else if((n=(d=f.n<0)?s:t.call(o,f))!==c)break}catch(n){a=e,i=1,s=n}finally{l=1}}return{value:n,done:d}}}(t,r,a),!0),l}var c={};function i(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(g(n={},o,function(){return this}),n),d=l.prototype=i.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,g(e,r,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=l,g(d,"constructor",l),g(l,"constructor",s),s.displayName="GeneratorFunction",g(l,r,"GeneratorFunction"),g(d),g(d,r,"Generator"),g(d,o,function(){return this}),g(d,"toString",function(){return"[object Generator]"}),(v=function(){return{w:a,m:f}})()}function g(e,n,t,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}g=function(e,n,t,o){function a(n,t){g(e,n,function(e){return this._invoke(n,t,e)})}n?r?r(e,n,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},g(e,n,t,o)}function b(e,n,t,o,r,a,c){try{var i=e[a](c),s=i.value}catch(e){return void t(e)}i.done?n(s):Promise.resolve(s).then(o,r)}function w(e){return function(){var n=this,t=arguments;return new Promise(function(o,r){var a=e.apply(n,t);function c(e){b(a,o,r,c,i,"next",e)}function i(e){b(a,o,r,c,i,"throw",e)}c(void 0)})}}function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function S(){document.getElementById("sideload-msg").innerHTML='\n    <div style="color: #d63031; padding: 15px; border: 1px solid #d63031; border-radius: 8px; margin: 10px;">\n      <h3>🚨 Office.js Context Required</h3>\n      <p><strong>Issue:</strong> This add-in needs to run within Microsoft Outlook to access Office.js APIs.</p>\n      \n      <h4>📋 How to test this add-in properly:</h4>\n      <ol style="text-align: left; margin: 10px 0;">\n        <li><strong>Deploy the manifest:</strong> Upload <code>manifest.xml</code> to Microsoft 365 Admin Center</li>\n        <li><strong>Open Outlook:</strong> Use Outlook desktop app or Outlook on the web</li>\n        <li><strong>Find the add-in:</strong> Look for "Sync Calendars" button in the ribbon</li>\n        <li><strong>Click to open:</strong> The add-in will load in a proper Office.js context</li>\n      </ol>\n      \n      <h4>🔧 For development testing:</h4>\n      <ul style="text-align: left; margin: 10px 0;">\n        <li>Use <code>npm run dev-server</code> and sideload in Outlook</li>\n        <li>Or use Office Add-in Development Tools</li>\n        <li>Direct browser testing won\'t have full Office.js capabilities</li>\n      </ul>\n      \n      <p><strong>Current context:</strong> '.concat(window.location.href,'</p>\n      <button onclick="testMockMode();" style="background: #0984e3; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin: 5px;">\n        Test with Mock Data\n      </button>\n      <button onclick="location.reload();" style="background: #636e72; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin: 5px;">\n        Refresh\n      </button>\n    </div>\n  ')}function O(){return E.apply(this,arguments)}function E(){return(E=w(v().m(function e(){var n;return v().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,document.getElementById("sync-now").onclick=I,document.getElementById("configure").onclick=j,e.n=1,h.initialize();case 1:return e.n=2,C();case 2:return e.n=3,B();case 3:setInterval(B,3e4),e.n=5;break;case 4:e.p=4,n=e.v,console.error("Failed to initialize app:",n),M("Error","Initialization failed: ".concat(n.message));case 5:return e.a(2)}},e,null,[[0,4]])}))).apply(this,arguments)}function C(){return x.apply(this,arguments)}function x(){return(x=w(v().m(function e(){var n;return v().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,h.getAvailableCalendars();case 1:A(e.v),e.n=3;break;case 2:e.p=2,n=e.v,console.error("Failed to load calendars:",n),document.getElementById("calendar-list").innerHTML='<div class="error">Failed to load calendars. Please check permissions.</div>';case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function A(e){var n=document.getElementById("calendar-list");0!==e.length?n.innerHTML=e.map(function(e){return'\n    <div class="calendar-item">\n      <div>\n        <div class="calendar-name">'.concat(e.name,'</div>\n        <div class="calendar-status">').concat(e.type," • ").concat(e.itemCount,' items</div>\n      </div>\n      <div class="calendar-toggle">\n        <div class="toggle-switch ').concat(e.syncEnabled?"active":"",'" \n             data-calendar-id="').concat(e.id,'"\n             onclick="toggleCalendarSync(\'').concat(e.id,"')\">\n        </div>\n      </div>\n    </div>\n  ")}).join(""):n.innerHTML='<div class="no-activity">No calendars found</div>'}function I(){return T.apply(this,arguments)}function T(){return(T=w(v().m(function e(){var n,t,o,r;return v().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=document.getElementById("sync-date").value){e.n=1;break}return M("Error","Please select a date to sync"),e.a(2);case 1:return t=new Date(n),M("Syncing","Syncing ".concat(t.toLocaleDateString(),"...")),F(!0),e.n=2,h.performSync(t);case 2:o=e.v,M("Active","Sync completed for ".concat(t.toLocaleDateString(),". ").concat(o.blocksCreated," blocks created, ").concat(o.blocksRemoved," removed.")),L("Sync completed for ".concat(t.toLocaleDateString(),": ").concat(o.blocksCreated," created, ").concat(o.blocksRemoved," removed")),e.n=4;break;case 3:e.p=3,r=e.v,console.error("Sync failed:",r),M("Error","Sync failed: ".concat(r.message)),L("Sync failed: ".concat(r.message));case 4:return e.p=4,F(!1),e.f(4);case 5:return e.a(2)}},e,null,[[0,3,4,5]])}))).apply(this,arguments)}function j(){return P.apply(this,arguments)}function P(){return(P=w(v().m(function e(){return v().w(function(e){for(;;)switch(e.n){case 0:console.log("Configure clicked");case 1:return e.a(2)}},e)}))).apply(this,arguments)}function D(){return(D=w(v().m(function e(n){var t,o,r;return v().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,h.toggleCalendarSync(n);case 1:t=e.v,(o=document.querySelector('[data-calendar-id="'.concat(n,'"]')))&&o.classList.toggle("active",t),L("Calendar sync ".concat(t?"enabled":"disabled"," for calendar")),e.n=3;break;case 2:e.p=2,r=e.v,console.error("Failed to toggle calendar sync:",r),L("Failed to toggle calendar sync: ".concat(r.message));case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function B(){return G.apply(this,arguments)}function G(){return(G=w(v().m(function e(){var n,t;return v().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,h.getSyncStatus();case 1:M((n=e.v).state,n.message),n.lastSync&&(document.getElementById("last-sync").textContent="Last sync: ".concat(new Date(n.lastSync).toLocaleString())),e.n=3;break;case 2:e.p=2,t=e.v,console.error("Failed to get sync status:",t),M("Error","Unable to check sync status");case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function M(e,n){var t=document.getElementById("status-dot"),o=document.getElementById("status-text");switch(t.classList.remove("active","syncing"),e.toLowerCase()){case"active":t.classList.add("active");break;case"syncing":t.classList.add("syncing")}o.textContent=n}function F(e){var n=document.getElementById("sync-now"),t=n.querySelector(".ms-Button-label");n.style.opacity=e?"0.6":"1",n.style.pointerEvents=e?"none":"auto",t.textContent=e?"Syncing...":"Sync Now"}function L(e){var n=document.getElementById("activity-log"),t=n.querySelector(".no-activity");t&&t.remove();var o=document.createElement("div");o.className="activity-item",o.innerHTML='\n    <div class="activity-time">'.concat((new Date).toLocaleTimeString(),"</div>\n    <div>").concat(e,"</div>\n  "),n.insertBefore(o,n.firstChild);var r=n.querySelectorAll(".activity-item");r.length>10&&r[r.length-1].remove()}Office.onReady(function(e){try{var n,t;if(console.log("🚀 Office.onReady called with info:",e),console.log("📊 Office.js diagnostics:"),console.log("  - Office object type:","undefined"==typeof Office?"undefined":k(Office)),console.log("  - Office.context type:",k(null===(n=Office)||void 0===n?void 0:n.context)),console.log("  - Office.context.auth type:",k(null===(t=Office)||void 0===t||null===(t=t.context)||void 0===t?void 0:t.auth)),console.log("  - Host detected:",null==e?void 0:e.host),console.log("  - Host type comparison:",(null==e?void 0:e.host)===Office.HostType.Outlook),console.log("  - Platform:",null==e?void 0:e.platform),e.host===Office.HostType.Outlook||"Outlook"===e.host||window.Office){console.log("✅ Host validated as Outlook-compatible"),document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var o=new Date("2025-08-12");document.getElementById("sync-date").value=o.toISOString().split("T")[0],h=new m,O()}else console.warn("⚠️ Unsupported or unrecognized host application. Host info:",e),document.getElementById("sideload-msg").innerHTML='\n        <div style="color: orange; padding: 10px; border: 1px solid orange; border-radius: 5px;">\n          <h3>🔍 Host Detection Diagnostic</h3>\n          <p><strong>Detected host:</strong> '.concat((null==e?void 0:e.host)||"Unknown","</p>\n          <p><strong>Expected:</strong> Outlook</p>\n          <p><strong>Platform:</strong> ").concat((null==e?void 0:e.platform)||"Unknown","</p>\n          <p><strong>Office.js available:</strong> ").concat(window.Office?"Yes":"No","</p>\n          <p><strong>Status:</strong> Attempting to continue with limited functionality...</p>\n          <button onclick=\"this.parentElement.style.display='none'; document.getElementById('app-body').style.display='flex';\">Continue Anyway</button>\n        </div>\n      "),setTimeout(function(){try{h=new m,O()}catch(e){console.error("❌ Delayed initialization failed:",e)}},1e3)}catch(e){console.error("❌ Office.onReady error:",e),document.getElementById("sideload-msg").innerHTML='\n      <div style="color: red; padding: 10px; border: 1px solid red; border-radius: 5px;">\n        <h3>🚨 Initialization Error</h3>\n        <p><strong>Error:</strong> '.concat(e.message,"</p>\n        <p><strong>Suggestion:</strong> Please ensure this add-in is loaded within Outlook</p>\n        <p><strong>Current URL:</strong> ").concat(window.location.href,"</p>\n        <button onclick=\"location.reload();\">Refresh Page</button>\n        <button onclick=\"this.parentElement.style.display='none'; document.getElementById('app-body').style.display='flex';\">Try Anyway</button>\n      </div>\n    ")}}),window.addEventListener("DOMContentLoaded",function(){setTimeout(function(){if(!h)if(console.log("🔄 Fallback initialization triggered - Office.onReady may not have fired"),console.log("🔍 Office.js status check:"),console.log("  - window.Office available:",!!window.Office),console.log("  - Current URL:",window.location.href),console.log("  - User Agent:",navigator.userAgent),window.Office){console.log("✅ Office.js detected, attempting manual initialization");try{document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var e=new Date("2025-08-12");document.getElementById("sync-date").value=e.toISOString().split("T")[0],h=new m,O()}catch(e){console.error("❌ Fallback initialization failed:",e),S()}}else console.warn("⚠️ Office.js not available - showing context guidance"),S()},2e3)}),window.toggleCalendarSync=function(e){return D.apply(this,arguments)}}(),new URL(t(58394),t.b),new URL(t(98362),t.b)}();
//# sourceMappingURL=taskpane.js.map