/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,n,t){e.exports=t.p+"4724c5daddbe7d202087.css"},98362:function(e,n,t){e.exports=t.p+"assets/logo-filled.png"}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var a=n[r]={exports:{}};return e[r](a,a.exports,t),a.exports}t.m=e,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var r=n.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e}(),t.b=document.baseURI||self.location.href,function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,a,c,i=[],s=!0,l=!1;try{if(a=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(r=a.call(t)).done)&&(i.push(r.value),i.length!==n);s=!0);}catch(e){l=!0,o=e}finally{try{if(!s&&null!=t.return&&(c=t.return(),Object(c)!==c))return}finally{if(l)throw o}}return i}}(e,n)||o(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=o(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,i=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){s=!0,c=e},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw c}}}}function o(e,n){if(e){if("string"==typeof e)return a(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(e,n):void 0}}function a(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach(function(n){s(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function s(e,n,t){return(n=p(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function a(t,r,o,a){var s=r&&r.prototype instanceof i?r:i,l=Object.create(s.prototype);return u(l,"_invoke",function(t,r,o){var a,i,s,l=0,u=o||[],f=!1,d={p:0,n:0,v:e,a:y,f:y.bind(e,4),d:function(n,t){return a=n,i=0,s=e,d.n=t,c}};function y(t,r){for(i=t,s=r,n=0;!f&&l&&!o&&n<u.length;n++){var o,a=u[n],y=d.p,p=a[2];t>3?(o=p===r)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=y&&((o=t<2&&y<a[1])?(i=0,d.v=r,d.n=a[1]):y<p&&(o=t<3||a[0]>r||r>p)&&(a[4]=t,a[5]=r,d.n=p,i=0))}if(o||t>1)return c;throw f=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&y(u,p),i=u,s=p;(n=i<2?e:s)||!f;){a||(i?i<3?(i>1&&(d.n=-1),y(i,s)):d.n=s:d.v=s);try{if(l=2,a){if(i||(o="next"),n=a[o]){if(!(n=n.call(a,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,i<2&&(i=0)}else 1===i&&(n=a.return)&&n.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((n=(f=d.n<0)?s:t.call(r,d))!==c)break}catch(n){a=e,i=1,s=n}finally{l=1}}return{value:n,done:f}}}(t,o,a),!0),l}var c={};function i(){}function s(){}function f(){}n=Object.getPrototypeOf;var d=[][r]?n(n([][r]())):(u(n={},r,function(){return this}),n),y=f.prototype=i.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,u(e,o,"GeneratorFunction")),e.prototype=Object.create(y),e}return s.prototype=f,u(y,"constructor",f),u(f,"constructor",s),s.displayName="GeneratorFunction",u(f,o,"GeneratorFunction"),u(y),u(y,o,"Generator"),u(y,r,function(){return this}),u(y,"toString",function(){return"[object Generator]"}),(l=function(){return{w:a,m:p}})()}function u(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}u=function(e,n,t,r){function a(n,t){u(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},u(e,n,t,r)}function f(e,n,t,r,o,a,c){try{var i=e[a](c),s=i.value}catch(e){return void t(e)}i.done?n(s):Promise.resolve(s).then(r,o)}function d(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var a=e.apply(n,t);function c(e){f(a,r,o,c,i,"next",e)}function i(e){f(a,r,o,c,i,"throw",e)}c(void 0)})}}function y(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(n){var t=function(n){if("object"!=e(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var r=t.call(n,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==e(t)?t:t+""}var v,h=function(){return e=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.syncEnabled=!1,this.calendars=new Map,this.syncInterval=null,this.lastSync=null,this.syncInProgress=!1,this.config={syncIntervalMinutes:15,busyBlockSubject:"[Auto-Sync] Busy",busyBlockCategory:"Auto-Sync",lookAheadDays:0,lookBehindDays:0}},o=[{key:"initialize",value:(I=d(l().m(function e(){var n,t;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,console.log("Initializing Calendar Sync Manager..."),window.Office){e.n=1;break}throw new Error("Office.js is not loaded");case 1:return Office.context&&Office.context.mailbox||console.warn("Limited Office context detected, some features may not work"),console.log("Office context available:",!!Office.context),console.log("Mailbox available:",!(null===(n=Office.context)||void 0===n||!n.mailbox)),e.n=2,this.requestPermissions();case 2:return this.loadConfiguration(),e.n=3,this.discoverCalendars();case 3:this.syncEnabled&&this.startAutoSync(),console.log("Calendar Sync Manager initialized successfully"),e.n=5;break;case 4:throw e.p=4,t=e.v,console.error("Failed to initialize Calendar Sync Manager:",t),t;case 5:return e.a(2)}},e,this,[[0,4]])})),function(){return I.apply(this,arguments)})},{key:"requestPermissions",value:(E=d(l().m(function e(){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){try{if(!Office.context||!Office.context.mailbox)return console.warn("Limited Office context, proceeding with basic initialization"),void e();var t=Office.context.mailbox.diagnostics,r=null==t?void 0:t.hostName;console.log("Host diagnostics:",{hostName:r,hostVersion:null==t?void 0:t.hostVersion,platform:null==t?void 0:t.platform}),"Outlook"!==r&&"OutlookWebApp"!==r&&"OutlookIOS"!==r&&"OutlookAndroid"!==r&&r?(console.warn("Unknown host detected, proceeding anyway:",r),e()):(console.log("Host validation passed for:",r||"unknown host"),e())}catch(n){console.error("Error in requestPermissions:",n),e()}}))},e)})),function(){return E.apply(this,arguments)})},{key:"loadConfiguration",value:function(){try{var e=localStorage.getItem("calendarSync_config");if(e){var n=JSON.parse(e);this.config=i(i({},this.config),n)}var t=localStorage.getItem("calendarSync_enabled");this.syncEnabled="true"===t}catch(e){console.warn("Failed to load configuration:",e)}}},{key:"saveConfiguration",value:function(){try{localStorage.setItem("calendarSync_config",JSON.stringify(this.config)),localStorage.setItem("calendarSync_enabled",this.syncEnabled.toString())}catch(e){console.warn("Failed to save configuration:",e)}}},{key:"discoverCalendars",value:(O=d(l().m(function e(){var n,t,r=this;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Discovering real Microsoft accounts and calendars..."),e.n=1,this.getGraphCalendars();case 1:n=e.v,this.calendars.clear(),n.forEach(function(e){r.calendars.set(e.id,e)}),console.log("Discovered ".concat(this.calendars.size," real calendars:"),Array.from(this.calendars.values()).map(function(e){return"".concat(e.name," (").concat(e.userEmail,")")})),e.n=3;break;case 2:return e.p=2,t=e.v,console.error("Failed to discover calendars:",t),e.n=3,this.discoverMockCalendars();case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return O.apply(this,arguments)})},{key:"getGraphCalendars",value:(k=d(l().m(function e(){var n,t,r,o;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.getGraphAccessToken();case 1:return n=e.v,e.n=2,fetch("https://graph.microsoft.com/v1.0/me/calendars",{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}});case 2:if((t=e.v).ok){e.n=3;break}throw new Error("Graph API error: ".concat(t.status," ").concat(t.statusText));case 3:return e.n=4,t.json();case 4:return r=e.v,e.a(2,r.value.map(function(e){var n;return{id:e.id,name:e.name,userEmail:(null===(n=e.owner)||void 0===n||null===(n=n.emailAddress)||void 0===n?void 0:n.address)||"Unknown",type:"Microsoft Graph",syncEnabled:!0,canEdit:e.canEdit||!1,isDefaultCalendar:e.isDefaultCalendar||!1}}));case 5:throw e.p=5,o=e.v,console.error("Failed to fetch calendars from Graph API:",o),o;case 6:return e.a(2)}},e,this,[[0,5]])})),function(){return k.apply(this,arguments)})},{key:"getGraphAccessToken",value:(S=d(l().m(function e(){var n;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.a(2,new Promise(function(e,n){Office.context.auth.getAccessToken({allowSignInPrompt:!0,allowConsentPrompt:!0,forMSGraphAccess:!0},function(t){t.status===Office.AsyncResultStatus.Succeeded?e(t.value):n(new Error("Authentication failed: ".concat(t.error.message)))})}));case 1:throw e.p=1,n=e.v,console.error("Failed to get Graph access token:",n),n;case 2:return e.a(2)}},e,null,[[0,1]])})),function(){return S.apply(this,arguments)})},{key:"discoverMockCalendars",value:(w=d(l().m(function e(){var n,t=this;return l().w(function(e){for(;;)switch(e.n){case 0:n=[{id:"calendar-1",name:"Primary Work Calendar",userEmail:"user@company1.com",type:"Exchange",syncEnabled:!0,isDefaultCalendar:!0},{id:"calendar-2",name:"Secondary Work Calendar",userEmail:"user@company2.com",type:"Office 365",syncEnabled:!0,isDefaultCalendar:!1},{id:"calendar-3",name:"Personal Calendar",userEmail:"personal@outlook.com",type:"Outlook.com",syncEnabled:!0,isDefaultCalendar:!1}],this.calendars.clear(),n.forEach(function(e){t.calendars.set(e.id,e)}),console.log("Using mock calendars for testing");case 1:return e.a(2)}},e,this)})),function(){return w.apply(this,arguments)})},{key:"getAvailableCalendars",value:(b=d(l().m(function e(){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,Array.from(this.calendars.values()))},e,this)})),function(){return b.apply(this,arguments)})},{key:"toggleCalendarSync",value:function(){var e=d(l().m(function e(n){var t;return l().w(function(e){for(;;)switch(e.n){case 0:if(t=this.calendars.get(n)){e.n=1;break}throw new Error("Calendar not found");case 1:return t.syncEnabled=!t.syncEnabled,this.saveConfiguration(),console.log("Calendar sync ".concat(t.syncEnabled?"enabled":"disabled"," for ").concat(t.name)),e.a(2,t.syncEnabled)}},e,this)}));return function(n){return e.apply(this,arguments)}}()},{key:"performSync",value:(g=d(l().m(function e(){var n,t,r,o,a,c,i,s=arguments;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=s.length>0&&void 0!==s[0]?s[0]:null,!this.syncInProgress){e.n=1;break}throw new Error("Sync already in progress");case 1:if(this.syncInProgress=!0,e.p=2,t=n||new Date,console.log("Starting calendar synchronization for ".concat(t.toLocaleDateString(),"...")),new Date(t).setHours(0,0,0,0),new Date(t).setHours(23,59,59,999),!((r=Array.from(this.calendars.values()).filter(function(e){return e.syncEnabled})).length<2)){e.n=3;break}throw new Error("At least 2 calendars must be enabled for synchronization");case 3:return e.n=4,this.getBusyTimesFromCalendars(r);case 4:return o=e.v,e.n=5,this.removeExistingSyncBlocks(r);case 5:return a=e.v,e.n=6,this.createSyncBlocks(r,o);case 6:return c=e.v,this.lastSync=new Date,console.log("Sync completed: ".concat(c," blocks created, ").concat(a," blocks removed")),e.a(2,{blocksCreated:c,blocksRemoved:a,syncTime:this.lastSync});case 7:throw e.p=7,i=e.v,console.error("Sync failed:",i),i;case 8:return e.p=8,this.syncInProgress=!1,e.f(8);case 9:return e.a(2)}},e,this,[[2,7,8,9]])})),function(){return g.apply(this,arguments)})},{key:"getBusyTimesFromCalendars",value:(m=d(l().m(function e(n){var t,o,a,c,i,s,u,f;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:t=new Map,o=r(n),e.p=1,o.s();case 2:if((a=o.n()).done){e.n=8;break}return c=a.value,e.p=3,console.log("Fetching busy times for ".concat(c.name," (").concat(c.userEmail,")")),e.n=4,this.getRealBusyTimes(c);case 4:i=e.v,t.set(c.id,i),console.log("Found ".concat(i.length," busy times in ").concat(c.name)),e.n=7;break;case 5:return e.p=5,u=e.v,console.warn("Failed to get busy times for ".concat(c.name,":"),u),e.n=6,this.simulateGetBusyTimes(c);case 6:s=e.v,t.set(c.id,s);case 7:e.n=2;break;case 8:e.n=10;break;case 9:e.p=9,f=e.v,o.e(f);case 10:return e.p=10,o.f(),e.f(10);case 11:return e.a(2,t)}},e,this,[[3,5],[1,9,10,11]])})),function(e){return m.apply(this,arguments)})},{key:"getRealBusyTimes",value:(h=d(l().m(function e(n){var t,r,o,a,c,i,s,u;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.getGraphAccessToken();case 1:return t=e.v,r=this.targetDate||new Date,(o=new Date(r)).setHours(0,0,0,0),(a=new Date(r)).setHours(23,59,59,999),c="https://graph.microsoft.com/v1.0/me/calendars/".concat(n.id,"/events")+"?$filter=start/dateTime ge '".concat(o.toISOString(),"' and end/dateTime le '").concat(a.toISOString(),"'")+"&$select=subject,start,end,showAs,isPrivate",e.n=2,fetch(c,{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});case 2:if((i=e.v).ok){e.n=3;break}throw new Error("Graph API error: ".concat(i.status," ").concat(i.statusText));case 3:return e.n=4,i.json();case 4:return s=e.v,e.a(2,s.value.filter(function(e){return"busy"===e.showAs||"tentative"===e.showAs}).map(function(e){return{start:new Date(e.start.dateTime),end:new Date(e.end.dateTime),subject:e.isPrivate?"[Private]":e.subject||"[No Subject]",isPrivate:e.isPrivate||!1}}));case 5:throw e.p=5,u=e.v,console.error("Graph API call failed for ".concat(n.name,":"),u),u;case 6:return e.a(2)}},e,this,[[0,5]])})),function(e){return h.apply(this,arguments)})},{key:"simulateGetBusyTimes",value:(v=d(l().m(function e(n){var t,r,o,a,c,i;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,new Promise(function(e){return setTimeout(e,100)});case 1:for(t=new Date,r=[],o=0;o<Math.floor(5*Math.random())+1;o++)a=new Date(t.getTime()+7*Math.random()*24*60*60*1e3),c=60*(3*Math.random()+.5)*60*1e3,i=new Date(a.getTime()+c),r.push({start:a,end:i,subject:"Meeting in ".concat(n.name),isPrivate:!1});return e.a(2,r)}},e)})),function(e){return v.apply(this,arguments)})},{key:"removeExistingSyncBlocks",value:(p=d(l().m(function e(n){var t,o,a,c,i,s,u;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:t=0,o=r(n),e.p=1,o.s();case 2:if((a=o.n()).done){e.n=7;break}return c=a.value,e.p=3,e.n=4,this.simulateRemoveSyncBlocks(c);case 4:i=e.v,t+=i,e.n=6;break;case 5:e.p=5,s=e.v,console.warn("Failed to remove sync blocks from ".concat(c.name,":"),s);case 6:e.n=2;break;case 7:e.n=9;break;case 8:e.p=8,u=e.v,o.e(u);case 9:return e.p=9,o.f(),e.f(9);case 10:return e.a(2,t)}},e,this,[[3,5],[1,8,9,10]])})),function(e){return p.apply(this,arguments)})},{key:"simulateRemoveSyncBlocks",value:(f=d(l().m(function e(n){return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,new Promise(function(e){return setTimeout(e,50)});case 1:return e.a(2,Math.floor(3*Math.random()))}},e)})),function(e){return f.apply(this,arguments)})},{key:"createSyncBlocks",value:(u=d(l().m(function e(o,a){var c,i,s,u,f,d,y,p,v,h,m,g,b;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:c=0,i=r(o),e.p=1,i.s();case 2:if((s=i.n()).done){e.n=7;break}u=s.value,e.p=3,f=[],d=r(a);try{for(d.s();!(y=d.n()).done;)p=t(y.value,2),v=p[0],h=p[1],v!==u.id&&f.push.apply(f,n(h))}catch(e){d.e(e)}finally{d.f()}return e.n=4,this.simulateCreateSyncBlocks(u,f);case 4:m=e.v,c+=m,e.n=6;break;case 5:e.p=5,g=e.v,console.warn("Failed to create sync blocks in ".concat(u.name,":"),g);case 6:e.n=2;break;case 7:e.n=9;break;case 8:e.p=8,b=e.v,i.e(b);case 9:return e.p=9,i.f(),e.f(9);case 10:return e.a(2,c)}},e,this,[[3,5],[1,8,9,10]])})),function(e,n){return u.apply(this,arguments)})},{key:"simulateCreateSyncBlocks",value:(s=d(l().m(function e(n,t){var r,o;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.createRealSyncBlocks(n,t);case 1:return e.a(2,e.v);case 2:return e.p=2,o=e.v,console.warn("Graph API failed, simulating for ".concat(n.name,":"),o),e.n=3,new Promise(function(e){return setTimeout(e,100)});case 3:return r=n.userEmail?"".concat(n.name," (").concat(n.userEmail,")"):n.name,console.log("Would create ".concat(t.length," sync blocks in ").concat(r)),e.a(2,t.length)}},e,this,[[0,2]])})),function(e,n){return s.apply(this,arguments)})},{key:"createRealSyncBlocks",value:(c=d(l().m(function e(n,t){var o,a,c,i,s,u,f,d,y;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this.getGraphAccessToken();case 1:o=e.v,a=0,c=r(t),e.p=2,c.s();case 3:if((i=c.n()).done){e.n=8;break}return s=i.value,e.p=4,u={subject:this.config.busyBlockSubject,start:{dateTime:s.start.toISOString(),timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},end:{dateTime:s.end.toISOString(),timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},showAs:"busy",isPrivate:!0,categories:[this.config.busyBlockCategory],body:{contentType:"text",content:"Auto-synchronized busy time from another calendar"}},e.n=5,fetch("https://graph.microsoft.com/v1.0/me/calendars/".concat(n.id,"/events"),{method:"POST",headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"},body:JSON.stringify(u)});case 5:(f=e.v).ok?(a++,console.log("Created sync block in ".concat(n.name,": ").concat(s.start.toLocaleTimeString()," - ").concat(s.end.toLocaleTimeString()))):console.warn("Failed to create sync block in ".concat(n.name,": ").concat(f.status)),e.n=7;break;case 6:e.p=6,d=e.v,console.error("Error creating sync block in ".concat(n.name,":"),d);case 7:e.n=3;break;case 8:e.n=10;break;case 9:e.p=9,y=e.v,c.e(y);case 10:return e.p=10,c.f(),e.f(10);case 11:return console.log("Created ".concat(a," real sync blocks in ").concat(n.name," (").concat(n.userEmail,")")),e.a(2,a)}},e,this,[[4,6],[2,9,10,11]])})),function(e,n){return c.apply(this,arguments)})},{key:"startAutoSync",value:function(){var e=this;this.syncInterval&&clearInterval(this.syncInterval);var n=60*this.config.syncIntervalMinutes*1e3;this.syncInterval=setInterval(function(){e.performSync().catch(function(e){console.error("Auto-sync failed:",e)})},n),console.log("Auto-sync started with ".concat(this.config.syncIntervalMinutes," minute interval"))}},{key:"stopAutoSync",value:function(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null,console.log("Auto-sync stopped"))}},{key:"getSyncStatus",value:(a=d(l().m(function e(){var n;return l().w(function(e){for(;;)switch(e.n){case 0:if(!this.syncInProgress){e.n=1;break}return e.a(2,{state:"Syncing",message:"Synchronization in progress...",lastSync:this.lastSync});case 1:if(this.syncEnabled){e.n=2;break}return e.a(2,{state:"Stopped",message:"Synchronization disabled",lastSync:this.lastSync});case 2:if(!((n=Array.from(this.calendars.values()).filter(function(e){return e.syncEnabled}).length)<2)){e.n=3;break}return e.a(2,{state:"Error",message:"Need at least 2 enabled calendars",lastSync:this.lastSync});case 3:return e.a(2,{state:"Active",message:"Monitoring ".concat(n," calendars"),lastSync:this.lastSync})}},e,this)})),function(){return a.apply(this,arguments)})},{key:"setSyncInterval",value:function(e){this.config.syncIntervalMinutes=e,this.saveConfiguration(),this.syncInterval&&this.startAutoSync()}},{key:"setBusyBlockSubject",value:function(e){this.config.busyBlockSubject=e,this.saveConfiguration()}},{key:"setLookAheadDays",value:function(e){this.config.lookAheadDays=e,this.saveConfiguration()}},{key:"getConfiguration",value:function(){return i({},this.config)}}],o&&y(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o,a,c,s,u,f,p,v,h,m,g,b,w,S,k,O,E,I}();function m(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function a(t,r,o,a){var s=r&&r.prototype instanceof i?r:i,l=Object.create(s.prototype);return g(l,"_invoke",function(t,r,o){var a,i,s,l=0,u=o||[],f=!1,d={p:0,n:0,v:e,a:y,f:y.bind(e,4),d:function(n,t){return a=n,i=0,s=e,d.n=t,c}};function y(t,r){for(i=t,s=r,n=0;!f&&l&&!o&&n<u.length;n++){var o,a=u[n],y=d.p,p=a[2];t>3?(o=p===r)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=y&&((o=t<2&&y<a[1])?(i=0,d.v=r,d.n=a[1]):y<p&&(o=t<3||a[0]>r||r>p)&&(a[4]=t,a[5]=r,d.n=p,i=0))}if(o||t>1)return c;throw f=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&y(u,p),i=u,s=p;(n=i<2?e:s)||!f;){a||(i?i<3?(i>1&&(d.n=-1),y(i,s)):d.n=s:d.v=s);try{if(l=2,a){if(i||(o="next"),n=a[o]){if(!(n=n.call(a,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,i<2&&(i=0)}else 1===i&&(n=a.return)&&n.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((n=(f=d.n<0)?s:t.call(r,d))!==c)break}catch(n){a=e,i=1,s=n}finally{l=1}}return{value:n,done:f}}}(t,o,a),!0),l}var c={};function i(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][r]?n(n([][r]())):(g(n={},r,function(){return this}),n),f=l.prototype=i.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,g(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return s.prototype=l,g(f,"constructor",l),g(l,"constructor",s),s.displayName="GeneratorFunction",g(l,o,"GeneratorFunction"),g(f),g(f,o,"Generator"),g(f,r,function(){return this}),g(f,"toString",function(){return"[object Generator]"}),(m=function(){return{w:a,m:d}})()}function g(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}g=function(e,n,t,r){function a(n,t){g(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},g(e,n,t,r)}function b(e,n,t,r,o,a,c){try{var i=e[a](c),s=i.value}catch(e){return void t(e)}i.done?n(s):Promise.resolve(s).then(r,o)}function w(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var a=e.apply(n,t);function c(e){b(a,r,o,c,i,"next",e)}function i(e){b(a,r,o,c,i,"throw",e)}c(void 0)})}}function S(){return k.apply(this,arguments)}function k(){return(k=w(m().m(function e(){var n;return m().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,document.getElementById("sync-now").onclick=T,document.getElementById("configure").onclick=P,e.n=1,v.initialize();case 1:return e.n=2,O();case 2:return e.n=3,B();case 3:setInterval(B,3e4),e.n=5;break;case 4:e.p=4,n=e.v,console.error("Failed to initialize app:",n),D("Error","Initialization failed: ".concat(n.message));case 5:return e.a(2)}},e,null,[[0,4]])}))).apply(this,arguments)}function O(){return E.apply(this,arguments)}function E(){return(E=w(m().m(function e(){var n;return m().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,v.getAvailableCalendars();case 1:I(e.v),e.n=3;break;case 2:e.p=2,n=e.v,console.error("Failed to load calendars:",n),document.getElementById("calendar-list").innerHTML='<div class="error">Failed to load calendars. Please check permissions.</div>';case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function I(e){var n=document.getElementById("calendar-list");0!==e.length?n.innerHTML=e.map(function(e){return'\n    <div class="calendar-item">\n      <div>\n        <div class="calendar-name">'.concat(e.name,'</div>\n        <div class="calendar-status">').concat(e.type," • ").concat(e.itemCount,' items</div>\n      </div>\n      <div class="calendar-toggle">\n        <div class="toggle-switch ').concat(e.syncEnabled?"active":"",'" \n             data-calendar-id="').concat(e.id,'"\n             onclick="toggleCalendarSync(\'').concat(e.id,"')\">\n        </div>\n      </div>\n    </div>\n  ")}).join(""):n.innerHTML='<div class="no-activity">No calendars found</div>'}function T(){return C.apply(this,arguments)}function C(){return(C=w(m().m(function e(){var n,t,r,o;return m().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=document.getElementById("sync-date").value){e.n=1;break}return D("Error","Please select a date to sync"),e.a(2);case 1:return t=new Date(n),D("Syncing","Syncing ".concat(t.toLocaleDateString(),"...")),F(!0),e.n=2,v.performSync(t);case 2:r=e.v,D("Active","Sync completed for ".concat(t.toLocaleDateString(),". ").concat(r.blocksCreated," blocks created, ").concat(r.blocksRemoved," removed.")),M("Sync completed for ".concat(t.toLocaleDateString(),": ").concat(r.blocksCreated," created, ").concat(r.blocksRemoved," removed")),e.n=4;break;case 3:e.p=3,o=e.v,console.error("Sync failed:",o),D("Error","Sync failed: ".concat(o.message)),M("Sync failed: ".concat(o.message));case 4:return e.p=4,F(!1),e.f(4);case 5:return e.a(2)}},e,null,[[0,3,4,5]])}))).apply(this,arguments)}function P(){return j.apply(this,arguments)}function j(){return(j=w(m().m(function e(){return m().w(function(e){for(;;)switch(e.n){case 0:console.log("Configure clicked");case 1:return e.a(2)}},e)}))).apply(this,arguments)}function A(){return(A=w(m().m(function e(n){var t,r,o;return m().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,v.toggleCalendarSync(n);case 1:t=e.v,(r=document.querySelector('[data-calendar-id="'.concat(n,'"]')))&&r.classList.toggle("active",t),M("Calendar sync ".concat(t?"enabled":"disabled"," for calendar")),e.n=3;break;case 2:e.p=2,o=e.v,console.error("Failed to toggle calendar sync:",o),M("Failed to toggle calendar sync: ".concat(o.message));case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function B(){return x.apply(this,arguments)}function x(){return(x=w(m().m(function e(){var n,t;return m().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,v.getSyncStatus();case 1:D((n=e.v).state,n.message),n.lastSync&&(document.getElementById("last-sync").textContent="Last sync: ".concat(new Date(n.lastSync).toLocaleString())),e.n=3;break;case 2:e.p=2,t=e.v,console.error("Failed to get sync status:",t),D("Error","Unable to check sync status");case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function D(e,n){var t=document.getElementById("status-dot"),r=document.getElementById("status-text");switch(t.classList.remove("active","syncing"),e.toLowerCase()){case"active":t.classList.add("active");break;case"syncing":t.classList.add("syncing")}r.textContent=n}function F(e){var n=document.getElementById("sync-now"),t=n.querySelector(".ms-Button-label");n.style.opacity=e?"0.6":"1",n.style.pointerEvents=e?"none":"auto",t.textContent=e?"Syncing...":"Sync Now"}function M(e){var n=document.getElementById("activity-log"),t=n.querySelector(".no-activity");t&&t.remove();var r=document.createElement("div");r.className="activity-item",r.innerHTML='\n    <div class="activity-time">'.concat((new Date).toLocaleTimeString(),"</div>\n    <div>").concat(e,"</div>\n  "),n.insertBefore(r,n.firstChild);var o=n.querySelectorAll(".activity-item");o.length>10&&o[o.length-1].remove()}Office.onReady(function(e){try{if(console.log("Office.onReady called with info:",e),e.host===Office.HostType.Outlook||"Outlook"===e.host||window.Office){console.log("Host validated as Outlook"),document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var n=new Date("2025-08-12");document.getElementById("sync-date").value=n.toISOString().split("T")[0],v=new h,S()}else console.error("Unsupported host application. Host info:",e),document.getElementById("sideload-msg").innerHTML='\n        <div style="color: red; padding: 10px;">\n          <h3>Host Detection Issue</h3>\n          <p>Detected host: '.concat(e.host,"</p>\n          <p>Expected: Outlook</p>\n          <p>Trying to continue anyway...</p>\n        </div>\n      "),v=new h,S()}catch(e){console.error("Office.onReady error:",e),document.getElementById("sideload-msg").innerHTML='\n      <div style="color: red; padding: 10px;">\n        <h3>Initialization Error</h3>\n        <p>'.concat(e.message,"</p>\n        <p>Please try refreshing the page</p>\n      </div>\n    ")}}),window.addEventListener("DOMContentLoaded",function(){setTimeout(function(){if(!v&&window.Office){console.log("Fallback initialization triggered");try{document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var e=new Date("2025-08-12");document.getElementById("sync-date").value=e.toISOString().split("T")[0],v=new h,S()}catch(e){console.error("Fallback initialization failed:",e)}}},2e3)}),window.toggleCalendarSync=function(e){return A.apply(this,arguments)}}(),new URL(t(58394),t.b),new URL(t(98362),t.b)}();
//# sourceMappingURL=taskpane.js.map