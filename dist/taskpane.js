/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var n={7312:function(n,e,t){n.exports=t.p+"ac1324ae48c8c3a39716.js"},14037:function(n,e,t){n.exports=t.p+"9dc77d9f3cd66a63616d.js"},44809:function(n,e,t){n.exports=t.p+"885014488e15b894a155.js"},53394:function(n,e,t){n.exports=t.p+"d3683f260e47cdfa0219.js"},58394:function(n,e,t){n.exports=t.p+"4724c5daddbe7d202087.css"},60947:function(n,e,t){n.exports=t.p+"e42127896f084e84aee9.js"},61712:function(n,e,t){n.exports=t.p+"dc73e06fbf5d268837ba.js"},62587:function(n,e,t){n.exports=t.p+"80e36442900037eb5c93.css"},98362:function(n,e,t){n.exports=t.p+"assets/logo-filled.png"}},e={};function t(o){var a=e[o];if(void 0!==a)return a.exports;var r=e[o]={exports:{}};return n[o](r,r.exports,t),r.exports}t.m=n,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},function(){var n;t.g.importScripts&&(n=t.g.location+"");var e=t.g.document;if(!n&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(n=e.currentScript.src),!n)){var o=e.getElementsByTagName("script");if(o.length)for(var a=o.length-1;a>-1&&(!n||!/^http(s?):/.test(n));)n=o[a--].src}if(!n)throw new Error("Automatic publicPath is not supported in this browser");n=n.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=n}(),t.b=document.baseURI||self.location.href,function(){function n(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var o,a,r,c,i=[],s=!0,l=!1;try{if(r=(t=t.call(n)).next,0===e){if(Object(t)!==t)return;s=!1}else for(;!(s=(o=r.call(t)).done)&&(i.push(o.value),i.length!==e);s=!0);}catch(n){l=!0,a=n}finally{try{if(!s&&null!=t.return&&(c=t.return(),Object(c)!==c))return}finally{if(l)throw a}}return i}}(n,e)||a(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(n,e){var t="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=a(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var o=0,r=function(){};return{s:r,n:function(){return o>=n.length?{done:!0}:{done:!1,value:n[o++]}},e:function(n){throw n},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,i=!0,s=!1;return{s:function(){t=t.call(n)},n:function(){var n=t.next();return i=n.done,n},e:function(n){s=!0,c=n},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw c}}}}function t(n){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},t(n)}function o(n){return function(n){if(Array.isArray(n))return r(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||a(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(n,e){if(n){if("string"==typeof n)return r(n,e);var t={}.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?r(n,e):void 0}}function r(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,o=Array(e);t<e;t++)o[t]=n[t];return o}function c(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),t.push.apply(t,o)}return t}function i(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?c(Object(t),!0).forEach(function(e){s(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}function s(n,e,t){return(e=y(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function l(){var n,e,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function r(t,o,a,r){var s=o&&o.prototype instanceof i?o:i,l=Object.create(s.prototype);return u(l,"_invoke",function(t,o,a){var r,i,s,l=0,u=a||[],d=!1,f={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(e,t){return r=e,i=0,s=n,f.n=t,c}};function p(t,o){for(i=t,s=o,e=0;!d&&l&&!a&&e<u.length;e++){var a,r=u[e],p=f.p,y=r[2];t>3?(a=y===o)&&(s=r[(i=r[4])?5:(i=3,3)],r[4]=r[5]=n):r[0]<=p&&((a=t<2&&p<r[1])?(i=0,f.v=o,f.n=r[1]):p<y&&(a=t<3||r[0]>o||o>y)&&(r[4]=t,r[5]=o,f.n=y,i=0))}if(a||t>1)return c;throw d=!0,o}return function(a,u,y){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,y),i=u,s=y;(e=i<2?n:s)||!d;){r||(i?i<3?(i>1&&(f.n=-1),p(i,s)):f.n=s:f.v=s);try{if(l=2,r){if(i||(a="next"),e=r[a]){if(!(e=e.call(r,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,i<2&&(i=0)}else 1===i&&(e=r.return)&&e.call(r),i<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),i=1);r=n}else if((e=(d=f.n<0)?s:t.call(o,f))!==c)break}catch(e){r=n,i=1,s=e}finally{l=1}}return{value:e,done:d}}}(t,a,r),!0),l}var c={};function i(){}function s(){}function d(){}e=Object.getPrototypeOf;var f=[][o]?e(e([][o]())):(u(e={},o,function(){return this}),e),p=d.prototype=i.prototype=Object.create(f);function y(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,d):(n.__proto__=d,u(n,a,"GeneratorFunction")),n.prototype=Object.create(p),n}return s.prototype=d,u(p,"constructor",d),u(d,"constructor",s),s.displayName="GeneratorFunction",u(d,a,"GeneratorFunction"),u(p),u(p,a,"Generator"),u(p,o,function(){return this}),u(p,"toString",function(){return"[object Generator]"}),(l=function(){return{w:r,m:y}})()}function u(n,e,t,o){var a=Object.defineProperty;try{a({},"",{})}catch(n){a=0}u=function(n,e,t,o){function r(e,t){u(n,e,function(n){return this._invoke(e,t,n)})}e?a?a(n,e,{value:t,enumerable:!o,configurable:!o,writable:!o}):n[e]=t:(r("next",0),r("throw",1),r("return",2))},u(n,e,t,o)}function d(n,e,t,o,a,r,c){try{var i=n[r](c),s=i.value}catch(n){return void t(n)}i.done?e(s):Promise.resolve(s).then(o,a)}function f(n){return function(){var e=this,t=arguments;return new Promise(function(o,a){var r=n.apply(e,t);function c(n){d(r,o,a,c,i,"next",n)}function i(n){d(r,o,a,c,i,"throw",n)}c(void 0)})}}function p(n,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,y(o.key),o)}}function y(n){var e=function(n){if("object"!=t(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var o=e.call(n,"string");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==t(e)?e:e+""}var m=function(){return a=function n(){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.syncEnabled=!1,this.calendars=new Map,this.syncInterval=null,this.lastSync=null,this.syncInProgress=!1,this.config={syncIntervalMinutes:15,busyBlockSubject:"[Auto-Sync] Busy",busyBlockCategory:"Auto-Sync",lookAheadDays:0,lookBehindDays:0}},r=[{key:"initialize",value:(I=f(l().m(function n(){var e,t;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:if(n.p=0,console.log("Initializing Calendar Sync Manager..."),window.Office){n.n=1;break}throw new Error("Office.js is not loaded");case 1:return Office.context&&Office.context.mailbox||console.warn("Limited Office context detected, some features may not work"),console.log("Office context available:",!!Office.context),console.log("Mailbox available:",!(null===(e=Office.context)||void 0===e||!e.mailbox)),n.n=2,this.requestPermissions();case 2:return this.loadConfiguration(),n.n=3,this.discoverCalendars();case 3:this.syncEnabled&&this.startAutoSync(),console.log("Calendar Sync Manager initialized successfully"),n.n=5;break;case 4:throw n.p=4,t=n.v,console.error("Failed to initialize Calendar Sync Manager:",t),t;case 5:return n.a(2)}},n,this,[[0,4]])})),function(){return I.apply(this,arguments)})},{key:"requestPermissions",value:(C=f(l().m(function n(){return l().w(function(n){for(;;)if(0===n.n)return n.a(2,new Promise(function(n,e){try{if(!Office.context||!Office.context.mailbox)return console.warn("Limited Office context, proceeding with basic initialization"),void n();var t=Office.context.mailbox.diagnostics,o=null==t?void 0:t.hostName;console.log("Host diagnostics:",{hostName:o,hostVersion:null==t?void 0:t.hostVersion,platform:null==t?void 0:t.platform}),"Outlook"!==o&&"OutlookWebApp"!==o&&"OutlookIOS"!==o&&"OutlookAndroid"!==o&&o?(console.warn("Unknown host detected, proceeding anyway:",o),n()):(console.log("Host validation passed for:",o||"unknown host"),n())}catch(e){console.error("Error in requestPermissions:",e),n()}}))},n)})),function(){return C.apply(this,arguments)})},{key:"loadConfiguration",value:function(){try{var n=localStorage.getItem("calendarSync_config");if(n){var e=JSON.parse(n);this.config=i(i({},this.config),e)}var t=localStorage.getItem("calendarSync_enabled");this.syncEnabled="true"===t}catch(n){console.warn("Failed to load configuration:",n)}}},{key:"saveConfiguration",value:function(){try{localStorage.setItem("calendarSync_config",JSON.stringify(this.config)),localStorage.setItem("calendarSync_enabled",this.syncEnabled.toString())}catch(n){console.warn("Failed to save configuration:",n)}}},{key:"discoverCalendars",value:(A=f(l().m(function n(){var e,t,o,a=this;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,console.log("Discovering real Microsoft accounts and calendars..."),n.n=1,this.getGraphCalendars();case 1:if(!((e=n.v)&&e.length>0)){n.n=2;break}this.calendars.clear(),e.forEach(function(n){a.calendars.set(n.id,n)}),console.log("✅ Discovered ".concat(this.calendars.size," real calendars from Graph API:")),Array.from(this.calendars.values()).forEach(function(n){console.log("  📅 ".concat(n.name," (").concat(n.userEmail,") - Default: ").concat(n.isDefaultCalendar))}),n.n=3;break;case 2:throw new Error("No calendars returned from Graph API");case 3:case 6:n.n=8;break;case 4:return n.p=4,t=n.v,console.warn("⚠️ Graph API discovery failed, checking why:",t),n.p=5,n.n=6,this.tryAlternativeDiscovery();case 7:return n.p=7,o=n.v,console.warn("⚠️ Alternative discovery also failed:",o),console.log("📝 Using enhanced mock data with email simulation..."),n.n=8,this.discoverEnhancedMockCalendars();case 8:return n.a(2)}},n,this,[[5,7],[0,4]])})),function(){return A.apply(this,arguments)})},{key:"tryAlternativeDiscovery",value:(O=f(l().m(function n(){var e,t,o,a,r,c,i,s,u=this;return l().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,this.getGraphAccessToken();case 1:return e=n.v,console.log("🔍 Testing Graph API access with user profile..."),n.n=2,fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});case 2:if((t=n.v).ok){n.n=3;break}throw new Error("Profile API error: ".concat(t.status," ").concat(t.statusText));case 3:return n.n=4,t.json();case 4:return o=n.v,console.log("✅ Authenticated as: ".concat(o.displayName," (").concat(o.mail||o.userPrincipalName,")")),n.n=5,fetch("https://graph.microsoft.com/v1.0/me/calendars",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});case 5:if((a=n.v).ok){n.n=7;break}return n.n=6,a.text();case 6:throw r=n.v,new Error("Calendars API error: ".concat(a.status," ").concat(a.statusText," - ").concat(r));case 7:return n.n=8,a.json();case 8:c=n.v,console.log("📅 Raw calendar data from Graph:",c),i=o.mail||o.userPrincipalName,s=c.value.map(function(n){var e;return{id:n.id,name:n.name,userEmail:(null===(e=n.owner)||void 0===e||null===(e=e.emailAddress)||void 0===e?void 0:e.address)||i,type:"Microsoft Graph",syncEnabled:!0,canEdit:n.canEdit||!1,isDefaultCalendar:n.isDefaultCalendar||!1}}),this.calendars.clear(),s.forEach(function(n){u.calendars.set(n.id,n)}),console.log("✅ Successfully discovered ".concat(s.length," calendars with emails"));case 9:return n.a(2)}},n,this)})),function(){return O.apply(this,arguments)})},{key:"discoverEnhancedMockCalendars",value:(E=f(l().m(function n(){var e,t=this;return l().w(function(n){for(;;)switch(n.n){case 0:e=[{id:"calendar-1",name:"Primary Work Calendar",userEmail:"dan.hookham@company1.com",type:"Exchange Online",syncEnabled:!0,isDefaultCalendar:!0},{id:"calendar-2",name:"Secondary Work Calendar",userEmail:"dan.hookham@company2.com",type:"Office 365",syncEnabled:!0,isDefaultCalendar:!1},{id:"calendar-3",name:"Personal Calendar",userEmail:"dan.hookham@outlook.com",type:"Outlook.com",syncEnabled:!0,isDefaultCalendar:!1},{id:"calendar-4",name:"Project Calendar",userEmail:"dan.hookham@company3.com",type:"Exchange",syncEnabled:!0,isDefaultCalendar:!1},{id:"calendar-5",name:"Client Calendar",userEmail:"dan.hookham@company4.com",type:"Office 365",syncEnabled:!0,isDefaultCalendar:!1}],this.calendars.clear(),e.forEach(function(n){t.calendars.set(n.id,n)}),console.log("📝 Using enhanced mock calendars with email addresses:"),e.forEach(function(n){console.log("  📅 ".concat(n.name," (").concat(n.userEmail,")"))});case 1:return n.a(2)}},n,this)})),function(){return E.apply(this,arguments)})},{key:"getGraphCalendars",value:(x=f(l().m(function n(){var e,t,a,r,c,i,s,u,d,f,p,y,m,v,h,g;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,this.getGraphAccessToken();case 1:return e=n.v,console.log("🔐 Graph access token obtained, fetching calendars..."),n.n=2,fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});case 2:if((t=n.v).ok){n.n=3;break}throw new Error("Profile API failed: ".concat(t.status));case 3:return n.n=4,t.json();case 4:return a=n.v,r=a.mail||a.userPrincipalName,console.log("👤 Primary user: ".concat(a.displayName," (").concat(r,")")),n.n=5,fetch("https://graph.microsoft.com/v1.0/me/calendars?$select=id,name,canEdit,isDefaultCalendar,owner",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});case 5:if((c=n.v).ok){n.n=7;break}return n.n=6,c.text();case 6:throw i=n.v,console.error("Calendar API error response:",i),new Error("Calendar API failed: ".concat(c.status," - ").concat(i));case 7:return n.n=8,c.json();case 8:if(s=n.v,console.log("📊 Raw Graph calendar response:",s),s.value&&0!==s.value.length){n.n=9;break}return console.warn("⚠️ No calendars found in Graph response"),n.a(2,[]);case 9:return u=[],n.p=10,n.n=11,fetch("https://graph.microsoft.com/v1.0/me/calendarGroups?$expand=calendars",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});case 11:if(!(d=n.v).ok){n.n=13;break}return n.n=12,d.json();case 12:p=n.v,console.log("📂 Calendar groups found:",p),null===(f=p.value)||void 0===f||f.forEach(function(n){n.calendars&&u.push.apply(u,o(n.calendars))});case 13:n.n=15;break;case 14:n.p=14,h=n.v,console.log("ℹ️ Calendar groups not accessible (normal for some accounts):",h.message);case 15:return y=[].concat(o(s.value),u),m=y.filter(function(n,e,t){return e===t.findIndex(function(e){return e.id===n.id})}),console.log("📅 Found ".concat(m.length," total calendars (").concat(s.value.length," primary + ").concat(u.length," from groups)")),v=m.map(function(n){var e,t=(null===(e=n.owner)||void 0===e||null===(e=e.emailAddress)||void 0===e?void 0:e.address)||r;return{id:n.id,name:n.name||"Unnamed Calendar",userEmail:t,type:"Microsoft Graph",syncEnabled:!0,canEdit:!1!==n.canEdit,isDefaultCalendar:n.isDefaultCalendar||!1}}),console.log("✅ Processed calendars:"),v.forEach(function(n){console.log('  📅 "'.concat(n.name,'" owned by ').concat(n.userEmail," (Default: ").concat(n.isDefaultCalendar,", Editable: ").concat(n.canEdit,")"))}),n.a(2,v);case 16:throw n.p=16,g=n.v,console.error("❌ getGraphCalendars failed:",g),console.log("🔄 Will attempt alternative discovery or fall back to mock data"),g;case 17:return n.a(2)}},n,this,[[10,14],[0,16]])})),function(){return x.apply(this,arguments)})},{key:"getGraphAccessToken",value:(S=f(l().m(function n(){var e,o,a,r,c,i;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:if(n.p=0,console.log("🔐 Requesting Graph access token..."),console.log("🔍 Checking Office.js availability:"),console.log("  - Office object:","undefined"==typeof Office?"undefined":t(Office)),console.log("  - Office.context:",t(null===(e=Office)||void 0===e?void 0:e.context)),console.log("  - Office.context.auth:",t(null===(o=Office)||void 0===o||null===(o=o.context)||void 0===o?void 0:o.auth)),console.log("  - getAccessToken method:",t(null===(a=Office)||void 0===a||null===(a=a.context)||void 0===a||null===(a=a.auth)||void 0===a?void 0:a.getAccessToken)),null!==(r=Office)&&void 0!==r&&null!==(r=r.context)&&void 0!==r&&r.host&&(console.log("🏢 Host application:",Office.context.host),console.log("📱 Platform:",Office.context.platform),console.log("🔧 Requirements:",Office.context.requirements)),null!==(c=Office)&&void 0!==c&&null!==(c=c.context)&&void 0!==c&&null!==(c=c.auth)&&void 0!==c&&c.getAccessToken){n.n=2;break}if(console.warn("⚠️ Office.js authentication not available in this context"),console.log("🔄 Attempting alternative authentication methods..."),"undefined"==typeof window||!window.location){n.n=1;break}throw console.log("🌐 Running in web context:",window.location.href),new Error("Office.js SSO not available - add-in may need to be loaded in proper Office context");case 1:throw new Error("Office.js authentication not available in this context");case 2:return console.log("✅ Office.js authentication is available, requesting token..."),n.a(2,new Promise(function(n,e){var t={allowSignInPrompt:!0,allowConsentPrompt:!0,forMSGraphAccess:!0};console.log("📋 Token request options:",t),Office.context.auth.getAccessToken(t,function(t){if(console.log("🔍 Auth result status:",t.status),console.log("🔍 Full auth result:",t),t.status===Office.AsyncResultStatus.Succeeded)console.log("✅ Access token obtained successfully"),console.log("🎫 Token preview:",t.value.substring(0,20)+"..."),console.log("🎫 Token length:",t.value.length),n(t.value);else{var o,a,r,c,i,s,l,u,d,f,p;console.error("❌ Authentication failed:",t.error),console.error("Error code:",null===(o=t.error)||void 0===o?void 0:o.code),console.error("Error message:",null===(a=t.error)||void 0===a?void 0:a.message),console.error("Error name:",null===(r=t.error)||void 0===r?void 0:r.name),console.error("Error tracing:",null===(c=t.error)||void 0===c?void 0:c.tracing);var y="Authentication failed: ".concat((null===(i=t.error)||void 0===i?void 0:i.message)||"Unknown error");13001===(null===(s=t.error)||void 0===s?void 0:s.code)?y+=" (User not signed in - this may require signing into Office)":13002===(null===(l=t.error)||void 0===l?void 0:l.code)?y+=" (User consent required - admin may need to grant permissions)":13003===(null===(u=t.error)||void 0===u?void 0:u.code)?y+=" (Invalid audience - token scope issue)":13006===(null===(d=t.error)||void 0===d?void 0:d.code)?y+=" (Invalid request - check add-in manifest permissions)":13007===(null===(f=t.error)||void 0===f?void 0:f.code)?y+=" (Invalid grant - user may need to re-authenticate)":13012===(null===(p=t.error)||void 0===p?void 0:p.code)&&(y+=" (Add-in not trusted - may need admin consent)"),e(new Error(y))}})}));case 3:throw n.p=3,i=n.v,console.error("❌ Failed to get Graph access token:",i),console.log("💡 Troubleshooting suggestions:"),console.log("  1. Ensure add-in is loaded in Outlook (not just web browser)"),console.log("  2. Check that manifest is properly deployed"),console.log("  3. Verify Office.js is fully loaded"),console.log("  4. Check manifest WebApplicationInfo configuration"),new Error("Authentication setup failed: ".concat(i.message));case 4:return n.a(2)}},n,null,[[0,3]])})),function(){return S.apply(this,arguments)})},{key:"discoverMockCalendars",value:(k=f(l().m(function n(){var e,t=this;return l().w(function(n){for(;;)switch(n.n){case 0:e=[{id:"calendar-1",name:"Primary Work Calendar",userEmail:"user@company1.com",type:"Exchange",syncEnabled:!0,isDefaultCalendar:!0},{id:"calendar-2",name:"Secondary Work Calendar",userEmail:"user@company2.com",type:"Office 365",syncEnabled:!0,isDefaultCalendar:!1},{id:"calendar-3",name:"Personal Calendar",userEmail:"personal@outlook.com",type:"Outlook.com",syncEnabled:!0,isDefaultCalendar:!1}],this.calendars.clear(),e.forEach(function(n){t.calendars.set(n.id,n)}),console.log("Using mock calendars for testing");case 1:return n.a(2)}},n,this)})),function(){return k.apply(this,arguments)})},{key:"getAvailableCalendars",value:(w=f(l().m(function n(){return l().w(function(n){for(;;)if(0===n.n)return n.a(2,Array.from(this.calendars.values()))},n,this)})),function(){return w.apply(this,arguments)})},{key:"toggleCalendarSync",value:function(){var n=f(l().m(function n(e){var t;return l().w(function(n){for(;;)switch(n.n){case 0:if(t=this.calendars.get(e)){n.n=1;break}throw new Error("Calendar not found");case 1:return t.syncEnabled=!t.syncEnabled,this.saveConfiguration(),console.log("Calendar sync ".concat(t.syncEnabled?"enabled":"disabled"," for ").concat(t.name)),n.a(2,t.syncEnabled)}},n,this)}));return function(e){return n.apply(this,arguments)}}()},{key:"performSync",value:(b=f(l().m(function n(){var e,t,o,a,r,c,i,s=arguments;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:if(e=s.length>0&&void 0!==s[0]?s[0]:null,!this.syncInProgress){n.n=1;break}throw new Error("Sync already in progress");case 1:if(this.syncInProgress=!0,n.p=2,t=e||new Date,console.log("Starting calendar synchronization for ".concat(t.toLocaleDateString(),"...")),new Date(t).setHours(0,0,0,0),new Date(t).setHours(23,59,59,999),!((o=Array.from(this.calendars.values()).filter(function(n){return n.syncEnabled})).length<2)){n.n=3;break}throw new Error("At least 2 calendars must be enabled for synchronization");case 3:return n.n=4,this.getBusyTimesFromCalendars(o);case 4:return a=n.v,n.n=5,this.removeExistingSyncBlocks(o);case 5:return r=n.v,n.n=6,this.createSyncBlocks(o,a);case 6:return c=n.v,this.lastSync=new Date,console.log("Sync completed: ".concat(c," blocks created, ").concat(r," blocks removed")),n.a(2,{blocksCreated:c,blocksRemoved:r,syncTime:this.lastSync});case 7:throw n.p=7,i=n.v,console.error("Sync failed:",i),i;case 8:return n.p=8,this.syncInProgress=!1,n.f(8);case 9:return n.a(2)}},n,this,[[2,7,8,9]])})),function(){return b.apply(this,arguments)})},{key:"getBusyTimesFromCalendars",value:(g=f(l().m(function n(t){var o,a,r,c,i,s,u,d;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:o=new Map,a=e(t),n.p=1,a.s();case 2:if((r=a.n()).done){n.n=8;break}return c=r.value,n.p=3,console.log("Fetching busy times for ".concat(c.name," (").concat(c.userEmail,")")),n.n=4,this.getRealBusyTimes(c);case 4:i=n.v,o.set(c.id,i),console.log("Found ".concat(i.length," busy times in ").concat(c.name)),n.n=7;break;case 5:return n.p=5,u=n.v,console.warn("Failed to get busy times for ".concat(c.name,":"),u),n.n=6,this.simulateGetBusyTimes(c);case 6:s=n.v,o.set(c.id,s);case 7:n.n=2;break;case 8:n.n=10;break;case 9:n.p=9,d=n.v,a.e(d);case 10:return n.p=10,a.f(),n.f(10);case 11:return n.a(2,o)}},n,this,[[3,5],[1,9,10,11]])})),function(n){return g.apply(this,arguments)})},{key:"getRealBusyTimes",value:(h=f(l().m(function n(e){var t,o,a,r,c,i,s,u;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,this.getGraphAccessToken();case 1:return t=n.v,o=this.targetDate||new Date,(a=new Date(o)).setHours(0,0,0,0),(r=new Date(o)).setHours(23,59,59,999),c="https://graph.microsoft.com/v1.0/me/calendars/".concat(e.id,"/events")+"?$filter=start/dateTime ge '".concat(a.toISOString(),"' and end/dateTime le '").concat(r.toISOString(),"'")+"&$select=subject,start,end,showAs,isPrivate",n.n=2,fetch(c,{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});case 2:if((i=n.v).ok){n.n=3;break}throw new Error("Graph API error: ".concat(i.status," ").concat(i.statusText));case 3:return n.n=4,i.json();case 4:return s=n.v,n.a(2,s.value.filter(function(n){return"busy"===n.showAs||"tentative"===n.showAs}).map(function(n){return{start:new Date(n.start.dateTime),end:new Date(n.end.dateTime),subject:n.isPrivate?"[Private]":n.subject||"[No Subject]",isPrivate:n.isPrivate||!1}}));case 5:throw n.p=5,u=n.v,console.error("Graph API call failed for ".concat(e.name,":"),u),u;case 6:return n.a(2)}},n,this,[[0,5]])})),function(n){return h.apply(this,arguments)})},{key:"simulateGetBusyTimes",value:(v=f(l().m(function n(e){var t,o,a,r,c,i;return l().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,new Promise(function(n){return setTimeout(n,100)});case 1:for(t=new Date,o=[],a=0;a<Math.floor(5*Math.random())+1;a++)r=new Date(t.getTime()+7*Math.random()*24*60*60*1e3),c=60*(3*Math.random()+.5)*60*1e3,i=new Date(r.getTime()+c),o.push({start:r,end:i,subject:"Meeting in ".concat(e.name),isPrivate:!1});return n.a(2,o)}},n)})),function(n){return v.apply(this,arguments)})},{key:"removeExistingSyncBlocks",value:(m=f(l().m(function n(t){var o,a,r,c,i,s,u;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:o=0,a=e(t),n.p=1,a.s();case 2:if((r=a.n()).done){n.n=7;break}return c=r.value,n.p=3,n.n=4,this.simulateRemoveSyncBlocks(c);case 4:i=n.v,o+=i,n.n=6;break;case 5:n.p=5,s=n.v,console.warn("Failed to remove sync blocks from ".concat(c.name,":"),s);case 6:n.n=2;break;case 7:n.n=9;break;case 8:n.p=8,u=n.v,a.e(u);case 9:return n.p=9,a.f(),n.f(9);case 10:return n.a(2,o)}},n,this,[[3,5],[1,8,9,10]])})),function(n){return m.apply(this,arguments)})},{key:"simulateRemoveSyncBlocks",value:(y=f(l().m(function n(e){return l().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,new Promise(function(n){return setTimeout(n,50)});case 1:return n.a(2,Math.floor(3*Math.random()))}},n)})),function(n){return y.apply(this,arguments)})},{key:"createSyncBlocks",value:(d=f(l().m(function t(a,r){var c,i,s,u,d,f,p,y,m,v,h,g,b;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:c=0,i=e(a),t.p=1,i.s();case 2:if((s=i.n()).done){t.n=7;break}u=s.value,t.p=3,d=[],f=e(r);try{for(f.s();!(p=f.n()).done;)y=n(p.value,2),m=y[0],v=y[1],m!==u.id&&d.push.apply(d,o(v))}catch(n){f.e(n)}finally{f.f()}return t.n=4,this.simulateCreateSyncBlocks(u,d);case 4:h=t.v,c+=h,t.n=6;break;case 5:t.p=5,g=t.v,console.warn("Failed to create sync blocks in ".concat(u.name,":"),g);case 6:t.n=2;break;case 7:t.n=9;break;case 8:t.p=8,b=t.v,i.e(b);case 9:return t.p=9,i.f(),t.f(9);case 10:return t.a(2,c)}},t,this,[[3,5],[1,8,9,10]])})),function(n,e){return d.apply(this,arguments)})},{key:"simulateCreateSyncBlocks",value:(u=f(l().m(function n(e,t){var o,a;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,this.createRealSyncBlocks(e,t);case 1:return n.a(2,n.v);case 2:return n.p=2,a=n.v,console.warn("Graph API failed, simulating for ".concat(e.name,":"),a),n.n=3,new Promise(function(n){return setTimeout(n,100)});case 3:return o=e.userEmail?"".concat(e.name," (").concat(e.userEmail,")"):e.name,console.log("Would create ".concat(t.length," sync blocks in ").concat(o)),n.a(2,t.length)}},n,this,[[0,2]])})),function(n,e){return u.apply(this,arguments)})},{key:"createRealSyncBlocks",value:(s=f(l().m(function n(t,o){var a,r,c,i,s,u,d,f,p;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.n=1,this.getGraphAccessToken();case 1:a=n.v,r=0,c=e(o),n.p=2,c.s();case 3:if((i=c.n()).done){n.n=8;break}return s=i.value,n.p=4,u={subject:this.config.busyBlockSubject,start:{dateTime:s.start.toISOString(),timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},end:{dateTime:s.end.toISOString(),timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},showAs:"busy",isPrivate:!0,categories:[this.config.busyBlockCategory],body:{contentType:"text",content:"Auto-synchronized busy time from another calendar"}},n.n=5,fetch("https://graph.microsoft.com/v1.0/me/calendars/".concat(t.id,"/events"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify(u)});case 5:(d=n.v).ok?(r++,console.log("Created sync block in ".concat(t.name,": ").concat(s.start.toLocaleTimeString()," - ").concat(s.end.toLocaleTimeString()))):console.warn("Failed to create sync block in ".concat(t.name,": ").concat(d.status)),n.n=7;break;case 6:n.p=6,f=n.v,console.error("Error creating sync block in ".concat(t.name,":"),f);case 7:n.n=3;break;case 8:n.n=10;break;case 9:n.p=9,p=n.v,c.e(p);case 10:return n.p=10,c.f(),n.f(10);case 11:return console.log("Created ".concat(r," real sync blocks in ").concat(t.name," (").concat(t.userEmail,")")),n.a(2,r)}},n,this,[[4,6],[2,9,10,11]])})),function(n,e){return s.apply(this,arguments)})},{key:"startAutoSync",value:function(){var n=this;this.syncInterval&&clearInterval(this.syncInterval);var e=60*this.config.syncIntervalMinutes*1e3;this.syncInterval=setInterval(function(){n.performSync().catch(function(n){console.error("Auto-sync failed:",n)})},e),console.log("Auto-sync started with ".concat(this.config.syncIntervalMinutes," minute interval"))}},{key:"stopAutoSync",value:function(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null,console.log("Auto-sync stopped"))}},{key:"getSyncStatus",value:(c=f(l().m(function n(){var e;return l().w(function(n){for(;;)switch(n.n){case 0:if(!this.syncInProgress){n.n=1;break}return n.a(2,{state:"Syncing",message:"Synchronization in progress...",lastSync:this.lastSync});case 1:if(this.syncEnabled){n.n=2;break}return n.a(2,{state:"Stopped",message:"Synchronization disabled",lastSync:this.lastSync});case 2:if(!((e=Array.from(this.calendars.values()).filter(function(n){return n.syncEnabled}).length)<2)){n.n=3;break}return n.a(2,{state:"Error",message:"Need at least 2 enabled calendars",lastSync:this.lastSync});case 3:return n.a(2,{state:"Active",message:"Monitoring ".concat(e," calendars"),lastSync:this.lastSync})}},n,this)})),function(){return c.apply(this,arguments)})},{key:"setSyncInterval",value:function(n){this.config.syncIntervalMinutes=n,this.saveConfiguration(),this.syncInterval&&this.startAutoSync()}},{key:"setBusyBlockSubject",value:function(n){this.config.busyBlockSubject=n,this.saveConfiguration()}},{key:"setLookAheadDays",value:function(n){this.config.lookAheadDays=n,this.saveConfiguration()}},{key:"getConfiguration",value:function(){return i({},this.config)}}],r&&p(a.prototype,r),Object.defineProperty(a,"prototype",{writable:!1}),a;var a,r,c,s,u,d,y,m,v,h,g,b,w,k,S,x,E,O,A,C,I}();function v(n){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},v(n)}function h(){var n,e,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function r(t,o,a,r){var s=o&&o.prototype instanceof i?o:i,l=Object.create(s.prototype);return g(l,"_invoke",function(t,o,a){var r,i,s,l=0,u=a||[],d=!1,f={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(e,t){return r=e,i=0,s=n,f.n=t,c}};function p(t,o){for(i=t,s=o,e=0;!d&&l&&!a&&e<u.length;e++){var a,r=u[e],p=f.p,y=r[2];t>3?(a=y===o)&&(s=r[(i=r[4])?5:(i=3,3)],r[4]=r[5]=n):r[0]<=p&&((a=t<2&&p<r[1])?(i=0,f.v=o,f.n=r[1]):p<y&&(a=t<3||r[0]>o||o>y)&&(r[4]=t,r[5]=o,f.n=y,i=0))}if(a||t>1)return c;throw d=!0,o}return function(a,u,y){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,y),i=u,s=y;(e=i<2?n:s)||!d;){r||(i?i<3?(i>1&&(f.n=-1),p(i,s)):f.n=s:f.v=s);try{if(l=2,r){if(i||(a="next"),e=r[a]){if(!(e=e.call(r,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,i<2&&(i=0)}else 1===i&&(e=r.return)&&e.call(r),i<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),i=1);r=n}else if((e=(d=f.n<0)?s:t.call(o,f))!==c)break}catch(e){r=n,i=1,s=e}finally{l=1}}return{value:e,done:d}}}(t,a,r),!0),l}var c={};function i(){}function s(){}function l(){}e=Object.getPrototypeOf;var u=[][o]?e(e([][o]())):(g(e={},o,function(){return this}),e),d=l.prototype=i.prototype=Object.create(u);function f(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,l):(n.__proto__=l,g(n,a,"GeneratorFunction")),n.prototype=Object.create(d),n}return s.prototype=l,g(d,"constructor",l),g(l,"constructor",s),s.displayName="GeneratorFunction",g(l,a,"GeneratorFunction"),g(d),g(d,a,"Generator"),g(d,o,function(){return this}),g(d,"toString",function(){return"[object Generator]"}),(h=function(){return{w:r,m:f}})()}function g(n,e,t,o){var a=Object.defineProperty;try{a({},"",{})}catch(n){a=0}g=function(n,e,t,o){function r(e,t){g(n,e,function(n){return this._invoke(e,t,n)})}e?a?a(n,e,{value:t,enumerable:!o,configurable:!o,writable:!o}):n[e]=t:(r("next",0),r("throw",1),r("return",2))},g(n,e,t,o)}function b(n,e,t,o,a,r,c){try{var i=n[r](c),s=i.value}catch(n){return void t(n)}i.done?e(s):Promise.resolve(s).then(o,a)}function w(n){return function(){var e=this,t=arguments;return new Promise(function(o,a){var r=n.apply(e,t);function c(n){b(r,o,a,c,i,"next",n)}function i(n){b(r,o,a,c,i,"throw",n)}c(void 0)})}}function k(n,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,S(o.key),o)}}function S(n){var e=function(n){if("object"!=v(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var t=e.call(n,"string");if("object"!=v(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==v(e)?e:e+""}var x,E,O=function(){return n=function n(e){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.manager=e,this.currentView="overview"},e=[{key:"initialize",value:function(){this.createAccountManagementUI(),this.bindEvents(),this.refreshAccountsList()}},{key:"createAccountManagementUI",value:function(){var n=document.getElementById("auth-container")||document.getElementById("calendar-list")||document.createElement("div");n.innerHTML='\n      <div class="multi-account-manager">\n        \x3c!-- Header --\x3e\n        <div class="account-header">\n          <h2>📅 Multi-Tenant Calendar Sync</h2>\n          <p>Connect your calendars across different organizations and services</p>\n        </div>\n\n        \x3c!-- Navigation Tabs --\x3e\n        <div class="account-tabs">\n          <button class="tab-btn active" data-tab="overview">Overview</button>\n          <button class="tab-btn" data-tab="add-account">Add Account</button>\n          <button class="tab-btn" data-tab="sync-status">Sync Status</button>\n        </div>\n\n        \x3c!-- Overview Tab --\x3e\n        <div class="tab-content active" id="overview-tab">\n          <div class="accounts-summary">\n            <h3>Connected Accounts</h3>\n            <div id="accounts-list" class="accounts-list">\n              <div class="loading">Loading accounts...</div>\n            </div>\n            <div class="sync-actions">\n              <button id="sync-all-btn" class="btn-primary">🔄 Sync All Calendars</button>\n              <button id="test-mode-btn" class="btn-secondary">🧪 Load Test Accounts</button>\n            </div>\n          </div>\n          \n          <div class="sync-overview">\n            <h3>Sync Configuration</h3>\n            <div class="sync-settings">\n              <label>\n                <input type="checkbox" id="auto-sync" checked> \n                Enable automatic synchronization\n              </label>\n              <label>\n                Sync interval: \n                <select id="sync-interval">\n                  <option value="5">5 minutes</option>\n                  <option value="15" selected>15 minutes</option>\n                  <option value="30">30 minutes</option>\n                  <option value="60">1 hour</option>\n                </select>\n              </label>\n            </div>\n          </div>\n        </div>\n\n        \x3c!-- Add Account Tab --\x3e\n        <div class="tab-content" id="add-account-tab">\n          <div class="add-account-form">\n            <h3>Add New Calendar Account</h3>\n            \n            <div class="account-type-selection">\n              <h4>Select Account Type:</h4>\n              \n              <div class="account-type-grid">\n                <div class="account-type-card" data-type="office365">\n                  <div class="account-icon">🏢</div>\n                  <h4>Office 365</h4>\n                  <p>Business Microsoft account from another organization</p>\n                  <button class="select-type-btn">Connect</button>\n                </div>\n                \n                <div class="account-type-card" data-type="gmail">\n                  <div class="account-icon">📧</div>\n                  <h4>Gmail</h4>\n                  <p>Google Calendar from Gmail account</p>\n                  <button class="select-type-btn">Connect</button>\n                </div>\n                \n                <div class="account-type-card" data-type="outlook_com">\n                  <div class="account-icon">📨</div>\n                  <h4>Outlook.com</h4>\n                  <p>Personal Microsoft account</p>\n                  <button class="select-type-btn">Connect</button>\n                </div>\n                \n                <div class="account-type-card" data-type="exchange">\n                  <div class="account-icon">🏛️</div>\n                  <h4>Exchange Server</h4>\n                  <p>On-premises Exchange calendar</p>\n                  <button class="select-type-btn">Connect</button>\n                </div>\n              </div>\n            </div>\n\n            \x3c!-- Account Configuration Form --\x3e\n            <div class="account-config-form" id="account-config-form" style="display: none;">\n              <h4 id="config-form-title">Configure Account</h4>\n              \n              <div class="form-group">\n                <label for="account-email">Email Address:</label>\n                <input type="email" id="account-email" placeholder="your.name@company.com" required>\n              </div>\n              \n              <div class="form-group">\n                <label for="account-display-name">Display Name:</label>\n                <input type="text" id="account-display-name" placeholder="Company Name" required>\n              </div>\n              \n              <div class="form-group" id="tenant-config" style="display: none;">\n                <label for="tenant-id">Tenant ID (for Office 365):</label>\n                <input type="text" id="tenant-id" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">\n                <small>Found in Azure AD > Properties > Directory ID</small>\n              </div>\n              \n              <div class="form-group" id="client-config" style="display: none;">\n                <label for="client-id">Client ID:</label>\n                <input type="text" id="client-id" placeholder="Application ID from app registration">\n                <small>Create an app registration in Azure AD / Google Console</small>\n              </div>\n              \n              <div class="form-actions">\n                <button type="button" id="save-account-btn" class="btn-primary">Save & Connect</button>\n                <button type="button" id="cancel-config-btn" class="btn-secondary">Cancel</button>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        \x3c!-- Sync Status Tab --\x3e\n        <div class="tab-content" id="sync-status-tab">\n          <div class="sync-status-view">\n            <h3>Synchronization Status</h3>\n            \n            <div class="sync-timeline">\n              <h4>Recent Sync Activity</h4>\n              <div id="sync-timeline-list" class="timeline-list">\n                <div class="timeline-item">\n                  <div class="timeline-time">2:30 PM</div>\n                  <div class="timeline-content">\n                    <strong>✅ Sync completed</strong><br>\n                    All accounts synchronized successfully\n                  </div>\n                </div>\n                <div class="timeline-item">\n                  <div class="timeline-time">2:15 PM</div>\n                  <div class="timeline-content">\n                    <strong>🔄 Sync started</strong><br>\n                    Processing 5 connected accounts\n                  </div>\n                </div>\n              </div>\n            </div>\n            \n            <div class="sync-conflicts">\n              <h4>Conflicts & Issues</h4>\n              <div id="conflicts-list" class="conflicts-list">\n                <div class="no-conflicts">No conflicts detected</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    ',document.getElementById("auth-container")||document.body.appendChild(n)}},{key:"bindEvents",value:function(){var n,e,t,o,a=this;document.querySelectorAll(".tab-btn").forEach(function(n){n.addEventListener("click",function(n){a.switchTab(n.target.dataset.tab)})}),document.querySelectorAll(".account-type-card").forEach(function(n){n.addEventListener("click",function(n){var e=n.target.closest(".account-type-card").querySelector(".select-type-btn");e&&e.click()})}),document.querySelectorAll(".select-type-btn").forEach(function(n){n.addEventListener("click",function(n){n.stopPropagation();var e=n.target.closest(".account-type-card").dataset.type;a.showAccountConfigForm(e)})}),null===(n=document.getElementById("save-account-btn"))||void 0===n||n.addEventListener("click",function(){a.saveAccountConfiguration()}),null===(e=document.getElementById("cancel-config-btn"))||void 0===e||e.addEventListener("click",function(){a.hideAccountConfigForm()}),null===(t=document.getElementById("sync-all-btn"))||void 0===t||t.addEventListener("click",function(){a.syncAllAccounts()}),null===(o=document.getElementById("test-mode-btn"))||void 0===o||o.addEventListener("click",function(){a.loadTestAccounts()})}},{key:"switchTab",value:function(n){document.querySelectorAll(".tab-btn").forEach(function(e){e.classList.toggle("active",e.dataset.tab===n)}),document.querySelectorAll(".tab-content").forEach(function(e){e.classList.toggle("active",e.id==="".concat(n,"-tab"))}),this.currentView=n,"overview"===n?this.refreshAccountsList():"sync-status"===n&&this.refreshSyncStatus()}},{key:"showAccountConfigForm",value:function(n){var e=document.getElementById("account-config-form"),t=document.getElementById("config-form-title"),o=document.getElementById("tenant-config"),a=document.getElementById("client-config");switch(n){case"office365":t.textContent="Configure Office 365 Account",o.style.display="block",a.style.display="block";break;case"gmail":t.textContent="Configure Gmail Account",o.style.display="none",a.style.display="block";break;case"outlook_com":t.textContent="Configure Outlook.com Account",o.style.display="none",a.style.display="block";break;case"exchange":t.textContent="Configure Exchange Server",o.style.display="none",a.style.display="none"}e.style.display="block",e.dataset.accountType=n}},{key:"hideAccountConfigForm",value:function(){document.getElementById("account-config-form").style.display="none",document.getElementById("account-email").value="",document.getElementById("account-display-name").value="",document.getElementById("tenant-id").value="",document.getElementById("client-id").value=""}},{key:"saveAccountConfiguration",value:(a=w(h().m(function n(){var e,t,o,a;return h().w(function(n){for(;;)switch(n.p=n.n){case 0:if(e=document.getElementById("account-config-form"),t=e.dataset.accountType,(o={id:"account-".concat(Date.now()),type:t,email:document.getElementById("account-email").value,displayName:document.getElementById("account-display-name").value,tenantId:document.getElementById("tenant-id").value,clientId:document.getElementById("client-id").value}).email&&o.displayName){n.n=1;break}return alert("Please fill in all required fields"),n.a(2);case 1:return n.p=1,console.log("🔗 Adding new account:",o),n.n=2,this.manager.addAccount(o);case 2:this.hideAccountConfigForm(),this.switchTab("overview"),this.refreshAccountsList(),this.showMessage("Successfully connected ".concat(o.displayName,"!"),"success"),n.n=4;break;case 3:n.p=3,a=n.v,console.error("❌ Failed to add account:",a),this.showMessage("Failed to connect account: ".concat(a.message),"error");case 4:return n.a(2)}},n,this,[[1,3]])})),function(){return a.apply(this,arguments)})},{key:"loadTestAccounts",value:function(){console.log("🧪 Loading test accounts..."),this.manager.createMockAccounts(),this.refreshAccountsList(),this.showMessage("Test accounts loaded successfully!","success")}},{key:"refreshAccountsList",value:function(){var n=this,e=document.getElementById("accounts-list");if(e){var t=this.manager.getAccountsSummary();0!==t.length?e.innerHTML=t.map(function(e){return'\n      <div class="account-item '.concat(e.isAuthenticated?"authenticated":"not-authenticated",'">\n        <div class="account-info">\n          <div class="account-header">\n            <span class="account-type-icon">').concat(n.getAccountTypeIcon(e.type),'</span>\n            <div class="account-details">\n              <h4>').concat(e.displayName,"</h4>\n              <p>").concat(e.email,'</p>\n            </div>\n            <div class="account-status">\n              ').concat(e.isAuthenticated?'<span class="status-badge success">✅ Connected</span>':'<span class="status-badge error">❌ Disconnected</span>','\n            </div>\n          </div>\n          \n          <div class="account-stats">\n            <span class="stat">📅 ').concat(e.calendarCount,' calendars</span>\n            <span class="stat">🔄 ').concat(e.syncEnabled?"Sync enabled":"Sync disabled","</span>\n            ").concat(e.lastSync?'<span class="stat">⏰ Last sync: '.concat(new Date(e.lastSync).toLocaleTimeString(),"</span>"):'<span class="stat">⏰ Never synced</span>','\n          </div>\n        </div>\n        \n        <div class="account-actions">\n          <button class="btn-small" onclick="multiAccountUI.configureAccount(\'').concat(e.id,'\')">\n            ⚙️ Configure\n          </button>\n          <button class="btn-small" onclick="multiAccountUI.syncAccount(\'').concat(e.id,'\')">\n            🔄 Sync Now\n          </button>\n          <button class="btn-small danger" onclick="multiAccountUI.removeAccount(\'').concat(e.id,"')\">\n            🗑️ Remove\n          </button>\n        </div>\n      </div>\n    ")}).join(""):e.innerHTML='\n        <div class="no-accounts">\n          <div class="no-accounts-icon">📅</div>\n          <h4>No accounts connected</h4>\n          <p>Add your first calendar account to start syncing</p>\n          <button onclick="document.querySelector(\'[data-tab=add-account]\').click()" class="btn-primary">\n            Add Account\n          </button>\n        </div>\n      '}}},{key:"getAccountTypeIcon",value:function(n){var e={office365:"🏢",gmail:"📧",outlook_com:"📨",exchange:"🏛️",other:"📅"};return e[n]||e.other}},{key:"syncAllAccounts",value:(o=w(h().m(function n(){var e,t,o;return h().w(function(n){for(;;)switch(n.p=n.n){case 0:return e=document.getElementById("sync-all-btn"),t=e.textContent,e.textContent="🔄 Syncing...",e.disabled=!0,n.p=1,console.log("🔄 Starting sync for all accounts..."),n.n=2,new Promise(function(n){return setTimeout(n,2e3)});case 2:this.showMessage("All accounts synchronized successfully!","success"),this.refreshAccountsList(),n.n=4;break;case 3:n.p=3,o=n.v,console.error("❌ Sync failed:",o),this.showMessage("Sync failed: ".concat(o.message),"error");case 4:return n.p=4,e.textContent=t,e.disabled=!1,n.f(4);case 5:return n.a(2)}},n,this,[[1,3,4,5]])})),function(){return o.apply(this,arguments)})},{key:"showMessage",value:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t=document.getElementById("message-display");t||((t=document.createElement("div")).id="message-display",t.className="message-display",document.querySelector(".multi-account-manager").prepend(t)),t.className="message-display ".concat(e),t.textContent=n,t.style.display="block",setTimeout(function(){t.style.display="none"},5e3)}},{key:"configureAccount",value:function(n){console.log("⚙️ Configuring account: ".concat(n))}},{key:"syncAccount",value:(t=w(h().m(function n(e){return h().w(function(n){for(;;)switch(n.n){case 0:console.log("🔄 Syncing account: ".concat(e));case 1:return n.a(2)}},n)})),function(n){return t.apply(this,arguments)})},{key:"removeAccount",value:function(n){confirm("Are you sure you want to remove this account?")&&(console.log("🗑️ Removing account: ".concat(n)),this.refreshAccountsList())}},{key:"refreshSyncStatus",value:function(){console.log("🔄 Refreshing sync status...")}}],e&&k(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,e,t,o,a}();function A(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),t.push.apply(t,o)}return t}function C(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?A(Object(t),!0).forEach(function(e){I(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):A(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}function I(n,e,t){return(e=function(n){var e=function(n){if("object"!=F(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var t=e.call(n,"string");if("object"!=F(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==F(e)?e:e+""}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function T(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var o,a,r,c,i=[],s=!0,l=!1;try{if(r=(t=t.call(n)).next,0===e){if(Object(t)!==t)return;s=!1}else for(;!(s=(o=r.call(t)).done)&&(i.push(o.value),i.length!==e);s=!0);}catch(n){l=!0,a=n}finally{try{if(!s&&null!=t.return&&(c=t.return(),Object(c)!==c))return}finally{if(l)throw a}}return i}}(n,e)||P(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(n,e){var t="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=P(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var o=0,a=function(){};return{s:a,n:function(){return o>=n.length?{done:!0}:{done:!1,value:n[o++]}},e:function(n){throw n},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,i=!1;return{s:function(){t=t.call(n)},n:function(){var n=t.next();return c=n.done,n},e:function(n){i=!0,r=n},f:function(){try{c||null==t.return||t.return()}finally{if(i)throw r}}}}function P(n,e){if(n){if("string"==typeof n)return B(n,e);var t={}.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?B(n,e):void 0}}function B(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,o=Array(e);t<e;t++)o[t]=n[t];return o}function D(){var n,e,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function r(t,o,a,r){var s=o&&o.prototype instanceof i?o:i,l=Object.create(s.prototype);return L(l,"_invoke",function(t,o,a){var r,i,s,l=0,u=a||[],d=!1,f={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(e,t){return r=e,i=0,s=n,f.n=t,c}};function p(t,o){for(i=t,s=o,e=0;!d&&l&&!a&&e<u.length;e++){var a,r=u[e],p=f.p,y=r[2];t>3?(a=y===o)&&(s=r[(i=r[4])?5:(i=3,3)],r[4]=r[5]=n):r[0]<=p&&((a=t<2&&p<r[1])?(i=0,f.v=o,f.n=r[1]):p<y&&(a=t<3||r[0]>o||o>y)&&(r[4]=t,r[5]=o,f.n=y,i=0))}if(a||t>1)return c;throw d=!0,o}return function(a,u,y){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,y),i=u,s=y;(e=i<2?n:s)||!d;){r||(i?i<3?(i>1&&(f.n=-1),p(i,s)):f.n=s:f.v=s);try{if(l=2,r){if(i||(a="next"),e=r[a]){if(!(e=e.call(r,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,i<2&&(i=0)}else 1===i&&(e=r.return)&&e.call(r),i<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),i=1);r=n}else if((e=(d=f.n<0)?s:t.call(o,f))!==c)break}catch(e){r=n,i=1,s=e}finally{l=1}}return{value:e,done:d}}}(t,a,r),!0),l}var c={};function i(){}function s(){}function l(){}e=Object.getPrototypeOf;var u=[][o]?e(e([][o]())):(L(e={},o,function(){return this}),e),d=l.prototype=i.prototype=Object.create(u);function f(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,l):(n.__proto__=l,L(n,a,"GeneratorFunction")),n.prototype=Object.create(d),n}return s.prototype=l,L(d,"constructor",l),L(l,"constructor",s),s.displayName="GeneratorFunction",L(l,a,"GeneratorFunction"),L(d),L(d,a,"Generator"),L(d,o,function(){return this}),L(d,"toString",function(){return"[object Generator]"}),(D=function(){return{w:r,m:f}})()}function L(n,e,t,o){var a=Object.defineProperty;try{a({},"",{})}catch(n){a=0}L=function(n,e,t,o){function r(e,t){L(n,e,function(n){return this._invoke(e,t,n)})}e?a?a(n,e,{value:t,enumerable:!o,configurable:!o,writable:!o}):n[e]=t:(r("next",0),r("throw",1),r("return",2))},L(n,e,t,o)}function M(n,e,t,o,a,r,c){try{var i=n[r](c),s=i.value}catch(n){return void t(n)}i.done?e(s):Promise.resolve(s).then(o,a)}function G(n){return function(){var e=this,t=arguments;return new Promise(function(o,a){var r=n.apply(e,t);function c(n){M(r,o,a,c,i,"next",n)}function i(n){M(r,o,a,c,i,"throw",n)}c(void 0)})}}function F(n){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},F(n)}function R(){document.getElementById("sideload-msg").innerHTML='\n    <div style="color: #d63031; padding: 15px; border: 1px solid #d63031; border-radius: 8px; margin: 10px;">\n      <h3>🚨 Office.js Context Required</h3>\n      <p><strong>Issue:</strong> This add-in needs to run within Microsoft Outlook to access Office.js APIs.</p>\n      \n      <h4>📋 How to test this add-in properly:</h4>\n      <ol style="text-align: left; margin: 10px 0;">\n        <li><strong>Deploy the manifest:</strong> Upload <code>manifest.xml</code> to Microsoft 365 Admin Center</li>\n        <li><strong>Open Outlook:</strong> Use Outlook desktop app or Outlook on the web</li>\n        <li><strong>Find the add-in:</strong> Look for "Sync Calendars" button in the ribbon</li>\n        <li><strong>Click to open:</strong> The add-in will load in a proper Office.js context</li>\n      </ol>\n      \n      <h4>🔧 For development testing:</h4>\n      <ul style="text-align: left; margin: 10px 0;">\n        <li>Use <code>npm run dev-server</code> and sideload in Outlook</li>\n        <li>Or use Office Add-in Development Tools</li>\n        <li>Direct browser testing won\'t have full Office.js capabilities</li>\n      </ul>\n      \n      <p><strong>Current context:</strong> '.concat(window.location.href,'</p>\n      <button onclick="testMockMode();" style="background: #0984e3; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin: 5px;">\n        Test with Mock Data\n      </button>\n      <button onclick="location.reload();" style="background: #636e72; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin: 5px;">\n        Refresh\n      </button>\n    </div>\n  ')}function U(){return z.apply(this,arguments)}function z(){return(z=G(D().m(function n(){var e,t,o;return D().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,console.log("� Starting Multi-Tenant Calendar Sync initialization..."),window.multiTenantManager?(E=new O(window.multiTenantManager),window.multiAccountUI=E,E.initialize(),e=document.getElementById("status-section"),t=document.getElementById("calendar-section"),e&&(e.style.display="none"),t&&(t.style.display="none"),console.log("✅ Multi-account interface initialized")):(console.warn("⚠️ Multi-tenant manager not available, falling back to simple mode"),window.calendarAuth&&window.calendarAuth.renderAuthenticationOptions()),q(),n.n=1,x.initialize();case 1:$("ready","Ready to sync"),console.log("✅ Multi-tenant calendar sync initialized successfully"),n.n=3;break;case 2:n.p=2,o=n.v,console.error("❌ App initialization failed:",o),$("error","Initialization failed: ".concat(o.message)),R();case 3:return n.a(2)}},n,null,[[0,2]])}))).apply(this,arguments)}function q(){console.log("⚙️ Setting up event listeners...");var n=document.getElementById("run-diagnostic");n&&n.addEventListener("click",N);var e=document.getElementById("run-sync");e&&e.addEventListener("click",runSync);var t=document.getElementById("configure");t&&t.addEventListener("click",showSettings),console.log("✅ Event listeners set up")}function N(){return H.apply(this,arguments)}function H(){return(H=G(D().m(function n(){var e,t,o,a,r,c,i,s;return D().w(function(n){for(;;)switch(n.p=n.n){case 0:return console.log("🔍 Running calendar discovery diagnostic..."),e=document.getElementById("run-diagnostic"),t=document.getElementById("diagnostic-results"),e&&(e.disabled=!0,e.innerHTML='<span class="ms-Button-label">🔄 Checking...</span>'),n.p=1,o=new CalendarDiscoveryDiagnostic,n.n=2,o.runFullDiagnostic();case 2:a=n.v,t&&(r=a.graphApiResults.calendarsFound.length,c=a.graphApiResults.accessTokenObtained,t.innerHTML='\n        <div class="diagnostic-summary">\n          <h4>📊 Discovery Results:</h4>\n          <p><strong>Graph API Auth:</strong> '.concat(c?"✅ Working":"❌ Failed","</p>\n          <p><strong>Calendars Found:</strong> ").concat(r," calendar(s)</p>\n          ").concat(r>0?'\n            <div class="calendar-list">\n              <strong>Found calendars:</strong>\n              <ul>\n                '.concat(a.graphApiResults.calendarsFound.map(function(n){return"<li>📅 ".concat(n.name," ").concat(n.isDefaultCalendar?"(Default)":"","</li>")}).join(""),"\n              </ul>\n            </div>\n          "):"\n            <p><em>This means Graph API can only see calendars from your current Office 365/Exchange account.</em></p>\n            <p><em>Connected accounts (Gmail, other Exchange) won't appear here.</em></p>\n          ",'\n          <button id="add-external-calendar" class="ms-Button" style="margin-top: 10px;">\n            <span class="ms-Button-label">➕ Add External Calendar</span>\n          </button>\n        </div>\n      '),(i=document.getElementById("add-external-calendar"))&&i.addEventListener("click",_)),n.n=4;break;case 3:n.p=3,s=n.v,console.error("❌ Diagnostic failed:",s),t&&(t.innerHTML='\n        <div class="error-message">\n          <p><strong>❌ Diagnostic Failed:</strong> '.concat(s.message,"</p>\n          <p><em>This likely means you're not in a proper Office.js context or don't have the necessary permissions.</em></p>\n        </div>\n      "));case 4:return n.p=4,e&&(e.disabled=!1,e.innerHTML='<span class="ms-Button-label">🔍 Check My Calendars</span>'),n.f(4);case 5:return n.a(2)}},n,null,[[1,3,4,5]])}))).apply(this,arguments)}function _(){var n=document.getElementById("diagnostic-results");n&&(n.innerHTML+='\n    <div class="add-calendar-section" style="margin-top: 15px; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">\n      <h4>➕ Add External Calendar</h4>\n      <p>To sync calendars from other accounts, choose an option:</p>\n      \n      <div class="calendar-options">\n        <button class="calendar-type-btn" onclick="addGoogleCalendar()">\n          📧 Google Calendar\n        </button>\n        <button class="calendar-type-btn" onclick="addOutlookCalendar()">\n          📮 Outlook.com/Hotmail\n        </button>\n        <button class="calendar-type-btn" onclick="addExchangeCalendar()">\n          🏢 Exchange Server\n        </button>\n        <button class="calendar-type-btn" onclick="addICSCalendar()">\n          🔗 ICS/WebCal URL\n        </button>\n      </div>\n      \n      <div id="calendar-form-container" style="margin-top: 10px;">\n        \x3c!-- Calendar form will be inserted here --\x3e\n      </div>\n    </div>\n  ')}function W(){return(W=G(D().m(function n(e){var t,o,a;return D().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,x.toggleCalendarSync(e);case 1:t=n.v,(o=document.querySelector('[data-calendar-id="'.concat(e,'"]')))&&o.classList.toggle("active",t),Z("Calendar sync ".concat(t?"enabled":"disabled"," for calendar")),n.n=3;break;case 2:n.p=2,a=n.v,console.error("Failed to toggle calendar sync:",a),Z("Failed to toggle calendar sync: ".concat(a.message));case 3:return n.a(2)}},n,null,[[0,2]])}))).apply(this,arguments)}function $(){return J.apply(this,arguments)}function J(){return(J=G(D().m(function n(){var e,t;return D().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,x.getSyncStatus();case 1:V((e=n.v).state,e.message),e.lastSync&&(document.getElementById("last-sync").textContent="Last sync: ".concat(new Date(e.lastSync).toLocaleString())),n.n=3;break;case 2:n.p=2,t=n.v,console.error("Failed to get sync status:",t),V("Error","Unable to check sync status");case 3:return n.a(2)}},n,null,[[0,2]])}))).apply(this,arguments)}function V(n,e){var t=document.getElementById("status-dot"),o=document.getElementById("status-text");switch(t.classList.remove("active","syncing"),n.toLowerCase()){case"active":t.classList.add("active");break;case"syncing":t.classList.add("syncing")}o.textContent=e}function Z(n){var e=document.getElementById("activity-log"),t=e.querySelector(".no-activity");t&&t.remove();var o=document.createElement("div");o.className="activity-item",o.innerHTML='\n    <div class="activity-time">'.concat((new Date).toLocaleTimeString(),"</div>\n    <div>").concat(n,"</div>\n  "),e.insertBefore(o,e.firstChild);var a=e.querySelectorAll(".activity-item");a.length>10&&a[a.length-1].remove()}function Y(n,e,t){var o=document.getElementById("calendar-form-container");if(o){var a=t.fields.map(function(n){return'\n    <div class="form-field" style="margin: 10px 0;">\n      <label for="'.concat(n.name,'" style="display: block; font-weight: bold; margin-bottom: 5px;">\n        ').concat(n.label," ").concat(n.required?"*":"",'\n      </label>\n      <input \n        type="').concat(n.type,'" \n        id="').concat(n.name,'" \n        name="').concat(n.name,'"\n        placeholder="').concat(n.placeholder||"",'"\n        value="').concat(n.value||"",'"\n        ').concat(n.required?"required":"",'\n        style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;"\n      />\n    </div>\n  ')}).join("");o.innerHTML='\n    <div class="calendar-form">\n      <h5>📝 Add '.concat(e,'</h5>\n      <p style="font-size: 0.9em; color: #666;">').concat(t.instructions,'</p>\n      \n      <form id="add-calendar-form">\n        <input type="hidden" name="type" value="').concat(n,'" />\n        ').concat(a,'\n        \n        <div class="form-actions" style="margin-top: 15px;">\n          <button type="submit" class="ms-Button ms-Button--primary">\n            <span class="ms-Button-label">🔗 Connect Calendar</span>\n          </button>\n          <button type="button" onclick="cancelCalendarForm()" class="ms-Button" style="margin-left: 10px;">\n            <span class="ms-Button-label">Cancel</span>\n          </button>\n        </div>\n      </form>\n    </div>\n  ');var r=document.getElementById("add-calendar-form");r&&r.addEventListener("submit",K)}}function K(n){return Q.apply(this,arguments)}function Q(){return(Q=G(D().m(function n(e){var t,o,a,r,c,i,s,l,u,d,f;return D().w(function(n){for(;;)switch(n.p=n.n){case 0:e.preventDefault(),t=new FormData(e.target),o={},a=j(t.entries());try{for(a.s();!(r=a.n()).done;)c=T(r.value,2),i=c[0],s=c[1],o[i]=s}catch(n){a.e(n)}finally{a.f()}return console.log("📝 Calendar form submitted:",o),n.p=1,(l=e.target.querySelector('button[type="submit"]'))&&(l.disabled=!0,l.innerHTML='<span class="ms-Button-label">🔄 Connecting...</span>'),n.n=2,X(o);case 2:(u=document.getElementById("calendar-form-container"))&&(u.innerHTML='\n        <div class="success-message" style="color: green; padding: 10px; border: 1px solid green; border-radius: 4px;">\n          ✅ Calendar "'.concat(o.name||o.email,'" has been added successfully!\n          <button onclick="runCalendarDiagnostic()" style="margin-left: 10px;">Refresh List</button>\n        </div>\n      ')),n.n=4;break;case 3:n.p=3,f=n.v,console.error("❌ Failed to add calendar:",f),(d=document.getElementById("calendar-form-container"))&&(d.innerHTML='\n        <div class="error-message" style="color: red; padding: 10px; border: 1px solid red; border-radius: 4px;">\n          ❌ Failed to add calendar: '.concat(f.message,'\n          <button onclick="showAddExternalCalendar()" style="margin-left: 10px;">Try Again</button>\n        </div>\n      '));case 4:return n.a(2)}},n,null,[[1,3]])}))).apply(this,arguments)}function X(n){return nn.apply(this,arguments)}function nn(){return(nn=G(D().m(function n(e){var t,o;return D().w(function(n){for(;;)if(0===n.n)return console.log("🔗 Adding ".concat(e.type," calendar:"),e),t=C(C({id:"".concat(e.type,"-").concat(Date.now()),type:e.type,name:e.name||"".concat(e.type," (").concat(e.email,")"),email:e.email},e),{},{status:"pending_implementation",added:(new Date).toISOString()}),(o=JSON.parse(localStorage.getItem("externalCalendars")||"[]")).push(t),localStorage.setItem("externalCalendars",JSON.stringify(o)),console.log("📅 ".concat(e.type," Calendar connection prepared:"),t),n.a(2,t)},n)}))).apply(this,arguments)}window.MultiAccountUI=O,Office.onReady(function(n){try{var e,t;if(console.log("🚀 Office.onReady called with info:",n),console.log("📊 Office.js diagnostics:"),console.log("  - Office object type:","undefined"==typeof Office?"undefined":F(Office)),console.log("  - Office.context type:",F(null===(e=Office)||void 0===e?void 0:e.context)),console.log("  - Office.context.auth type:",F(null===(t=Office)||void 0===t||null===(t=t.context)||void 0===t?void 0:t.auth)),console.log("  - Host detected:",null==n?void 0:n.host),console.log("  - Host type comparison:",(null==n?void 0:n.host)===Office.HostType.Outlook),console.log("  - Platform:",null==n?void 0:n.platform),n.host===Office.HostType.Outlook||"Outlook"===n.host||window.Office){console.log("✅ Host validated as Outlook-compatible"),document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var o=new Date("2025-08-12");document.getElementById("sync-date").value=o.toISOString().split("T")[0],x=new m,U()}else console.warn("⚠️ Unsupported or unrecognized host application. Host info:",n),document.getElementById("sideload-msg").innerHTML='\n        <div style="color: orange; padding: 10px; border: 1px solid orange; border-radius: 5px;">\n          <h3>🔍 Host Detection Diagnostic</h3>\n          <p><strong>Detected host:</strong> '.concat((null==n?void 0:n.host)||"Unknown","</p>\n          <p><strong>Expected:</strong> Outlook</p>\n          <p><strong>Platform:</strong> ").concat((null==n?void 0:n.platform)||"Unknown","</p>\n          <p><strong>Office.js available:</strong> ").concat(window.Office?"Yes":"No","</p>\n          <p><strong>Status:</strong> Attempting to continue with limited functionality...</p>\n          <button onclick=\"this.parentElement.style.display='none'; document.getElementById('app-body').style.display='flex';\">Continue Anyway</button>\n        </div>\n      "),setTimeout(function(){try{x=new m,U()}catch(n){console.error("❌ Delayed initialization failed:",n)}},1e3)}catch(n){console.error("❌ Office.onReady error:",n),document.getElementById("sideload-msg").innerHTML='\n      <div style="color: red; padding: 10px; border: 1px solid red; border-radius: 5px;">\n        <h3>🚨 Initialization Error</h3>\n        <p><strong>Error:</strong> '.concat(n.message,"</p>\n        <p><strong>Suggestion:</strong> Please ensure this add-in is loaded within Outlook</p>\n        <p><strong>Current URL:</strong> ").concat(window.location.href,"</p>\n        <button onclick=\"location.reload();\">Refresh Page</button>\n        <button onclick=\"this.parentElement.style.display='none'; document.getElementById('app-body').style.display='flex';\">Try Anyway</button>\n      </div>\n    ")}}),window.addEventListener("DOMContentLoaded",function(){setTimeout(function(){if(!x)if(console.log("🔄 Fallback initialization triggered - Office.onReady may not have fired"),console.log("🔍 Office.js status check:"),console.log("  - window.Office available:",!!window.Office),console.log("  - Current URL:",window.location.href),console.log("  - User Agent:",navigator.userAgent),window.Office){console.log("✅ Office.js detected, attempting manual initialization");try{document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var n=new Date("2025-08-12");document.getElementById("sync-date").value=n.toISOString().split("T")[0],x=new m,U()}catch(n){console.error("❌ Fallback initialization failed:",n),R()}}else console.warn("⚠️ Office.js not available - showing context guidance"),R()},2e3)}),window.toggleCalendarSync=function(n){return W.apply(this,arguments)},window.addGoogleCalendar=function(){Y("google","Google Calendar",{fields:[{name:"email",label:"Google Account Email",type:"email",required:!0},{name:"calendarId",label:"Calendar ID (optional - leave blank for primary)",type:"text",required:!1}],instructions:"You'll need to authenticate with Google Calendar API. We'll redirect you to Google for permission."})},window.addOutlookCalendar=function(){Y("outlook","Outlook.com/Hotmail",{fields:[{name:"email",label:"Outlook.com Email",type:"email",required:!0},{name:"calendarName",label:"Calendar Name (optional)",type:"text",required:!1}],instructions:"We'll authenticate with Microsoft Graph API for your personal Outlook.com account."})},window.addExchangeCalendar=function(){Y("exchange","Exchange Server",{fields:[{name:"email",label:"Exchange Email",type:"email",required:!0},{name:"serverUrl",label:"Exchange Server URL",type:"url",required:!0,placeholder:"https://mail.company.com/ews/exchange.asmx"},{name:"domain",label:"Domain (optional)",type:"text",required:!1}],instructions:"We'll connect to your Exchange server using EWS (Exchange Web Services)."})},window.addICSCalendar=function(){Y("ics","ICS/WebCal Calendar",{fields:[{name:"name",label:"Calendar Name",type:"text",required:!0},{name:"url",label:"Calendar URL",type:"url",required:!0,placeholder:"https://calendar.google.com/calendar/ical/...ics"},{name:"refreshInterval",label:"Refresh Interval (minutes)",type:"number",required:!1,value:"60"}],instructions:"Enter the ICS or WebCal URL. This is read-only and will be refreshed periodically."})},window.cancelCalendarForm=function(){var n=document.getElementById("calendar-form-container");n&&(n.innerHTML="")}}(),new URL(t(58394),t.b),new URL(t(62587),t.b),new URL(t(98362),t.b),new URL(t(14037),t.b),new URL(t(61712),t.b),new URL(t(53394),t.b),new URL(t(7312),t.b),new URL(t(44809),t.b),new URL(t(60947),t.b)}();
//# sourceMappingURL=taskpane.js.map