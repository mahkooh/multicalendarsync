/*! For license information please see ac1324ae48c8c3a39716.js.LICENSE.txt */
function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _regenerator(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function a(n,o,r,a){var u=o&&o.prototype instanceof i?o:i,s=Object.create(u.prototype);return _regeneratorDefine2(s,"_invoke",function(n,o,r){var a,i,u,s=0,l=r||[],p=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,i=0,u=e,f.n=n,c}};function d(n,o){for(i=n,u=o,t=0;!p&&s&&!r&&t<l.length;t++){var r,a=l[t],d=f.p,m=a[2];n>3?(r=m===o)&&(u=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=d&&((r=n<2&&d<a[1])?(i=0,f.v=o,f.n=a[1]):d<m&&(r=n<3||a[0]>o||o>m)&&(a[4]=n,a[5]=o,f.n=m,i=0))}if(r||n>1)return c;throw p=!0,o}return function(r,l,m){if(s>1)throw TypeError("Generator is already running");for(p&&1===l&&d(l,m),i=l,u=m;(t=i<2?e:u)||!p;){a||(i?i<3?(i>1&&(f.n=-1),d(i,u)):f.n=u:f.v=u);try{if(s=2,a){if(i||(r="next"),t=a[r]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(u=TypeError("The iterator does not provide a '"+r+"' method"),i=1);a=e}else if((t=(p=f.n<0)?u:n.call(o,f))!==c)break}catch(t){a=e,i=1,u=t}finally{s=1}}return{value:t,done:p}}}(n,r,a),!0),s}var c={};function i(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][o]?t(t([][o]())):(_regeneratorDefine2(t={},o,function(){return this}),t),p=s.prototype=i.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,_regeneratorDefine2(e,r,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=s,_regeneratorDefine2(p,"constructor",s),_regeneratorDefine2(s,"constructor",u),u.displayName="GeneratorFunction",_regeneratorDefine2(s,r,"GeneratorFunction"),_regeneratorDefine2(p),_regeneratorDefine2(p,r,"Generator"),_regeneratorDefine2(p,o,function(){return this}),_regeneratorDefine2(p,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:a,m:f}})()}function _regeneratorDefine2(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}_regeneratorDefine2=function(e,t,n,o){function a(t,n){_regeneratorDefine2(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},_regeneratorDefine2(e,t,n,o)}function asyncGeneratorStep(e,t,n,o,r,a,c){try{var i=e[a](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(o,r)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var a=e.apply(t,n);function c(e){asyncGeneratorStep(a,o,r,c,i,"next",e)}function i(e){asyncGeneratorStep(a,o,r,c,i,"throw",e)}c(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var SimpleCalendarAuth=function(){return _createClass(function e(){_classCallCheck(this,e),this.accounts=[],this.currentAccountIndex=0},[{key:"generateAccountLoginUrls",value:function(){var e="https://login.microsoftonline.com/common/oauth2/v2.0/authorize",t="your-app-id",n=encodeURIComponent("https://mahkooh.github.io/multicalendarsync/auth-callback.html"),o=encodeURIComponent("https://graph.microsoft.com/Calendars.ReadWrite https://graph.microsoft.com/User.Read");return[{name:"Account 1 (Tenant 1)",loginUrl:"".concat(e,"?client_id=").concat(t,"&response_type=code&redirect_uri=").concat(n,"&scope=").concat(o,"&prompt=login"),description:"Click to authenticate with your first Microsoft account"},{name:"Account 2 (Tenant 2)",loginUrl:"".concat(e,"?client_id=").concat(t,"&response_type=code&redirect_uri=").concat(n,"&scope=").concat(o,"&prompt=login"),description:"Click to authenticate with your second Microsoft account"},{name:"Account 3 (Tenant 3)",loginUrl:"".concat(e,"?client_id=").concat(t,"&response_type=code&redirect_uri=").concat(n,"&scope=").concat(o,"&prompt=login"),description:"Click to authenticate with your third Microsoft account"},{name:"Account 4 (Tenant 4)",loginUrl:"".concat(e,"?client_id=").concat(t,"&response_type=code&redirect_uri=").concat(n,"&scope=").concat(o,"&prompt=login"),description:"Click to authenticate with your fourth Microsoft account"},{name:"Account 5 (Tenant 5)",loginUrl:"".concat(e,"?client_id=").concat(t,"&response_type=code&redirect_uri=").concat(n,"&scope=").concat(o,"&prompt=login"),description:"Click to authenticate with your fifth Microsoft account"}]}},{key:"initiateDeviceCodeFlow",value:(t=_asyncToGenerator(_regenerator().m(function e(t){var n,o,r;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=1,e.n=2,fetch("https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"client_id=".concat("your-app-id","&scope=").concat(encodeURIComponent("https://graph.microsoft.com/Calendars.ReadWrite https://graph.microsoft.com/User.Read"))});case 2:return n=e.v,e.n=3,n.json();case 3:return o=e.v,e.a(2,{accountName:t,deviceCode:o.device_code,userCode:o.user_code,verificationUri:o.verification_uri,verificationUriComplete:o.verification_uri_complete,expiresIn:o.expires_in,interval:o.interval,message:o.message});case 4:throw e.p=4,r=e.v,console.error("Failed to initiate device code flow for ".concat(t,":"),r),r;case 5:return e.a(2)}},e,null,[[1,4]])})),function(e){return t.apply(this,arguments)})},{key:"authenticateAccountWithIframe",value:(e=_asyncToGenerator(_regenerator().m(function e(t){var n=this;return _regenerator().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,o){var r=n.generateAccountLoginUrls()[t].loginUrl,a=window.open(r,"auth_".concat(t),"width=500,height=600,scrollbars=yes,resizable=yes"),c=setInterval(function(){if(a.closed){clearInterval(c);var n=localStorage.getItem("auth_result_".concat(t));if(n){var r=JSON.parse(n);localStorage.removeItem("auth_result_".concat(t)),e(r)}else o(new Error("Authentication was cancelled or failed"))}},1e3);setTimeout(function(){a.closed||(a.close(),clearInterval(c),o(new Error("Authentication timeout")))},3e5)}))},e)})),function(t){return e.apply(this,arguments)})},{key:"getMockAccounts",value:function(){return[{id:"mock-account-1",email:"user1@tenant1.com",displayName:"User One",tenant:"tenant1.onmicrosoft.com",calendars:[{id:"calendar1",name:"Work Calendar",isDefault:!0},{id:"calendar2",name:"Personal Calendar",isDefault:!1}]},{id:"mock-account-2",email:"user2@tenant2.com",displayName:"User Two",tenant:"tenant2.onmicrosoft.com",calendars:[{id:"calendar3",name:"Corporate Calendar",isDefault:!0}]},{id:"mock-account-3",email:"user3@tenant3.com",displayName:"User Three",tenant:"tenant3.onmicrosoft.com",calendars:[{id:"calendar4",name:"Project Calendar",isDefault:!0},{id:"calendar5",name:"Team Calendar",isDefault:!1}]},{id:"mock-account-4",email:"user4@tenant4.com",displayName:"User Four",tenant:"tenant4.onmicrosoft.com",calendars:[{id:"calendar6",name:"Executive Calendar",isDefault:!0}]},{id:"mock-account-5",email:"user5@tenant5.com",displayName:"User Five",tenant:"tenant5.onmicrosoft.com",calendars:[{id:"calendar7",name:"Consulting Calendar",isDefault:!0},{id:"calendar8",name:"Client Calendar",isDefault:!1}]}]}},{key:"renderAuthenticationOptions",value:function(){var e=document.getElementById("auth-container");if(e){var t=this.generateAccountLoginUrls();e.innerHTML='\n      <div class="auth-section">\n        <h3>üìÖ Multi-Calendar Authentication</h3>\n        <p>Since you have calendars across multiple tenants, you have two options:</p>\n        \n        <div class="auth-option">\n          <h4>Option 1: Manual Login (Recommended)</h4>\n          <p>Click each link below to authenticate with each of your Microsoft accounts:</p>\n          <div class="account-list">\n            '.concat(t.map(function(e,t){return'\n              <div class="account-item">\n                <button class="auth-btn" onclick="window.open(\''.concat(e.loginUrl,"', '_blank')\">\n                  üîê ").concat(e.name,"\n                </button>\n                <small>").concat(e.description,"</small>\n              </div>\n            ")}).join(""),'\n          </div>\n        </div>\n        \n        <div class="auth-option">\n          <h4>Option 2: Mock Mode (Testing)</h4>\n          <p>Use mock data to test the synchronization functionality:</p>\n          <button class="mock-btn" onclick="calendarAuth.useMockMode()">\n            üß™ Use Mock Data\n          </button>\n        </div>\n        \n        <div class="auth-help">\n          <h4>‚ÑπÔ∏è Why Multiple Logins?</h4>\n          <p>Each Microsoft tenant requires separate authentication. This approach avoids the complexity of setting up Azure App Registrations in every tenant.</p>\n        </div>\n      </div>\n    ')}}},{key:"useMockMode",value:function(){this.accounts=this.getMockAccounts(),console.log("üìä Using mock accounts:",this.accounts),window.calendarSync&&window.calendarSync.displayAccounts(this.accounts)}}]);var e,t}();window.calendarAuth=new SimpleCalendarAuth;