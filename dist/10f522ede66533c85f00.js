/*! For license information please see 10f522ede66533c85f00.js.LICENSE.txt */
function _regenerator(){var e,n,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function r(t,o,a,r){var l=o&&o.prototype instanceof c?o:c,s=Object.create(l.prototype);return _regeneratorDefine2(s,"_invoke",function(t,o,a){var r,c,l,s=0,d=a||[],u=!1,y={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return r=n,c=0,l=e,y.n=t,i}};function p(t,o){for(c=t,l=o,n=0;!u&&s&&!a&&n<d.length;n++){var a,r=d[n],p=y.p,f=r[2];t>3?(a=f===o)&&(l=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=e):r[0]<=p&&((a=t<2&&p<r[1])?(c=0,y.v=o,y.n=r[1]):p<f&&(a=t<3||r[0]>o||o>f)&&(r[4]=t,r[5]=o,y.n=f,c=0))}if(a||t>1)return i;throw u=!0,o}return function(a,d,f){if(s>1)throw TypeError("Generator is already running");for(u&&1===d&&p(d,f),c=d,l=f;(n=c<2?e:l)||!u;){r||(c?c<3?(c>1&&(y.n=-1),p(c,l)):y.n=l:y.v=l);try{if(s=2,r){if(c||(a="next"),n=r[a]){if(!(n=n.call(r,l)))throw TypeError("iterator result is not an object");if(!n.done)return n;l=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),c=1);r=e}else if((n=(u=y.n<0)?l:t.call(o,y))!==i)break}catch(n){r=e,c=1,l=n}finally{s=1}}return{value:n,done:u}}}(t,a,r),!0),s}var i={};function c(){}function l(){}function s(){}n=Object.getPrototypeOf;var d=[][o]?n(n([][o]())):(_regeneratorDefine2(n={},o,function(){return this}),n),u=s.prototype=c.prototype=Object.create(d);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,_regeneratorDefine2(e,a,"GeneratorFunction")),e.prototype=Object.create(u),e}return l.prototype=s,_regeneratorDefine2(u,"constructor",s),_regeneratorDefine2(s,"constructor",l),l.displayName="GeneratorFunction",_regeneratorDefine2(s,a,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,a,"Generator"),_regeneratorDefine2(u,o,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:r,m:y}})()}function _regeneratorDefine2(e,n,t,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}_regeneratorDefine2=function(e,n,t,o){function r(n,t){_regeneratorDefine2(e,n,function(e){return this._invoke(n,t,e)})}n?a?a(e,n,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[n]=t:(r("next",0),r("throw",1),r("return",2))},_regeneratorDefine2(e,n,t,o)}function asyncGeneratorStep(e,n,t,o,a,r,i){try{var c=e[r](i),l=c.value}catch(e){return void t(e)}c.done?n(l):Promise.resolve(l).then(o,a)}function _asyncToGenerator(e){return function(){var n=this,t=arguments;return new Promise(function(o,a){var r=e.apply(n,t);function i(e){asyncGeneratorStep(r,o,a,i,c,"next",e)}function c(e){asyncGeneratorStep(r,o,a,i,c,"throw",e)}i(void 0)})}}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}import{CalendarSyncManager}from"./calendarSync.js";var syncManager;function showContextGuidance(){document.getElementById("sideload-msg").innerHTML='\n    <div style="color: #d63031; padding: 15px; border: 1px solid #d63031; border-radius: 8px; margin: 10px;">\n      <h3>🚨 Office.js Context Required</h3>\n      <p><strong>Issue:</strong> This add-in needs to run within Microsoft Outlook to access Office.js APIs.</p>\n      \n      <h4>📋 How to test this add-in properly:</h4>\n      <ol style="text-align: left; margin: 10px 0;">\n        <li><strong>Deploy the manifest:</strong> Upload <code>manifest.xml</code> to Microsoft 365 Admin Center</li>\n        <li><strong>Open Outlook:</strong> Use Outlook desktop app or Outlook on the web</li>\n        <li><strong>Find the add-in:</strong> Look for "Sync Calendars" button in the ribbon</li>\n        <li><strong>Click to open:</strong> The add-in will load in a proper Office.js context</li>\n      </ol>\n      \n      <h4>🔧 For development testing:</h4>\n      <ul style="text-align: left; margin: 10px 0;">\n        <li>Use <code>npm run dev-server</code> and sideload in Outlook</li>\n        <li>Or use Office Add-in Development Tools</li>\n        <li>Direct browser testing won\'t have full Office.js capabilities</li>\n      </ul>\n      \n      <p><strong>Current context:</strong> '.concat(window.location.href,'</p>\n      <button onclick="testMockMode();" style="background: #0984e3; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin: 5px;">\n        Test with Mock Data\n      </button>\n      <button onclick="location.reload();" style="background: #636e72; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin: 5px;">\n        Refresh\n      </button>\n    </div>\n  ')}function testMockMode(){console.log("🧪 Enabling mock mode for testing without Office.js"),document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var e=new Date("2025-08-12");document.getElementById("sync-date").value=e.toISOString().split("T")[0],syncManager=new CalendarSyncManager,initializeApp()}function initializeApp(){return _initializeApp.apply(this,arguments)}function _initializeApp(){return(_initializeApp=_asyncToGenerator(_regenerator().m(function e(){var n;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,document.getElementById("sync-now").onclick=handleSyncNow,document.getElementById("configure").onclick=handleConfigure,e.n=1,syncManager.initialize();case 1:return e.n=2,loadCalendars();case 2:return e.n=3,updateSyncStatus();case 3:setInterval(updateSyncStatus,3e4),e.n=5;break;case 4:e.p=4,n=e.v,console.error("Failed to initialize app:",n),updateStatus("Error","Initialization failed: ".concat(n.message));case 5:return e.a(2)}},e,null,[[0,4]])}))).apply(this,arguments)}function loadCalendars(){return _loadCalendars.apply(this,arguments)}function _loadCalendars(){return(_loadCalendars=_asyncToGenerator(_regenerator().m(function e(){var n;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,syncManager.getAvailableCalendars();case 1:displayCalendars(e.v),e.n=3;break;case 2:e.p=2,n=e.v,console.error("Failed to load calendars:",n),document.getElementById("calendar-list").innerHTML='<div class="error">Failed to load calendars. Please check permissions.</div>';case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function displayCalendars(e){var n=document.getElementById("calendar-list");0!==e.length?n.innerHTML=e.map(function(e){return'\n    <div class="calendar-item">\n      <div>\n        <div class="calendar-name">'.concat(e.name,'</div>\n        <div class="calendar-status">').concat(e.type," • ").concat(e.itemCount,' items</div>\n      </div>\n      <div class="calendar-toggle">\n        <div class="toggle-switch ').concat(e.syncEnabled?"active":"",'" \n             data-calendar-id="').concat(e.id,'"\n             onclick="toggleCalendarSync(\'').concat(e.id,"')\">\n        </div>\n      </div>\n    </div>\n  ")}).join(""):n.innerHTML='<div class="no-activity">No calendars found</div>'}function handleSyncNow(){return _handleSyncNow.apply(this,arguments)}function _handleSyncNow(){return(_handleSyncNow=_asyncToGenerator(_regenerator().m(function e(){var n,t,o,a;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=document.getElementById("sync-date").value){e.n=1;break}return updateStatus("Error","Please select a date to sync"),e.a(2);case 1:return t=new Date(n),updateStatus("Syncing","Syncing ".concat(t.toLocaleDateString(),"...")),updateSyncButton(!0),e.n=2,syncManager.performSync(t);case 2:o=e.v,updateStatus("Active","Sync completed for ".concat(t.toLocaleDateString(),". ").concat(o.blocksCreated," blocks created, ").concat(o.blocksRemoved," removed.")),addActivityLog("Sync completed for ".concat(t.toLocaleDateString(),": ").concat(o.blocksCreated," created, ").concat(o.blocksRemoved," removed")),e.n=4;break;case 3:e.p=3,a=e.v,console.error("Sync failed:",a),updateStatus("Error","Sync failed: ".concat(a.message)),addActivityLog("Sync failed: ".concat(a.message));case 4:return e.p=4,updateSyncButton(!1),e.f(4);case 5:return e.a(2)}},e,null,[[0,3,4,5]])}))).apply(this,arguments)}function handleConfigure(){return _handleConfigure.apply(this,arguments)}function _handleConfigure(){return(_handleConfigure=_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:console.log("Configure clicked");case 1:return e.a(2)}},e)}))).apply(this,arguments)}function toggleCalendarSync(e){return _toggleCalendarSync.apply(this,arguments)}function _toggleCalendarSync(){return(_toggleCalendarSync=_asyncToGenerator(_regenerator().m(function e(n){var t,o,a;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,syncManager.toggleCalendarSync(n);case 1:t=e.v,(o=document.querySelector('[data-calendar-id="'.concat(n,'"]')))&&o.classList.toggle("active",t),addActivityLog("Calendar sync ".concat(t?"enabled":"disabled"," for calendar")),e.n=3;break;case 2:e.p=2,a=e.v,console.error("Failed to toggle calendar sync:",a),addActivityLog("Failed to toggle calendar sync: ".concat(a.message));case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function updateSyncStatus(){return _updateSyncStatus.apply(this,arguments)}function _updateSyncStatus(){return(_updateSyncStatus=_asyncToGenerator(_regenerator().m(function e(){var n,t;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,syncManager.getSyncStatus();case 1:updateStatus((n=e.v).state,n.message),n.lastSync&&(document.getElementById("last-sync").textContent="Last sync: ".concat(new Date(n.lastSync).toLocaleString())),e.n=3;break;case 2:e.p=2,t=e.v,console.error("Failed to get sync status:",t),updateStatus("Error","Unable to check sync status");case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function updateStatus(e,n){var t=document.getElementById("status-dot"),o=document.getElementById("status-text");switch(t.classList.remove("active","syncing"),e.toLowerCase()){case"active":t.classList.add("active");break;case"syncing":t.classList.add("syncing")}o.textContent=n}function updateSyncButton(e){var n=document.getElementById("sync-now"),t=n.querySelector(".ms-Button-label");n.style.opacity=e?"0.6":"1",n.style.pointerEvents=e?"none":"auto",t.textContent=e?"Syncing...":"Sync Now"}function addActivityLog(e){var n=document.getElementById("activity-log"),t=n.querySelector(".no-activity");t&&t.remove();var o=document.createElement("div");o.className="activity-item",o.innerHTML='\n    <div class="activity-time">'.concat((new Date).toLocaleTimeString(),"</div>\n    <div>").concat(e,"</div>\n  "),n.insertBefore(o,n.firstChild);var a=n.querySelectorAll(".activity-item");a.length>10&&a[a.length-1].remove()}Office.onReady(function(e){try{var n,t;if(console.log("🚀 Office.onReady called with info:",e),console.log("📊 Office.js diagnostics:"),console.log("  - Office object type:","undefined"==typeof Office?"undefined":_typeof(Office)),console.log("  - Office.context type:",_typeof(null===(n=Office)||void 0===n?void 0:n.context)),console.log("  - Office.context.auth type:",_typeof(null===(t=Office)||void 0===t||null===(t=t.context)||void 0===t?void 0:t.auth)),console.log("  - Host detected:",null==e?void 0:e.host),console.log("  - Host type comparison:",(null==e?void 0:e.host)===Office.HostType.Outlook),console.log("  - Platform:",null==e?void 0:e.platform),e.host===Office.HostType.Outlook||"Outlook"===e.host||window.Office){console.log("✅ Host validated as Outlook-compatible"),document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var o=new Date("2025-08-12");document.getElementById("sync-date").value=o.toISOString().split("T")[0],syncManager=new CalendarSyncManager,initializeApp()}else console.warn("⚠️ Unsupported or unrecognized host application. Host info:",e),document.getElementById("sideload-msg").innerHTML='\n        <div style="color: orange; padding: 10px; border: 1px solid orange; border-radius: 5px;">\n          <h3>🔍 Host Detection Diagnostic</h3>\n          <p><strong>Detected host:</strong> '.concat((null==e?void 0:e.host)||"Unknown","</p>\n          <p><strong>Expected:</strong> Outlook</p>\n          <p><strong>Platform:</strong> ").concat((null==e?void 0:e.platform)||"Unknown","</p>\n          <p><strong>Office.js available:</strong> ").concat(window.Office?"Yes":"No","</p>\n          <p><strong>Status:</strong> Attempting to continue with limited functionality...</p>\n          <button onclick=\"this.parentElement.style.display='none'; document.getElementById('app-body').style.display='flex';\">Continue Anyway</button>\n        </div>\n      "),setTimeout(function(){try{syncManager=new CalendarSyncManager,initializeApp()}catch(e){console.error("❌ Delayed initialization failed:",e)}},1e3)}catch(e){console.error("❌ Office.onReady error:",e),document.getElementById("sideload-msg").innerHTML='\n      <div style="color: red; padding: 10px; border: 1px solid red; border-radius: 5px;">\n        <h3>🚨 Initialization Error</h3>\n        <p><strong>Error:</strong> '.concat(e.message,"</p>\n        <p><strong>Suggestion:</strong> Please ensure this add-in is loaded within Outlook</p>\n        <p><strong>Current URL:</strong> ").concat(window.location.href,"</p>\n        <button onclick=\"location.reload();\">Refresh Page</button>\n        <button onclick=\"this.parentElement.style.display='none'; document.getElementById('app-body').style.display='flex';\">Try Anyway</button>\n      </div>\n    ")}}),window.addEventListener("DOMContentLoaded",function(){setTimeout(function(){if(!syncManager)if(console.log("🔄 Fallback initialization triggered - Office.onReady may not have fired"),console.log("🔍 Office.js status check:"),console.log("  - window.Office available:",!!window.Office),console.log("  - Current URL:",window.location.href),console.log("  - User Agent:",navigator.userAgent),window.Office){console.log("✅ Office.js detected, attempting manual initialization");try{document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var e=new Date("2025-08-12");document.getElementById("sync-date").value=e.toISOString().split("T")[0],syncManager=new CalendarSyncManager,initializeApp()}catch(e){console.error("❌ Fallback initialization failed:",e),showContextGuidance()}}else console.warn("⚠️ Office.js not available - showing context guidance"),showContextGuidance()},2e3)}),window.toggleCalendarSync=toggleCalendarSync;