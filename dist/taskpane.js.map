{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/calendarSync.js","webpack://office-addin-taskpane-js/./src/taskpane/multiAccountUI.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\r\n * Calendar Synchronization Manager\r\n * Handles the core logic for synchronizing busy time across multiple calendars\r\n */\r\n\r\n/* global Office */\r\n\r\nexport class CalendarSyncManager {\r\n  constructor() {\r\n    this.syncEnabled = false;\r\n    this.calendars = new Map();\r\n    this.syncInterval = null;\r\n    this.lastSync = null;\r\n    this.syncInProgress = false;\r\n    \r\n    // Configuration\r\n    this.config = {\r\n      syncIntervalMinutes: 15, // Auto-sync every 15 minutes\r\n      busyBlockSubject: '[Auto-Sync] Busy',\r\n      busyBlockCategory: 'Auto-Sync',\r\n      lookAheadDays: 0, // Sync only current day (0 days ahead)\r\n      lookBehindDays: 0   // Sync only current day (0 days behind)\r\n    };\r\n  }\r\n\r\n  async initialize() {\r\n    try {\r\n      console.log('Initializing Calendar Sync Manager...');\r\n      \r\n      // Check if Office is available\r\n      if (!window.Office) {\r\n        throw new Error('Office.js is not loaded');\r\n      }\r\n      \r\n      // Check if we're in a supported context\r\n      if (!Office.context || !Office.context.mailbox) {\r\n        console.warn('Limited Office context detected, some features may not work');\r\n      }\r\n      \r\n      console.log('Office context available:', !!Office.context);\r\n      console.log('Mailbox available:', !!Office.context?.mailbox);\r\n      \r\n      // Request necessary permissions\r\n      await this.requestPermissions();\r\n      \r\n      // Load configuration from local storage\r\n      this.loadConfiguration();\r\n      \r\n      // Discover available calendars\r\n      await this.discoverCalendars();\r\n      \r\n      // Start auto-sync if enabled\r\n      if (this.syncEnabled) {\r\n        this.startAutoSync();\r\n      }\r\n      \r\n      console.log('Calendar Sync Manager initialized successfully');\r\n      \r\n    } catch (error) {\r\n      console.error('Failed to initialize Calendar Sync Manager:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async requestPermissions() {\r\n    return new Promise((resolve, reject) => {\r\n      try {\r\n        // Check if we have Office context and mailbox\r\n        if (!Office.context || !Office.context.mailbox) {\r\n          console.warn('Limited Office context, proceeding with basic initialization');\r\n          resolve();\r\n          return;\r\n        }\r\n\r\n        // Get diagnostic info\r\n        const diagnostics = Office.context.mailbox.diagnostics;\r\n        const hostName = diagnostics?.hostName;\r\n        console.log('Host diagnostics:', {\r\n          hostName: hostName,\r\n          hostVersion: diagnostics?.hostVersion,\r\n          platform: diagnostics?.platform\r\n        });\r\n\r\n        // More permissive host checking\r\n        if (hostName === 'Outlook' || \r\n            hostName === 'OutlookWebApp' || \r\n            hostName === 'OutlookIOS' || \r\n            hostName === 'OutlookAndroid' ||\r\n            !hostName) { // Allow undefined hostName as fallback\r\n          console.log('Host validation passed for:', hostName || 'unknown host');\r\n          resolve();\r\n        } else {\r\n          console.warn('Unknown host detected, proceeding anyway:', hostName);\r\n          resolve(); // Don't reject, just proceed\r\n        }\r\n      } catch (error) {\r\n        console.error('Error in requestPermissions:', error);\r\n        // Don't fail completely, just proceed\r\n        resolve();\r\n      }\r\n    });\r\n  }\r\n\r\n  loadConfiguration() {\r\n    try {\r\n      const savedConfig = localStorage.getItem('calendarSync_config');\r\n      if (savedConfig) {\r\n        const parsed = JSON.parse(savedConfig);\r\n        this.config = { ...this.config, ...parsed };\r\n      }\r\n      \r\n      const syncEnabled = localStorage.getItem('calendarSync_enabled');\r\n      this.syncEnabled = syncEnabled === 'true';\r\n      \r\n    } catch (error) {\r\n      console.warn('Failed to load configuration:', error);\r\n      // Use defaults\r\n    }\r\n  }\r\n\r\n  saveConfiguration() {\r\n    try {\r\n      localStorage.setItem('calendarSync_config', JSON.stringify(this.config));\r\n      localStorage.setItem('calendarSync_enabled', this.syncEnabled.toString());\r\n    } catch (error) {\r\n      console.warn('Failed to save configuration:', error);\r\n    }\r\n  }\r\n\r\n  async discoverCalendars() {\r\n    try {\r\n      console.log('Discovering real Microsoft accounts and calendars...');\r\n      \r\n      // Try to get real calendars first\r\n      const calendars = await this.getGraphCalendars();\r\n      \r\n      if (calendars && calendars.length > 0) {\r\n        this.calendars.clear();\r\n        calendars.forEach(cal => {\r\n          this.calendars.set(cal.id, cal);\r\n        });\r\n\r\n        console.log(`✅ Discovered ${this.calendars.size} real calendars from Graph API:`);\r\n        Array.from(this.calendars.values()).forEach(cal => {\r\n          console.log(`  📅 ${cal.name} (${cal.userEmail}) - Default: ${cal.isDefaultCalendar}`);\r\n        });\r\n      } else {\r\n        throw new Error('No calendars returned from Graph API');\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.warn('⚠️ Graph API discovery failed, checking why:', error);\r\n      \r\n      // Try alternative approaches or fallback\r\n      try {\r\n        await this.tryAlternativeDiscovery();\r\n      } catch (altError) {\r\n        console.warn('⚠️ Alternative discovery also failed:', altError);\r\n        console.log('📝 Using enhanced mock data with email simulation...');\r\n        await this.discoverEnhancedMockCalendars();\r\n      }\r\n    }\r\n  }\r\n\r\n  async tryAlternativeDiscovery() {\r\n    // Try to get user profile first to check authentication\r\n    const accessToken = await this.getGraphAccessToken();\r\n    \r\n    console.log('🔍 Testing Graph API access with user profile...');\r\n    const profileResponse = await fetch('https://graph.microsoft.com/v1.0/me', {\r\n      headers: {\r\n        'Authorization': `Bearer ${accessToken}`,\r\n        'Content-Type': 'application/json'\r\n      }\r\n    });\r\n\r\n    if (!profileResponse.ok) {\r\n      throw new Error(`Profile API error: ${profileResponse.status} ${profileResponse.statusText}`);\r\n    }\r\n\r\n    const profile = await profileResponse.json();\r\n    console.log(`✅ Authenticated as: ${profile.displayName} (${profile.mail || profile.userPrincipalName})`);\r\n    \r\n    // Try calendars again with better error info\r\n    const calResponse = await fetch('https://graph.microsoft.com/v1.0/me/calendars', {\r\n      headers: {\r\n        'Authorization': `Bearer ${accessToken}`,\r\n        'Content-Type': 'application/json'\r\n      }\r\n    });\r\n\r\n    if (!calResponse.ok) {\r\n      const errorText = await calResponse.text();\r\n      throw new Error(`Calendars API error: ${calResponse.status} ${calResponse.statusText} - ${errorText}`);\r\n    }\r\n\r\n    const calData = await calResponse.json();\r\n    console.log('📅 Raw calendar data from Graph:', calData);\r\n    \r\n    // Convert to our format with the authenticated user's email\r\n    const userEmail = profile.mail || profile.userPrincipalName;\r\n    const calendars = calData.value.map(graphCal => ({\r\n      id: graphCal.id,\r\n      name: graphCal.name,\r\n      userEmail: graphCal.owner?.emailAddress?.address || userEmail,\r\n      type: 'Microsoft Graph',\r\n      syncEnabled: true,\r\n      canEdit: graphCal.canEdit || false,\r\n      isDefaultCalendar: graphCal.isDefaultCalendar || false\r\n    }));\r\n\r\n    this.calendars.clear();\r\n    calendars.forEach(cal => {\r\n      this.calendars.set(cal.id, cal);\r\n    });\r\n\r\n    console.log(`✅ Successfully discovered ${calendars.length} calendars with emails`);\r\n  }\r\n\r\n  async discoverEnhancedMockCalendars() {\r\n    // Enhanced mock calendars with realistic email addresses\r\n    const mockCalendars = [\r\n      {\r\n        id: 'calendar-1',\r\n        name: 'Primary Work Calendar',\r\n        userEmail: 'dan.hookham@company1.com',\r\n        type: 'Exchange Online',\r\n        syncEnabled: true,\r\n        isDefaultCalendar: true\r\n      },\r\n      {\r\n        id: 'calendar-2', \r\n        name: 'Secondary Work Calendar',\r\n        userEmail: 'dan.hookham@company2.com',\r\n        type: 'Office 365',\r\n        syncEnabled: true,\r\n        isDefaultCalendar: false\r\n      },\r\n      {\r\n        id: 'calendar-3',\r\n        name: 'Personal Calendar',\r\n        userEmail: 'dan.hookham@outlook.com',\r\n        type: 'Outlook.com',\r\n        syncEnabled: true,\r\n        isDefaultCalendar: false\r\n      },\r\n      {\r\n        id: 'calendar-4',\r\n        name: 'Project Calendar',\r\n        userEmail: 'dan.hookham@company3.com',\r\n        type: 'Exchange',\r\n        syncEnabled: true,\r\n        isDefaultCalendar: false\r\n      },\r\n      {\r\n        id: 'calendar-5',\r\n        name: 'Client Calendar',\r\n        userEmail: 'dan.hookham@company4.com',\r\n        type: 'Office 365',\r\n        syncEnabled: true,\r\n        isDefaultCalendar: false\r\n      }\r\n    ];\r\n\r\n    this.calendars.clear();\r\n    mockCalendars.forEach(cal => {\r\n      this.calendars.set(cal.id, cal);\r\n    });\r\n\r\n    console.log('📝 Using enhanced mock calendars with email addresses:');\r\n    mockCalendars.forEach(cal => {\r\n      console.log(`  📅 ${cal.name} (${cal.userEmail})`);\r\n    });\r\n  }\r\n\r\n  async getGraphCalendars() {\r\n    try {\r\n      const accessToken = await this.getGraphAccessToken();\r\n      console.log('🔐 Graph access token obtained, fetching calendars...');\r\n      \r\n      // First try to get the user's profile to understand the context\r\n      const profileResponse = await fetch('https://graph.microsoft.com/v1.0/me', {\r\n        headers: {\r\n          'Authorization': `Bearer ${accessToken}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      if (!profileResponse.ok) {\r\n        throw new Error(`Profile API failed: ${profileResponse.status}`);\r\n      }\r\n\r\n      const userProfile = await profileResponse.json();\r\n      const primaryEmail = userProfile.mail || userProfile.userPrincipalName;\r\n      console.log(`👤 Primary user: ${userProfile.displayName} (${primaryEmail})`);\r\n\r\n      // Get calendars with expanded properties\r\n      const calendarResponse = await fetch('https://graph.microsoft.com/v1.0/me/calendars?$select=id,name,canEdit,isDefaultCalendar,owner', {\r\n        headers: {\r\n          'Authorization': `Bearer ${accessToken}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      if (!calendarResponse.ok) {\r\n        const errorText = await calendarResponse.text();\r\n        console.error('Calendar API error response:', errorText);\r\n        throw new Error(`Calendar API failed: ${calendarResponse.status} - ${errorText}`);\r\n      }\r\n\r\n      const calendarData = await calendarResponse.json();\r\n      console.log('📊 Raw Graph calendar response:', calendarData);\r\n\r\n      if (!calendarData.value || calendarData.value.length === 0) {\r\n        console.warn('⚠️ No calendars found in Graph response');\r\n        return [];\r\n      }\r\n\r\n      // Try to also get calendar groups for shared/delegated calendars\r\n      let additionalCalendars = [];\r\n      try {\r\n        const groupResponse = await fetch('https://graph.microsoft.com/v1.0/me/calendarGroups?$expand=calendars', {\r\n          headers: {\r\n            'Authorization': `Bearer ${accessToken}`,\r\n            'Content-Type': 'application/json'\r\n          }\r\n        });\r\n\r\n        if (groupResponse.ok) {\r\n          const groupData = await groupResponse.json();\r\n          console.log('📂 Calendar groups found:', groupData);\r\n          \r\n          // Extract calendars from groups\r\n          groupData.value?.forEach(group => {\r\n            if (group.calendars) {\r\n              additionalCalendars.push(...group.calendars);\r\n            }\r\n          });\r\n        }\r\n      } catch (groupError) {\r\n        console.log('ℹ️ Calendar groups not accessible (normal for some accounts):', groupError.message);\r\n      }\r\n\r\n      // Combine and deduplicate calendars\r\n      const allCalendars = [...calendarData.value, ...additionalCalendars];\r\n      const uniqueCalendars = allCalendars.filter((cal, index, self) => \r\n        index === self.findIndex(c => c.id === cal.id)\r\n      );\r\n\r\n      console.log(`📅 Found ${uniqueCalendars.length} total calendars (${calendarData.value.length} primary + ${additionalCalendars.length} from groups)`);\r\n\r\n      // Convert to our calendar format\r\n      const calendars = uniqueCalendars.map(graphCal => {\r\n        const ownerEmail = graphCal.owner?.emailAddress?.address || primaryEmail;\r\n        return {\r\n          id: graphCal.id,\r\n          name: graphCal.name || 'Unnamed Calendar',\r\n          userEmail: ownerEmail,\r\n          type: 'Microsoft Graph',\r\n          syncEnabled: true,\r\n          canEdit: graphCal.canEdit !== false, // Default to true if not specified\r\n          isDefaultCalendar: graphCal.isDefaultCalendar || false\r\n        };\r\n      });\r\n\r\n      console.log('✅ Processed calendars:');\r\n      calendars.forEach(cal => {\r\n        console.log(`  📅 \"${cal.name}\" owned by ${cal.userEmail} (Default: ${cal.isDefaultCalendar}, Editable: ${cal.canEdit})`);\r\n      });\r\n\r\n      return calendars;\r\n\r\n    } catch (error) {\r\n      console.error('❌ getGraphCalendars failed:', error);\r\n      console.log('🔄 Will attempt alternative discovery or fall back to mock data');\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async getGraphAccessToken() {\r\n    try {\r\n      console.log('🔐 Requesting Graph access token...');\r\n      \r\n      // Check Office.js availability step by step\r\n      console.log('🔍 Checking Office.js availability:');\r\n      console.log('  - Office object:', typeof Office);\r\n      console.log('  - Office.context:', typeof Office?.context);\r\n      console.log('  - Office.context.auth:', typeof Office?.context?.auth);\r\n      console.log('  - getAccessToken method:', typeof Office?.context?.auth?.getAccessToken);\r\n      \r\n      // Check if we're in the right host application\r\n      if (Office?.context?.host) {\r\n        console.log('🏢 Host application:', Office.context.host);\r\n        console.log('📱 Platform:', Office.context.platform);\r\n        console.log('🔧 Requirements:', Office.context.requirements);\r\n      }\r\n\r\n      // Check if Office.js auth is available\r\n      if (!Office?.context?.auth?.getAccessToken) {\r\n        console.warn('⚠️ Office.js authentication not available in this context');\r\n        console.log('🔄 Attempting alternative authentication methods...');\r\n        \r\n        // Try to check if we're in a web context that supports alternative auth\r\n        if (typeof window !== 'undefined' && window.location) {\r\n          console.log('🌐 Running in web context:', window.location.href);\r\n          \r\n          // For testing purposes, try to simulate a token or provide guidance\r\n          throw new Error('Office.js SSO not available - add-in may need to be loaded in proper Office context');\r\n        }\r\n        \r\n        throw new Error('Office.js authentication not available in this context');\r\n      }\r\n\r\n      console.log('✅ Office.js authentication is available, requesting token...');\r\n\r\n      // Use Office.js to get access token for Microsoft Graph\r\n      return new Promise((resolve, reject) => {\r\n        const tokenOptions = {\r\n          allowSignInPrompt: true,\r\n          allowConsentPrompt: true,\r\n          forMSGraphAccess: true\r\n        };\r\n        \r\n        console.log('📋 Token request options:', tokenOptions);\r\n\r\n        Office.context.auth.getAccessToken(tokenOptions, (result) => {\r\n          console.log('🔍 Auth result status:', result.status);\r\n          console.log('🔍 Full auth result:', result);\r\n          \r\n          if (result.status === Office.AsyncResultStatus.Succeeded) {\r\n            console.log('✅ Access token obtained successfully');\r\n            console.log('🎫 Token preview:', result.value.substring(0, 20) + '...');\r\n            console.log('🎫 Token length:', result.value.length);\r\n            resolve(result.value);\r\n          } else {\r\n            console.error('❌ Authentication failed:', result.error);\r\n            console.error('Error code:', result.error?.code);\r\n            console.error('Error message:', result.error?.message);\r\n            console.error('Error name:', result.error?.name);\r\n            console.error('Error tracing:', result.error?.tracing);\r\n            \r\n            // Provide more specific error information\r\n            let errorMsg = `Authentication failed: ${result.error?.message || 'Unknown error'}`;\r\n            if (result.error?.code === 13001) {\r\n              errorMsg += ' (User not signed in - this may require signing into Office)';\r\n            } else if (result.error?.code === 13002) {\r\n              errorMsg += ' (User consent required - admin may need to grant permissions)';\r\n            } else if (result.error?.code === 13003) {\r\n              errorMsg += ' (Invalid audience - token scope issue)';\r\n            } else if (result.error?.code === 13006) {\r\n              errorMsg += ' (Invalid request - check add-in manifest permissions)';\r\n            } else if (result.error?.code === 13007) {\r\n              errorMsg += ' (Invalid grant - user may need to re-authenticate)';\r\n            } else if (result.error?.code === 13012) {\r\n              errorMsg += ' (Add-in not trusted - may need admin consent)';\r\n            }\r\n            \r\n            reject(new Error(errorMsg));\r\n          }\r\n        });\r\n      });\r\n    } catch (error) {\r\n      console.error('❌ Failed to get Graph access token:', error);\r\n      console.log('💡 Troubleshooting suggestions:');\r\n      console.log('  1. Ensure add-in is loaded in Outlook (not just web browser)');\r\n      console.log('  2. Check that manifest is properly deployed');\r\n      console.log('  3. Verify Office.js is fully loaded');\r\n      console.log('  4. Check manifest WebApplicationInfo configuration');\r\n      throw new Error(`Authentication setup failed: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  async discoverMockCalendars() {\r\n    // Fallback mock calendars for testing\r\n    const mockCalendars = [\r\n      {\r\n        id: 'calendar-1',\r\n        name: 'Primary Work Calendar',\r\n        userEmail: 'user@company1.com',\r\n        type: 'Exchange',\r\n        syncEnabled: true,\r\n        isDefaultCalendar: true\r\n      },\r\n      {\r\n        id: 'calendar-2', \r\n        name: 'Secondary Work Calendar',\r\n        userEmail: 'user@company2.com',\r\n        type: 'Office 365',\r\n        syncEnabled: true,\r\n        isDefaultCalendar: false\r\n      },\r\n      {\r\n        id: 'calendar-3',\r\n        name: 'Personal Calendar',\r\n        userEmail: 'personal@outlook.com',\r\n        type: 'Outlook.com',\r\n        syncEnabled: true,\r\n        isDefaultCalendar: false\r\n      }\r\n    ];\r\n\r\n    this.calendars.clear();\r\n    mockCalendars.forEach(cal => {\r\n      this.calendars.set(cal.id, cal);\r\n    });\r\n\r\n    console.log('Using mock calendars for testing');\r\n  }\r\n\r\n  async getAvailableCalendars() {\r\n    return Array.from(this.calendars.values());\r\n  }\r\n\r\n  async toggleCalendarSync(calendarId) {\r\n    const calendar = this.calendars.get(calendarId);\r\n    if (!calendar) {\r\n      throw new Error('Calendar not found');\r\n    }\r\n\r\n    calendar.syncEnabled = !calendar.syncEnabled;\r\n    this.saveConfiguration();\r\n    \r\n    console.log(`Calendar sync ${calendar.syncEnabled ? 'enabled' : 'disabled'} for ${calendar.name}`);\r\n    \r\n    return calendar.syncEnabled;\r\n  }\r\n\r\n  async performSync(targetDate = null) {\r\n    if (this.syncInProgress) {\r\n      throw new Error('Sync already in progress');\r\n    }\r\n\r\n    this.syncInProgress = true;\r\n    \r\n    try {\r\n      // Use target date or default to current date range\r\n      const syncDate = targetDate || new Date();\r\n      console.log(`Starting calendar synchronization for ${syncDate.toLocaleDateString()}...`);\r\n      \r\n      // Calculate date range for single day sync\r\n      const startDate = new Date(syncDate);\r\n      startDate.setHours(0, 0, 0, 0); // Start of day\r\n      \r\n      const endDate = new Date(syncDate);\r\n      endDate.setHours(23, 59, 59, 999); // End of day\r\n      \r\n      // Get all enabled calendars\r\n      const enabledCalendars = Array.from(this.calendars.values())\r\n        .filter(cal => cal.syncEnabled);\r\n\r\n      if (enabledCalendars.length < 2) {\r\n        throw new Error('At least 2 calendars must be enabled for synchronization');\r\n      }\r\n\r\n      // Get busy times from all calendars\r\n      const busyTimes = await this.getBusyTimesFromCalendars(enabledCalendars);\r\n      \r\n      // Remove existing sync blocks\r\n      const removedBlocks = await this.removeExistingSyncBlocks(enabledCalendars);\r\n      \r\n      // Create new sync blocks\r\n      const createdBlocks = await this.createSyncBlocks(enabledCalendars, busyTimes);\r\n      \r\n      this.lastSync = new Date();\r\n      \r\n      console.log(`Sync completed: ${createdBlocks} blocks created, ${removedBlocks} blocks removed`);\r\n      \r\n      return {\r\n        blocksCreated: createdBlocks,\r\n        blocksRemoved: removedBlocks,\r\n        syncTime: this.lastSync\r\n      };\r\n      \r\n    } catch (error) {\r\n      console.error('Sync failed:', error);\r\n      throw error;\r\n    } finally {\r\n      this.syncInProgress = false;\r\n    }\r\n  }\r\n\r\n  async getBusyTimesFromCalendars(calendars) {\r\n    const busyTimes = new Map();\r\n    \r\n    for (const calendar of calendars) {\r\n      try {\r\n        console.log(`Fetching busy times for ${calendar.name} (${calendar.userEmail})`);\r\n        \r\n        // Get real busy times from Microsoft Graph API\r\n        const calendarBusyTimes = await this.getRealBusyTimes(calendar);\r\n        busyTimes.set(calendar.id, calendarBusyTimes);\r\n        \r\n        console.log(`Found ${calendarBusyTimes.length} busy times in ${calendar.name}`);\r\n        \r\n      } catch (error) {\r\n        console.warn(`Failed to get busy times for ${calendar.name}:`, error);\r\n        // Fallback to simulation if Graph API fails\r\n        const simulatedTimes = await this.simulateGetBusyTimes(calendar);\r\n        busyTimes.set(calendar.id, simulatedTimes);\r\n      }\r\n    }\r\n    \r\n    return busyTimes;\r\n  }\r\n\r\n  async getRealBusyTimes(calendar) {\r\n    try {\r\n      const accessToken = await this.getGraphAccessToken();\r\n      \r\n      // Calculate date range for the target date\r\n      const targetDate = this.targetDate || new Date();\r\n      const startTime = new Date(targetDate);\r\n      startTime.setHours(0, 0, 0, 0);\r\n      \r\n      const endTime = new Date(targetDate);\r\n      endTime.setHours(23, 59, 59, 999);\r\n      \r\n      // Query calendar events for the specific date\r\n      const eventsUrl = `https://graph.microsoft.com/v1.0/me/calendars/${calendar.id}/events` +\r\n        `?$filter=start/dateTime ge '${startTime.toISOString()}' and end/dateTime le '${endTime.toISOString()}'` +\r\n        `&$select=subject,start,end,showAs,isPrivate`;\r\n      \r\n      const response = await fetch(eventsUrl, {\r\n        headers: {\r\n          'Authorization': `Bearer ${accessToken}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Graph API error: ${response.status} ${response.statusText}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      \r\n      // Convert events to busy time blocks\r\n      return data.value\r\n        .filter(event => event.showAs === 'busy' || event.showAs === 'tentative')\r\n        .map(event => ({\r\n          start: new Date(event.start.dateTime),\r\n          end: new Date(event.end.dateTime),\r\n          subject: event.isPrivate ? '[Private]' : (event.subject || '[No Subject]'),\r\n          isPrivate: event.isPrivate || false\r\n        }));\r\n\r\n    } catch (error) {\r\n      console.error(`Graph API call failed for ${calendar.name}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async simulateGetBusyTimes(calendar) {\r\n    // Simulate API delay\r\n    await new Promise(resolve => setTimeout(resolve, 100));\r\n    \r\n    // Generate some mock busy times for demonstration\r\n    const now = new Date();\r\n    const busyTimes = [];\r\n    \r\n    // Add a few random busy slots over the next few days\r\n    for (let i = 0; i < Math.floor(Math.random() * 5) + 1; i++) {\r\n      const start = new Date(now.getTime() + Math.random() * 7 * 24 * 60 * 60 * 1000);\r\n      const duration = (Math.random() * 3 + 0.5) * 60 * 60 * 1000; // 30min to 3.5 hours\r\n      const end = new Date(start.getTime() + duration);\r\n      \r\n      busyTimes.push({\r\n        start: start,\r\n        end: end,\r\n        subject: `Meeting in ${calendar.name}`,\r\n        isPrivate: false\r\n      });\r\n    }\r\n    \r\n    return busyTimes;\r\n  }\r\n\r\n  async removeExistingSyncBlocks(calendars) {\r\n    let removedCount = 0;\r\n    \r\n    for (const calendar of calendars) {\r\n      try {\r\n        // In a real implementation, this would find and delete sync blocks\r\n        // For now, we'll simulate the removal\r\n        const removed = await this.simulateRemoveSyncBlocks(calendar);\r\n        removedCount += removed;\r\n        \r\n      } catch (error) {\r\n        console.warn(`Failed to remove sync blocks from ${calendar.name}:`, error);\r\n      }\r\n    }\r\n    \r\n    return removedCount;\r\n  }\r\n\r\n  async simulateRemoveSyncBlocks(calendar) {\r\n    // Simulate API delay\r\n    await new Promise(resolve => setTimeout(resolve, 50));\r\n    \r\n    // Simulate removing some blocks\r\n    return Math.floor(Math.random() * 3);\r\n  }\r\n\r\n  async createSyncBlocks(calendars, busyTimes) {\r\n    let createdCount = 0;\r\n    \r\n    // For each calendar, create busy blocks for times from other calendars\r\n    for (const targetCalendar of calendars) {\r\n      try {\r\n        const blocksToCreate = [];\r\n        \r\n        // Collect busy times from all other calendars\r\n        for (const [sourceCalendarId, times] of busyTimes) {\r\n          if (sourceCalendarId !== targetCalendar.id) {\r\n            blocksToCreate.push(...times);\r\n          }\r\n        }\r\n        \r\n        // Create the busy blocks\r\n        const created = await this.simulateCreateSyncBlocks(targetCalendar, blocksToCreate);\r\n        createdCount += created;\r\n        \r\n      } catch (error) {\r\n        console.warn(`Failed to create sync blocks in ${targetCalendar.name}:`, error);\r\n      }\r\n    }\r\n    \r\n    return createdCount;\r\n  }\r\n\r\n  async simulateCreateSyncBlocks(calendar, busyTimes) {\r\n    try {\r\n      // Try to create real sync blocks via Graph API\r\n      return await this.createRealSyncBlocks(calendar, busyTimes);\r\n    } catch (error) {\r\n      console.warn(`Graph API failed, simulating for ${calendar.name}:`, error);\r\n      \r\n      // Fallback to simulation\r\n      await new Promise(resolve => setTimeout(resolve, 100));\r\n      \r\n      const calendarInfo = calendar.userEmail ? \r\n        `${calendar.name} (${calendar.userEmail})` : \r\n        calendar.name;\r\n      \r\n      console.log(`Would create ${busyTimes.length} sync blocks in ${calendarInfo}`);\r\n      \r\n      return busyTimes.length;\r\n    }\r\n  }\r\n\r\n  async createRealSyncBlocks(calendar, busyTimes) {\r\n    const accessToken = await this.getGraphAccessToken();\r\n    let createdCount = 0;\r\n\r\n    for (const busyTime of busyTimes) {\r\n      try {\r\n        // Create a busy block event in the target calendar\r\n        const eventData = {\r\n          subject: this.config.busyBlockSubject,\r\n          start: {\r\n            dateTime: busyTime.start.toISOString(),\r\n            timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone\r\n          },\r\n          end: {\r\n            dateTime: busyTime.end.toISOString(),\r\n            timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone\r\n          },\r\n          showAs: 'busy',\r\n          isPrivate: true,\r\n          categories: [this.config.busyBlockCategory],\r\n          body: {\r\n            contentType: 'text',\r\n            content: 'Auto-synchronized busy time from another calendar'\r\n          }\r\n        };\r\n\r\n        const response = await fetch(`https://graph.microsoft.com/v1.0/me/calendars/${calendar.id}/events`, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Authorization': `Bearer ${accessToken}`,\r\n            'Content-Type': 'application/json'\r\n          },\r\n          body: JSON.stringify(eventData)\r\n        });\r\n\r\n        if (response.ok) {\r\n          createdCount++;\r\n          console.log(`Created sync block in ${calendar.name}: ${busyTime.start.toLocaleTimeString()} - ${busyTime.end.toLocaleTimeString()}`);\r\n        } else {\r\n          console.warn(`Failed to create sync block in ${calendar.name}: ${response.status}`);\r\n        }\r\n\r\n      } catch (error) {\r\n        console.error(`Error creating sync block in ${calendar.name}:`, error);\r\n      }\r\n    }\r\n\r\n    console.log(`Created ${createdCount} real sync blocks in ${calendar.name} (${calendar.userEmail})`);\r\n    return createdCount;\r\n  }\r\n\r\n  startAutoSync() {\r\n    if (this.syncInterval) {\r\n      clearInterval(this.syncInterval);\r\n    }\r\n    \r\n    const intervalMs = this.config.syncIntervalMinutes * 60 * 1000;\r\n    this.syncInterval = setInterval(() => {\r\n      this.performSync().catch(error => {\r\n        console.error('Auto-sync failed:', error);\r\n      });\r\n    }, intervalMs);\r\n    \r\n    console.log(`Auto-sync started with ${this.config.syncIntervalMinutes} minute interval`);\r\n  }\r\n\r\n  stopAutoSync() {\r\n    if (this.syncInterval) {\r\n      clearInterval(this.syncInterval);\r\n      this.syncInterval = null;\r\n      console.log('Auto-sync stopped');\r\n    }\r\n  }\r\n\r\n  async getSyncStatus() {\r\n    if (this.syncInProgress) {\r\n      return {\r\n        state: 'Syncing',\r\n        message: 'Synchronization in progress...',\r\n        lastSync: this.lastSync\r\n      };\r\n    }\r\n    \r\n    if (!this.syncEnabled) {\r\n      return {\r\n        state: 'Stopped',\r\n        message: 'Synchronization disabled',\r\n        lastSync: this.lastSync\r\n      };\r\n    }\r\n    \r\n    const enabledCount = Array.from(this.calendars.values())\r\n      .filter(cal => cal.syncEnabled).length;\r\n      \r\n    if (enabledCount < 2) {\r\n      return {\r\n        state: 'Error',\r\n        message: 'Need at least 2 enabled calendars',\r\n        lastSync: this.lastSync\r\n      };\r\n    }\r\n    \r\n    return {\r\n      state: 'Active',\r\n      message: `Monitoring ${enabledCount} calendars`,\r\n      lastSync: this.lastSync\r\n    };\r\n  }\r\n\r\n  // Configuration methods\r\n  setSyncInterval(minutes) {\r\n    this.config.syncIntervalMinutes = minutes;\r\n    this.saveConfiguration();\r\n    \r\n    if (this.syncInterval) {\r\n      this.startAutoSync(); // Restart with new interval\r\n    }\r\n  }\r\n\r\n  setBusyBlockSubject(subject) {\r\n    this.config.busyBlockSubject = subject;\r\n    this.saveConfiguration();\r\n  }\r\n\r\n  setLookAheadDays(days) {\r\n    this.config.lookAheadDays = days;\r\n    this.saveConfiguration();\r\n  }\r\n\r\n  getConfiguration() {\r\n    return { ...this.config };\r\n  }\r\n}\r\n","/**\r\n * Multi-Account Calendar UI Manager\r\n * Handles the user interface for connecting and managing multiple calendar accounts\r\n */\r\n\r\nexport class MultiAccountUI {\r\n  constructor(multiTenantManager) {\r\n    this.manager = multiTenantManager;\r\n    this.currentView = 'overview';\r\n  }\r\n\r\n  /**\r\n   * Initialize the multi-account interface\r\n   */\r\n  initialize() {\r\n    this.createAccountManagementUI();\r\n    this.bindEvents();\r\n    this.refreshAccountsList();\r\n  }\r\n\r\n  /**\r\n   * Create the main account management interface\r\n   */\r\n  createAccountManagementUI() {\r\n    const container = document.getElementById('auth-container') || \r\n                     document.getElementById('calendar-list') ||\r\n                     document.createElement('div');\r\n\r\n    container.innerHTML = `\r\n      <div class=\"multi-account-manager\">\r\n        <!-- Header -->\r\n        <div class=\"account-header\">\r\n          <h2>📅 Multi-Tenant Calendar Sync</h2>\r\n          <p>Connect your calendars across different organizations and services</p>\r\n        </div>\r\n\r\n        <!-- Navigation Tabs -->\r\n        <div class=\"account-tabs\">\r\n          <button class=\"tab-btn active\" data-tab=\"overview\">Overview</button>\r\n          <button class=\"tab-btn\" data-tab=\"add-account\">Add Account</button>\r\n          <button class=\"tab-btn\" data-tab=\"sync-status\">Sync Status</button>\r\n        </div>\r\n\r\n        <!-- Overview Tab -->\r\n        <div class=\"tab-content active\" id=\"overview-tab\">\r\n          <div class=\"accounts-summary\">\r\n            <h3>Connected Accounts</h3>\r\n            <div id=\"accounts-list\" class=\"accounts-list\">\r\n              <div class=\"loading\">Loading accounts...</div>\r\n            </div>\r\n            <div class=\"sync-actions\">\r\n              <button id=\"sync-all-btn\" class=\"btn-primary\">🔄 Sync All Calendars</button>\r\n              <button id=\"test-mode-btn\" class=\"btn-secondary\">🧪 Load Test Accounts</button>\r\n            </div>\r\n          </div>\r\n          \r\n          <div class=\"sync-overview\">\r\n            <h3>Sync Configuration</h3>\r\n            <div class=\"sync-settings\">\r\n              <label>\r\n                <input type=\"checkbox\" id=\"auto-sync\" checked> \r\n                Enable automatic synchronization\r\n              </label>\r\n              <label>\r\n                Sync interval: \r\n                <select id=\"sync-interval\">\r\n                  <option value=\"5\">5 minutes</option>\r\n                  <option value=\"15\" selected>15 minutes</option>\r\n                  <option value=\"30\">30 minutes</option>\r\n                  <option value=\"60\">1 hour</option>\r\n                </select>\r\n              </label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Add Account Tab -->\r\n        <div class=\"tab-content\" id=\"add-account-tab\">\r\n          <div class=\"add-account-form\">\r\n            <h3>Add New Calendar Account</h3>\r\n            \r\n            <div class=\"account-type-selection\">\r\n              <h4>Select Account Type:</h4>\r\n              \r\n              <div class=\"account-type-grid\">\r\n                <div class=\"account-type-card\" data-type=\"office365\">\r\n                  <div class=\"account-icon\">🏢</div>\r\n                  <h4>Office 365</h4>\r\n                  <p>Business Microsoft account from another organization</p>\r\n                  <button class=\"select-type-btn\">Connect</button>\r\n                </div>\r\n                \r\n                <div class=\"account-type-card\" data-type=\"gmail\">\r\n                  <div class=\"account-icon\">📧</div>\r\n                  <h4>Gmail</h4>\r\n                  <p>Google Calendar from Gmail account</p>\r\n                  <button class=\"select-type-btn\">Connect</button>\r\n                </div>\r\n                \r\n                <div class=\"account-type-card\" data-type=\"outlook_com\">\r\n                  <div class=\"account-icon\">📨</div>\r\n                  <h4>Outlook.com</h4>\r\n                  <p>Personal Microsoft account</p>\r\n                  <button class=\"select-type-btn\">Connect</button>\r\n                </div>\r\n                \r\n                <div class=\"account-type-card\" data-type=\"exchange\">\r\n                  <div class=\"account-icon\">🏛️</div>\r\n                  <h4>Exchange Server</h4>\r\n                  <p>On-premises Exchange calendar</p>\r\n                  <button class=\"select-type-btn\">Connect</button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Account Configuration Form -->\r\n            <div class=\"account-config-form\" id=\"account-config-form\" style=\"display: none;\">\r\n              <h4 id=\"config-form-title\">Configure Account</h4>\r\n              \r\n              <div class=\"form-group\">\r\n                <label for=\"account-email\">Email Address:</label>\r\n                <input type=\"email\" id=\"account-email\" placeholder=\"your.name@company.com\" required>\r\n              </div>\r\n              \r\n              <div class=\"form-group\">\r\n                <label for=\"account-display-name\">Display Name:</label>\r\n                <input type=\"text\" id=\"account-display-name\" placeholder=\"Company Name\" required>\r\n              </div>\r\n              \r\n              <div class=\"form-group\" id=\"tenant-config\" style=\"display: none;\">\r\n                <label for=\"tenant-id\">Tenant ID (for Office 365):</label>\r\n                <input type=\"text\" id=\"tenant-id\" placeholder=\"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\">\r\n                <small>Found in Azure AD > Properties > Directory ID</small>\r\n              </div>\r\n              \r\n              <div class=\"form-group\" id=\"client-config\" style=\"display: none;\">\r\n                <label for=\"client-id\">Client ID:</label>\r\n                <input type=\"text\" id=\"client-id\" placeholder=\"Application ID from app registration\">\r\n                <small>Create an app registration in Azure AD / Google Console</small>\r\n              </div>\r\n              \r\n              <div class=\"form-actions\">\r\n                <button type=\"button\" id=\"save-account-btn\" class=\"btn-primary\">Save & Connect</button>\r\n                <button type=\"button\" id=\"cancel-config-btn\" class=\"btn-secondary\">Cancel</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Sync Status Tab -->\r\n        <div class=\"tab-content\" id=\"sync-status-tab\">\r\n          <div class=\"sync-status-view\">\r\n            <h3>Synchronization Status</h3>\r\n            \r\n            <div class=\"sync-timeline\">\r\n              <h4>Recent Sync Activity</h4>\r\n              <div id=\"sync-timeline-list\" class=\"timeline-list\">\r\n                <div class=\"timeline-item\">\r\n                  <div class=\"timeline-time\">2:30 PM</div>\r\n                  <div class=\"timeline-content\">\r\n                    <strong>✅ Sync completed</strong><br>\r\n                    All accounts synchronized successfully\r\n                  </div>\r\n                </div>\r\n                <div class=\"timeline-item\">\r\n                  <div class=\"timeline-time\">2:15 PM</div>\r\n                  <div class=\"timeline-content\">\r\n                    <strong>🔄 Sync started</strong><br>\r\n                    Processing 5 connected accounts\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <div class=\"sync-conflicts\">\r\n              <h4>Conflicts & Issues</h4>\r\n              <div id=\"conflicts-list\" class=\"conflicts-list\">\r\n                <div class=\"no-conflicts\">No conflicts detected</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n    // Add to page if not already there\r\n    if (!document.getElementById('auth-container')) {\r\n      document.body.appendChild(container);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Bind event handlers\r\n   */\r\n  bindEvents() {\r\n    // Tab switching\r\n    document.querySelectorAll('.tab-btn').forEach(btn => {\r\n      btn.addEventListener('click', (e) => {\r\n        this.switchTab(e.target.dataset.tab);\r\n      });\r\n    });\r\n\r\n    // Account type selection\r\n    document.querySelectorAll('.account-type-card').forEach(card => {\r\n      card.addEventListener('click', (e) => {\r\n        const button = e.target.closest('.account-type-card').querySelector('.select-type-btn');\r\n        if (button) button.click();\r\n      });\r\n    });\r\n\r\n    document.querySelectorAll('.select-type-btn').forEach(btn => {\r\n      btn.addEventListener('click', (e) => {\r\n        e.stopPropagation();\r\n        const accountType = e.target.closest('.account-type-card').dataset.type;\r\n        this.showAccountConfigForm(accountType);\r\n      });\r\n    });\r\n\r\n    // Form actions\r\n    document.getElementById('save-account-btn')?.addEventListener('click', () => {\r\n      this.saveAccountConfiguration();\r\n    });\r\n\r\n    document.getElementById('cancel-config-btn')?.addEventListener('click', () => {\r\n      this.hideAccountConfigForm();\r\n    });\r\n\r\n    // Sync actions\r\n    document.getElementById('sync-all-btn')?.addEventListener('click', () => {\r\n      this.syncAllAccounts();\r\n    });\r\n\r\n    document.getElementById('test-mode-btn')?.addEventListener('click', () => {\r\n      this.loadTestAccounts();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Switch between tabs\r\n   */\r\n  switchTab(tabName) {\r\n    // Update tab buttons\r\n    document.querySelectorAll('.tab-btn').forEach(btn => {\r\n      btn.classList.toggle('active', btn.dataset.tab === tabName);\r\n    });\r\n\r\n    // Update tab content\r\n    document.querySelectorAll('.tab-content').forEach(content => {\r\n      content.classList.toggle('active', content.id === `${tabName}-tab`);\r\n    });\r\n\r\n    this.currentView = tabName;\r\n\r\n    // Refresh data when switching to certain tabs\r\n    if (tabName === 'overview') {\r\n      this.refreshAccountsList();\r\n    } else if (tabName === 'sync-status') {\r\n      this.refreshSyncStatus();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Show account configuration form\r\n   */\r\n  showAccountConfigForm(accountType) {\r\n    const form = document.getElementById('account-config-form');\r\n    const title = document.getElementById('config-form-title');\r\n    const tenantConfig = document.getElementById('tenant-config');\r\n    const clientConfig = document.getElementById('client-config');\r\n\r\n    // Configure form based on account type\r\n    switch (accountType) {\r\n      case 'office365':\r\n        title.textContent = 'Configure Office 365 Account';\r\n        tenantConfig.style.display = 'block';\r\n        clientConfig.style.display = 'block';\r\n        break;\r\n      case 'gmail':\r\n        title.textContent = 'Configure Gmail Account';\r\n        tenantConfig.style.display = 'none';\r\n        clientConfig.style.display = 'block';\r\n        break;\r\n      case 'outlook_com':\r\n        title.textContent = 'Configure Outlook.com Account';\r\n        tenantConfig.style.display = 'none';\r\n        clientConfig.style.display = 'block';\r\n        break;\r\n      case 'exchange':\r\n        title.textContent = 'Configure Exchange Server';\r\n        tenantConfig.style.display = 'none';\r\n        clientConfig.style.display = 'none';\r\n        break;\r\n    }\r\n\r\n    form.style.display = 'block';\r\n    form.dataset.accountType = accountType;\r\n  }\r\n\r\n  /**\r\n   * Hide account configuration form\r\n   */\r\n  hideAccountConfigForm() {\r\n    document.getElementById('account-config-form').style.display = 'none';\r\n    \r\n    // Clear form\r\n    document.getElementById('account-email').value = '';\r\n    document.getElementById('account-display-name').value = '';\r\n    document.getElementById('tenant-id').value = '';\r\n    document.getElementById('client-id').value = '';\r\n  }\r\n\r\n  /**\r\n   * Save account configuration and initiate connection\r\n   */\r\n  async saveAccountConfiguration() {\r\n    const form = document.getElementById('account-config-form');\r\n    const accountType = form.dataset.accountType;\r\n    \r\n    const config = {\r\n      id: `account-${Date.now()}`,\r\n      type: accountType,\r\n      email: document.getElementById('account-email').value,\r\n      displayName: document.getElementById('account-display-name').value,\r\n      tenantId: document.getElementById('tenant-id').value,\r\n      clientId: document.getElementById('client-id').value\r\n    };\r\n\r\n    if (!config.email || !config.displayName) {\r\n      alert('Please fill in all required fields');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      console.log('🔗 Adding new account:', config);\r\n      \r\n      // Add account to manager\r\n      await this.manager.addAccount(config);\r\n      \r\n      // Hide form and refresh list\r\n      this.hideAccountConfigForm();\r\n      this.switchTab('overview');\r\n      this.refreshAccountsList();\r\n      \r\n      // Show success message\r\n      this.showMessage(`Successfully connected ${config.displayName}!`, 'success');\r\n      \r\n    } catch (error) {\r\n      console.error('❌ Failed to add account:', error);\r\n      this.showMessage(`Failed to connect account: ${error.message}`, 'error');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Load test accounts for demo\r\n   */\r\n  loadTestAccounts() {\r\n    console.log('🧪 Loading test accounts...');\r\n    this.manager.createMockAccounts();\r\n    this.refreshAccountsList();\r\n    this.showMessage('Test accounts loaded successfully!', 'success');\r\n  }\r\n\r\n  /**\r\n   * Refresh the accounts list display\r\n   */\r\n  refreshAccountsList() {\r\n    const accountsList = document.getElementById('accounts-list');\r\n    if (!accountsList) return;\r\n\r\n    const accounts = this.manager.getAccountsSummary();\r\n    \r\n    if (accounts.length === 0) {\r\n      accountsList.innerHTML = `\r\n        <div class=\"no-accounts\">\r\n          <div class=\"no-accounts-icon\">📅</div>\r\n          <h4>No accounts connected</h4>\r\n          <p>Add your first calendar account to start syncing</p>\r\n          <button onclick=\"document.querySelector('[data-tab=add-account]').click()\" class=\"btn-primary\">\r\n            Add Account\r\n          </button>\r\n        </div>\r\n      `;\r\n      return;\r\n    }\r\n\r\n    accountsList.innerHTML = accounts.map(account => `\r\n      <div class=\"account-item ${account.isAuthenticated ? 'authenticated' : 'not-authenticated'}\">\r\n        <div class=\"account-info\">\r\n          <div class=\"account-header\">\r\n            <span class=\"account-type-icon\">${this.getAccountTypeIcon(account.type)}</span>\r\n            <div class=\"account-details\">\r\n              <h4>${account.displayName}</h4>\r\n              <p>${account.email}</p>\r\n            </div>\r\n            <div class=\"account-status\">\r\n              ${account.isAuthenticated ? \r\n                '<span class=\"status-badge success\">✅ Connected</span>' : \r\n                '<span class=\"status-badge error\">❌ Disconnected</span>'\r\n              }\r\n            </div>\r\n          </div>\r\n          \r\n          <div class=\"account-stats\">\r\n            <span class=\"stat\">📅 ${account.calendarCount} calendars</span>\r\n            <span class=\"stat\">🔄 ${account.syncEnabled ? 'Sync enabled' : 'Sync disabled'}</span>\r\n            ${account.lastSync ? \r\n              `<span class=\"stat\">⏰ Last sync: ${new Date(account.lastSync).toLocaleTimeString()}</span>` : \r\n              '<span class=\"stat\">⏰ Never synced</span>'\r\n            }\r\n          </div>\r\n        </div>\r\n        \r\n        <div class=\"account-actions\">\r\n          <button class=\"btn-small\" onclick=\"multiAccountUI.configureAccount('${account.id}')\">\r\n            ⚙️ Configure\r\n          </button>\r\n          <button class=\"btn-small\" onclick=\"multiAccountUI.syncAccount('${account.id}')\">\r\n            🔄 Sync Now\r\n          </button>\r\n          <button class=\"btn-small danger\" onclick=\"multiAccountUI.removeAccount('${account.id}')\">\r\n            🗑️ Remove\r\n          </button>\r\n        </div>\r\n      </div>\r\n    `).join('');\r\n  }\r\n\r\n  /**\r\n   * Get icon for account type\r\n   */\r\n  getAccountTypeIcon(type) {\r\n    const icons = {\r\n      office365: '🏢',\r\n      gmail: '📧',\r\n      outlook_com: '📨',\r\n      exchange: '🏛️',\r\n      other: '📅'\r\n    };\r\n    return icons[type] || icons.other;\r\n  }\r\n\r\n  /**\r\n   * Sync all connected accounts\r\n   */\r\n  async syncAllAccounts() {\r\n    const syncBtn = document.getElementById('sync-all-btn');\r\n    const originalText = syncBtn.textContent;\r\n    \r\n    syncBtn.textContent = '🔄 Syncing...';\r\n    syncBtn.disabled = true;\r\n    \r\n    try {\r\n      // This would trigger the actual sync process\r\n      console.log('🔄 Starting sync for all accounts...');\r\n      \r\n      // Simulate sync process\r\n      await new Promise(resolve => setTimeout(resolve, 2000));\r\n      \r\n      this.showMessage('All accounts synchronized successfully!', 'success');\r\n      this.refreshAccountsList();\r\n      \r\n    } catch (error) {\r\n      console.error('❌ Sync failed:', error);\r\n      this.showMessage(`Sync failed: ${error.message}`, 'error');\r\n    } finally {\r\n      syncBtn.textContent = originalText;\r\n      syncBtn.disabled = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Show message to user\r\n   */\r\n  showMessage(message, type = 'info') {\r\n    // Create or update message element\r\n    let messageEl = document.getElementById('message-display');\r\n    if (!messageEl) {\r\n      messageEl = document.createElement('div');\r\n      messageEl.id = 'message-display';\r\n      messageEl.className = 'message-display';\r\n      document.querySelector('.multi-account-manager').prepend(messageEl);\r\n    }\r\n    \r\n    messageEl.className = `message-display ${type}`;\r\n    messageEl.textContent = message;\r\n    messageEl.style.display = 'block';\r\n    \r\n    // Auto-hide after 5 seconds\r\n    setTimeout(() => {\r\n      messageEl.style.display = 'none';\r\n    }, 5000);\r\n  }\r\n\r\n  /**\r\n   * Configure specific account\r\n   */\r\n  configureAccount(accountId) {\r\n    console.log(`⚙️ Configuring account: ${accountId}`);\r\n    // This would open account-specific configuration\r\n  }\r\n\r\n  /**\r\n   * Sync specific account\r\n   */\r\n  async syncAccount(accountId) {\r\n    console.log(`🔄 Syncing account: ${accountId}`);\r\n    // This would trigger sync for specific account\r\n  }\r\n\r\n  /**\r\n   * Remove account\r\n   */\r\n  removeAccount(accountId) {\r\n    if (confirm('Are you sure you want to remove this account?')) {\r\n      console.log(`🗑️ Removing account: ${accountId}`);\r\n      // This would remove the account from manager\r\n      this.refreshAccountsList();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Refresh sync status display\r\n   */\r\n  refreshSyncStatus() {\r\n    console.log('🔄 Refreshing sync status...');\r\n    // This would update the sync status tab with recent activity\r\n  }\r\n}\r\n\r\n// Export for global use\r\nwindow.MultiAccountUI = MultiAccountUI;\r\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office */\n\nimport { CalendarSyncManager } from './calendarSync.js';\nimport { MultiAccountUI } from './multiAccountUI.js';\n\nlet syncManager;\nlet multiAccountUI;\n\nOffice.onReady((info) => {\n  try {\n    console.log('🚀 Office.onReady called with info:', info);\n    console.log('📊 Office.js diagnostics:');\n    console.log('  - Office object type:', typeof Office);\n    console.log('  - Office.context type:', typeof Office?.context);\n    console.log('  - Office.context.auth type:', typeof Office?.context?.auth);\n    console.log('  - Host detected:', info?.host);\n    console.log('  - Host type comparison:', info?.host === Office.HostType.Outlook);\n    console.log('  - Platform:', info?.platform);\n    \n    // More permissive host check\n    if (info.host === Office.HostType.Outlook || info.host === 'Outlook' || window.Office) {\n      console.log('✅ Host validated as Outlook-compatible');\n      document.getElementById(\"sideload-msg\").style.display = \"none\";\n      document.getElementById(\"app-body\").style.display = \"flex\";\n      \n      // Set default date to August 12, 2025 for testing\n      const defaultDate = new Date('2025-08-12');\n      document.getElementById(\"sync-date\").value = defaultDate.toISOString().split('T')[0];\n      \n      // Initialize the calendar sync manager\n      syncManager = new CalendarSyncManager();\n      initializeApp();\n    } else {\n      console.warn('⚠️ Unsupported or unrecognized host application. Host info:', info);\n      // Show diagnostic info but try to continue\n      document.getElementById(\"sideload-msg\").innerHTML = `\n        <div style=\"color: orange; padding: 10px; border: 1px solid orange; border-radius: 5px;\">\n          <h3>🔍 Host Detection Diagnostic</h3>\n          <p><strong>Detected host:</strong> ${info?.host || 'Unknown'}</p>\n          <p><strong>Expected:</strong> Outlook</p>\n          <p><strong>Platform:</strong> ${info?.platform || 'Unknown'}</p>\n          <p><strong>Office.js available:</strong> ${!!window.Office ? 'Yes' : 'No'}</p>\n          <p><strong>Status:</strong> Attempting to continue with limited functionality...</p>\n          <button onclick=\"this.parentElement.style.display='none'; document.getElementById('app-body').style.display='flex';\">Continue Anyway</button>\n        </div>\n      `;\n      \n      // Try to initialize anyway for testing\n      setTimeout(() => {\n        try {\n          syncManager = new CalendarSyncManager();\n          initializeApp();\n        } catch (initError) {\n          console.error('❌ Delayed initialization failed:', initError);\n        }\n      }, 1000);\n    }\n  } catch (error) {\n    console.error('❌ Office.onReady error:', error);\n    document.getElementById(\"sideload-msg\").innerHTML = `\n      <div style=\"color: red; padding: 10px; border: 1px solid red; border-radius: 5px;\">\n        <h3>🚨 Initialization Error</h3>\n        <p><strong>Error:</strong> ${error.message}</p>\n        <p><strong>Suggestion:</strong> Please ensure this add-in is loaded within Outlook</p>\n        <p><strong>Current URL:</strong> ${window.location.href}</p>\n        <button onclick=\"location.reload();\">Refresh Page</button>\n        <button onclick=\"this.parentElement.style.display='none'; document.getElementById('app-body').style.display='flex';\">Try Anyway</button>\n      </div>\n    `;\n  }\n});\n\n// Fallback initialization if Office.onReady doesn't work\nwindow.addEventListener('DOMContentLoaded', () => {\n  setTimeout(() => {\n    if (!syncManager) {\n      console.log('🔄 Fallback initialization triggered - Office.onReady may not have fired');\n      console.log('🔍 Office.js status check:');\n      console.log('  - window.Office available:', !!window.Office);\n      console.log('  - Current URL:', window.location.href);\n      console.log('  - User Agent:', navigator.userAgent);\n      \n      if (window.Office) {\n        console.log('✅ Office.js detected, attempting manual initialization');\n        try {\n          document.getElementById(\"sideload-msg\").style.display = \"none\";\n          document.getElementById(\"app-body\").style.display = \"flex\";\n          \n          const defaultDate = new Date('2025-08-12');\n          document.getElementById(\"sync-date\").value = defaultDate.toISOString().split('T')[0];\n          \n          syncManager = new CalendarSyncManager();\n          initializeApp();\n        } catch (error) {\n          console.error('❌ Fallback initialization failed:', error);\n          showContextGuidance();\n        }\n      } else {\n        console.warn('⚠️ Office.js not available - showing context guidance');\n        showContextGuidance();\n      }\n    }\n  }, 2000); // Wait 2 seconds for Office.js to load\n});\n\nfunction showContextGuidance() {\n  document.getElementById(\"sideload-msg\").innerHTML = `\n    <div style=\"color: #d63031; padding: 15px; border: 1px solid #d63031; border-radius: 8px; margin: 10px;\">\n      <h3>🚨 Office.js Context Required</h3>\n      <p><strong>Issue:</strong> This add-in needs to run within Microsoft Outlook to access Office.js APIs.</p>\n      \n      <h4>📋 How to test this add-in properly:</h4>\n      <ol style=\"text-align: left; margin: 10px 0;\">\n        <li><strong>Deploy the manifest:</strong> Upload <code>manifest.xml</code> to Microsoft 365 Admin Center</li>\n        <li><strong>Open Outlook:</strong> Use Outlook desktop app or Outlook on the web</li>\n        <li><strong>Find the add-in:</strong> Look for \"Sync Calendars\" button in the ribbon</li>\n        <li><strong>Click to open:</strong> The add-in will load in a proper Office.js context</li>\n      </ol>\n      \n      <h4>🔧 For development testing:</h4>\n      <ul style=\"text-align: left; margin: 10px 0;\">\n        <li>Use <code>npm run dev-server</code> and sideload in Outlook</li>\n        <li>Or use Office Add-in Development Tools</li>\n        <li>Direct browser testing won't have full Office.js capabilities</li>\n      </ul>\n      \n      <p><strong>Current context:</strong> ${window.location.href}</p>\n      <button onclick=\"testMockMode();\" style=\"background: #0984e3; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin: 5px;\">\n        Test with Mock Data\n      </button>\n      <button onclick=\"location.reload();\" style=\"background: #636e72; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin: 5px;\">\n        Refresh\n      </button>\n    </div>\n  `;\n}\n\nfunction testMockMode() {\n  console.log('🧪 Enabling mock mode for testing without Office.js');\n  document.getElementById(\"sideload-msg\").style.display = \"none\";\n  document.getElementById(\"app-body\").style.display = \"flex\";\n  \n  const defaultDate = new Date('2025-08-12');\n  document.getElementById(\"sync-date\").value = defaultDate.toISOString().split('T')[0];\n  \n  // Initialize with mock-only mode\n  syncManager = new CalendarSyncManager();\n  initializeApp();\n}\n\nasync function initializeApp() {\n  try {\n    console.log('� Starting Multi-Tenant Calendar Sync initialization...');\n    \n    // Initialize the multi-account UI\n    if (window.multiTenantManager) {\n      multiAccountUI = new MultiAccountUI(window.multiTenantManager);\n      window.multiAccountUI = multiAccountUI; // Make globally available\n      multiAccountUI.initialize();\n      \n      // Hide the old sections and show the multi-account interface\n      const statusSection = document.getElementById('status-section');\n      const calendarSection = document.getElementById('calendar-section');\n      if (statusSection) statusSection.style.display = 'none';\n      if (calendarSection) calendarSection.style.display = 'none';\n      \n      console.log('✅ Multi-account interface initialized');\n    } else {\n      console.warn('⚠️ Multi-tenant manager not available, falling back to simple mode');\n      // Fall back to simple authentication\n      if (window.calendarAuth) {\n        window.calendarAuth.renderAuthenticationOptions();\n      }\n    }\n    \n    // Set up event listeners\n    setupEventListeners();\n    \n    // Initialize the calendar sync manager\n    await syncManager.initialize();\n    \n    // Update the display\n    updateSyncStatus('ready', 'Ready to sync');\n    \n    console.log('✅ Multi-tenant calendar sync initialized successfully');\n    \n  } catch (error) {\n    console.error('❌ App initialization failed:', error);\n    updateSyncStatus('error', `Initialization failed: ${error.message}`);\n    showContextGuidance();\n  }\n}\n\nfunction setupEventListeners() {\n  console.log('⚙️ Setting up event listeners...');\n  \n  // Diagnostic button\n  const diagnosticBtn = document.getElementById('run-diagnostic');\n  if (diagnosticBtn) {\n    diagnosticBtn.addEventListener('click', runCalendarDiagnostic);\n  }\n  \n  // Sync button\n  const syncBtn = document.getElementById('run-sync');\n  if (syncBtn) {\n    syncBtn.addEventListener('click', runSync);\n  }\n  \n  // Settings button  \n  const settingsBtn = document.getElementById('configure');\n  if (settingsBtn) {\n    settingsBtn.addEventListener('click', showSettings);\n  }\n  \n  console.log('✅ Event listeners set up');\n}\n\nasync function runCalendarDiagnostic() {\n  console.log('🔍 Running calendar discovery diagnostic...');\n  \n  const diagnosticBtn = document.getElementById('run-diagnostic');\n  const resultsDiv = document.getElementById('diagnostic-results');\n  \n  if (diagnosticBtn) {\n    diagnosticBtn.disabled = true;\n    diagnosticBtn.innerHTML = '<span class=\"ms-Button-label\">🔄 Checking...</span>';\n  }\n  \n  try {\n    const diagnostic = new CalendarDiscoveryDiagnostic();\n    const results = await diagnostic.runFullDiagnostic();\n    \n    // Update the results area\n    if (resultsDiv) {\n      const calendarCount = results.graphApiResults.calendarsFound.length;\n      const authSuccess = results.graphApiResults.accessTokenObtained;\n      \n      resultsDiv.innerHTML = `\n        <div class=\"diagnostic-summary\">\n          <h4>📊 Discovery Results:</h4>\n          <p><strong>Graph API Auth:</strong> ${authSuccess ? '✅ Working' : '❌ Failed'}</p>\n          <p><strong>Calendars Found:</strong> ${calendarCount} calendar(s)</p>\n          ${calendarCount > 0 ? `\n            <div class=\"calendar-list\">\n              <strong>Found calendars:</strong>\n              <ul>\n                ${results.graphApiResults.calendarsFound.map(cal => \n                  `<li>📅 ${cal.name} ${cal.isDefaultCalendar ? '(Default)' : ''}</li>`\n                ).join('')}\n              </ul>\n            </div>\n          ` : `\n            <p><em>This means Graph API can only see calendars from your current Office 365/Exchange account.</em></p>\n            <p><em>Connected accounts (Gmail, other Exchange) won't appear here.</em></p>\n          `}\n          <button id=\"add-external-calendar\" class=\"ms-Button\" style=\"margin-top: 10px;\">\n            <span class=\"ms-Button-label\">➕ Add External Calendar</span>\n          </button>\n        </div>\n      `;\n      \n      // Add event listener for external calendar button\n      const addExternalBtn = document.getElementById('add-external-calendar');\n      if (addExternalBtn) {\n        addExternalBtn.addEventListener('click', showAddExternalCalendar);\n      }\n    }\n    \n  } catch (error) {\n    console.error('❌ Diagnostic failed:', error);\n    if (resultsDiv) {\n      resultsDiv.innerHTML = `\n        <div class=\"error-message\">\n          <p><strong>❌ Diagnostic Failed:</strong> ${error.message}</p>\n          <p><em>This likely means you're not in a proper Office.js context or don't have the necessary permissions.</em></p>\n        </div>\n      `;\n    }\n  } finally {\n    if (diagnosticBtn) {\n      diagnosticBtn.disabled = false;\n      diagnosticBtn.innerHTML = '<span class=\"ms-Button-label\">🔍 Check My Calendars</span>';\n    }\n  }\n}\n\nfunction showAddExternalCalendar() {\n  const resultsDiv = document.getElementById('diagnostic-results');\n  if (!resultsDiv) return;\n  \n  resultsDiv.innerHTML += `\n    <div class=\"add-calendar-section\" style=\"margin-top: 15px; padding: 10px; border: 1px solid #ccc; border-radius: 5px;\">\n      <h4>➕ Add External Calendar</h4>\n      <p>To sync calendars from other accounts, choose an option:</p>\n      \n      <div class=\"calendar-options\">\n        <button class=\"calendar-type-btn\" onclick=\"addGoogleCalendar()\">\n          📧 Google Calendar\n        </button>\n        <button class=\"calendar-type-btn\" onclick=\"addOutlookCalendar()\">\n          📮 Outlook.com/Hotmail\n        </button>\n        <button class=\"calendar-type-btn\" onclick=\"addExchangeCalendar()\">\n          🏢 Exchange Server\n        </button>\n        <button class=\"calendar-type-btn\" onclick=\"addICSCalendar()\">\n          🔗 ICS/WebCal URL\n        </button>\n      </div>\n      \n      <div id=\"calendar-form-container\" style=\"margin-top: 10px;\">\n        <!-- Calendar form will be inserted here -->\n      </div>\n    </div>\n  `;\n}\n\nasync function loadCalendars() {\n  try {\n    const calendars = await syncManager.getAvailableCalendars();\n    displayCalendars(calendars);\n  } catch (error) {\n    console.error('Failed to load calendars:', error);\n    document.getElementById('calendar-list').innerHTML = \n      '<div class=\"error\">Failed to load calendars. Please check permissions.</div>';\n  }\n}\n\nfunction displayCalendars(calendars) {\n  const calendarList = document.getElementById('calendar-list');\n  \n  if (calendars.length === 0) {\n    calendarList.innerHTML = '<div class=\"no-activity\">No calendars found</div>';\n    return;\n  }\n  \n  calendarList.innerHTML = calendars.map(calendar => `\n    <div class=\"calendar-item\">\n      <div>\n        <div class=\"calendar-name\">${calendar.name}</div>\n        <div class=\"calendar-status\">${calendar.type} • ${calendar.itemCount} items</div>\n      </div>\n      <div class=\"calendar-toggle\">\n        <div class=\"toggle-switch ${calendar.syncEnabled ? 'active' : ''}\" \n             data-calendar-id=\"${calendar.id}\"\n             onclick=\"toggleCalendarSync('${calendar.id}')\">\n        </div>\n      </div>\n    </div>\n  `).join('');\n}\n\nasync function handleSyncNow() {\n  try {\n    // Get the selected date\n    const selectedDate = document.getElementById(\"sync-date\").value;\n    if (!selectedDate) {\n      updateStatus('Error', 'Please select a date to sync');\n      return;\n    }\n    \n    const syncDate = new Date(selectedDate);\n    updateStatus('Syncing', `Syncing ${syncDate.toLocaleDateString()}...`);\n    updateSyncButton(true);\n    \n    // Pass the selected date to the sync manager\n    const result = await syncManager.performSync(syncDate);\n    \n    updateStatus('Active', `Sync completed for ${syncDate.toLocaleDateString()}. ${result.blocksCreated} blocks created, ${result.blocksRemoved} removed.`);\n    addActivityLog(`Sync completed for ${syncDate.toLocaleDateString()}: ${result.blocksCreated} created, ${result.blocksRemoved} removed`);\n    \n  } catch (error) {\n    console.error('Sync failed:', error);\n    updateStatus('Error', `Sync failed: ${error.message}`);\n    addActivityLog(`Sync failed: ${error.message}`);\n  } finally {\n    updateSyncButton(false);\n  }\n}\n\nasync function handleConfigure() {\n  // TODO: Open configuration dialog\n  console.log('Configure clicked');\n}\n\nasync function toggleCalendarSync(calendarId) {\n  try {\n    const enabled = await syncManager.toggleCalendarSync(calendarId);\n    \n    // Update the toggle switch appearance\n    const toggle = document.querySelector(`[data-calendar-id=\"${calendarId}\"]`);\n    if (toggle) {\n      toggle.classList.toggle('active', enabled);\n    }\n    \n    addActivityLog(`Calendar sync ${enabled ? 'enabled' : 'disabled'} for calendar`);\n    \n  } catch (error) {\n    console.error('Failed to toggle calendar sync:', error);\n    addActivityLog(`Failed to toggle calendar sync: ${error.message}`);\n  }\n}\n\nasync function updateSyncStatus() {\n  try {\n    const status = await syncManager.getSyncStatus();\n    updateStatus(status.state, status.message);\n    \n    if (status.lastSync) {\n      document.getElementById('last-sync').textContent = \n        `Last sync: ${new Date(status.lastSync).toLocaleString()}`;\n    }\n    \n  } catch (error) {\n    console.error('Failed to get sync status:', error);\n    updateStatus('Error', 'Unable to check sync status');\n  }\n}\n\nfunction updateStatus(state, message) {\n  const statusDot = document.getElementById('status-dot');\n  const statusText = document.getElementById('status-text');\n  \n  // Remove all state classes\n  statusDot.classList.remove('active', 'syncing');\n  \n  // Add appropriate class\n  switch (state.toLowerCase()) {\n    case 'active':\n      statusDot.classList.add('active');\n      break;\n    case 'syncing':\n      statusDot.classList.add('syncing');\n      break;\n    default:\n      // Default red color for error/stopped\n      break;\n  }\n  \n  statusText.textContent = message;\n}\n\nfunction updateSyncButton(isDisabled) {\n  const button = document.getElementById('sync-now');\n  const label = button.querySelector('.ms-Button-label');\n  \n  button.style.opacity = isDisabled ? '0.6' : '1';\n  button.style.pointerEvents = isDisabled ? 'none' : 'auto';\n  label.textContent = isDisabled ? 'Syncing...' : 'Sync Now';\n}\n\nfunction addActivityLog(message) {\n  const activityLog = document.getElementById('activity-log');\n  const noActivity = activityLog.querySelector('.no-activity');\n  \n  if (noActivity) {\n    noActivity.remove();\n  }\n  \n  const activityItem = document.createElement('div');\n  activityItem.className = 'activity-item';\n  activityItem.innerHTML = `\n    <div class=\"activity-time\">${new Date().toLocaleTimeString()}</div>\n    <div>${message}</div>\n  `;\n  \n  activityLog.insertBefore(activityItem, activityLog.firstChild);\n  \n  // Keep only the last 10 items\n  const items = activityLog.querySelectorAll('.activity-item');\n  if (items.length > 10) {\n    items[items.length - 1].remove();\n  }\n}\n\n// Make toggle function globally available\nwindow.toggleCalendarSync = toggleCalendarSync;\n\n// Global functions for calendar addition (called from onclick handlers)\nwindow.addGoogleCalendar = function() {\n  showCalendarForm('google', 'Google Calendar', {\n    fields: [\n      { name: 'email', label: 'Google Account Email', type: 'email', required: true },\n      { name: 'calendarId', label: 'Calendar ID (optional - leave blank for primary)', type: 'text', required: false }\n    ],\n    instructions: 'You\\'ll need to authenticate with Google Calendar API. We\\'ll redirect you to Google for permission.'\n  });\n};\n\nwindow.addOutlookCalendar = function() {\n  showCalendarForm('outlook', 'Outlook.com/Hotmail', {\n    fields: [\n      { name: 'email', label: 'Outlook.com Email', type: 'email', required: true },\n      { name: 'calendarName', label: 'Calendar Name (optional)', type: 'text', required: false }\n    ],\n    instructions: 'We\\'ll authenticate with Microsoft Graph API for your personal Outlook.com account.'\n  });\n};\n\nwindow.addExchangeCalendar = function() {\n  showCalendarForm('exchange', 'Exchange Server', {\n    fields: [\n      { name: 'email', label: 'Exchange Email', type: 'email', required: true },\n      { name: 'serverUrl', label: 'Exchange Server URL', type: 'url', required: true, placeholder: 'https://mail.company.com/ews/exchange.asmx' },\n      { name: 'domain', label: 'Domain (optional)', type: 'text', required: false }\n    ],\n    instructions: 'We\\'ll connect to your Exchange server using EWS (Exchange Web Services).'\n  });\n};\n\nwindow.addICSCalendar = function() {\n  showCalendarForm('ics', 'ICS/WebCal Calendar', {\n    fields: [\n      { name: 'name', label: 'Calendar Name', type: 'text', required: true },\n      { name: 'url', label: 'Calendar URL', type: 'url', required: true, placeholder: 'https://calendar.google.com/calendar/ical/...ics' },\n      { name: 'refreshInterval', label: 'Refresh Interval (minutes)', type: 'number', required: false, value: '60' }\n    ],\n    instructions: 'Enter the ICS or WebCal URL. This is read-only and will be refreshed periodically.'\n  });\n};\n\nfunction showCalendarForm(type, typeName, config) {\n  const container = document.getElementById('calendar-form-container');\n  if (!container) return;\n  \n  const fieldsHtml = config.fields.map(field => `\n    <div class=\"form-field\" style=\"margin: 10px 0;\">\n      <label for=\"${field.name}\" style=\"display: block; font-weight: bold; margin-bottom: 5px;\">\n        ${field.label} ${field.required ? '*' : ''}\n      </label>\n      <input \n        type=\"${field.type}\" \n        id=\"${field.name}\" \n        name=\"${field.name}\"\n        placeholder=\"${field.placeholder || ''}\"\n        value=\"${field.value || ''}\"\n        ${field.required ? 'required' : ''}\n        style=\"width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;\"\n      />\n    </div>\n  `).join('');\n  \n  container.innerHTML = `\n    <div class=\"calendar-form\">\n      <h5>📝 Add ${typeName}</h5>\n      <p style=\"font-size: 0.9em; color: #666;\">${config.instructions}</p>\n      \n      <form id=\"add-calendar-form\">\n        <input type=\"hidden\" name=\"type\" value=\"${type}\" />\n        ${fieldsHtml}\n        \n        <div class=\"form-actions\" style=\"margin-top: 15px;\">\n          <button type=\"submit\" class=\"ms-Button ms-Button--primary\">\n            <span class=\"ms-Button-label\">🔗 Connect Calendar</span>\n          </button>\n          <button type=\"button\" onclick=\"cancelCalendarForm()\" class=\"ms-Button\" style=\"margin-left: 10px;\">\n            <span class=\"ms-Button-label\">Cancel</span>\n          </button>\n        </div>\n      </form>\n    </div>\n  `;\n  \n  // Add form submit handler\n  const form = document.getElementById('add-calendar-form');\n  if (form) {\n    form.addEventListener('submit', handleCalendarFormSubmit);\n  }\n}\n\nwindow.cancelCalendarForm = function() {\n  const container = document.getElementById('calendar-form-container');\n  if (container) {\n    container.innerHTML = '';\n  }\n};\n\nasync function handleCalendarFormSubmit(event) {\n  event.preventDefault();\n  \n  const formData = new FormData(event.target);\n  const calendarData = {};\n  \n  for (let [key, value] of formData.entries()) {\n    calendarData[key] = value;\n  }\n  \n  console.log('📝 Calendar form submitted:', calendarData);\n  \n  try {\n    // Show loading state\n    const submitBtn = event.target.querySelector('button[type=\"submit\"]');\n    if (submitBtn) {\n      submitBtn.disabled = true;\n      submitBtn.innerHTML = '<span class=\"ms-Button-label\">🔄 Connecting...</span>';\n    }\n    \n    // Process the calendar addition based on type\n    await addExternalCalendarConnection(calendarData);\n    \n    // Success\n    const container = document.getElementById('calendar-form-container');\n    if (container) {\n      container.innerHTML = `\n        <div class=\"success-message\" style=\"color: green; padding: 10px; border: 1px solid green; border-radius: 4px;\">\n          ✅ Calendar \"${calendarData.name || calendarData.email}\" has been added successfully!\n          <button onclick=\"runCalendarDiagnostic()\" style=\"margin-left: 10px;\">Refresh List</button>\n        </div>\n      `;\n    }\n    \n  } catch (error) {\n    console.error('❌ Failed to add calendar:', error);\n    \n    const container = document.getElementById('calendar-form-container');\n    if (container) {\n      container.innerHTML = `\n        <div class=\"error-message\" style=\"color: red; padding: 10px; border: 1px solid red; border-radius: 4px;\">\n          ❌ Failed to add calendar: ${error.message}\n          <button onclick=\"showAddExternalCalendar()\" style=\"margin-left: 10px;\">Try Again</button>\n        </div>\n      `;\n    }\n  }\n}\n\nasync function addExternalCalendarConnection(calendarData) {\n  console.log(`🔗 Adding ${calendarData.type} calendar:`, calendarData);\n  \n  // For now, just store the connection info - we'll implement actual connections later\n  const calendarInfo = {\n    id: `${calendarData.type}-${Date.now()}`,\n    type: calendarData.type,\n    name: calendarData.name || `${calendarData.type} (${calendarData.email})`,\n    email: calendarData.email,\n    ...calendarData,\n    status: 'pending_implementation',\n    added: new Date().toISOString()\n  };\n  \n  // Store in localStorage for now\n  const existingCalendars = JSON.parse(localStorage.getItem('externalCalendars') || '[]');\n  existingCalendars.push(calendarInfo);\n  localStorage.setItem('externalCalendars', JSON.stringify(existingCalendars));\n  \n  console.log(`📅 ${calendarData.type} Calendar connection prepared:`, calendarInfo);\n  \n  return calendarInfo;\n}\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"./multiAccount.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_2___ = new URL(\"../../assets/logo-filled.png\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_3___ = new URL(\"./calendarDiagnostic.js\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_4___ = new URL(\"./multiTenantManager.js\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_5___ = new URL(\"./multiAccountUI.js\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_6___ = new URL(\"./simpleAuth.js\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_7___ = new URL(\"./calendarSync.js\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_8___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>MultiCalendar Sync</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <header class=\\\"ms-welcome__header ms-bgColor-neutralLighter\\\"> <img width=\\\"90\\\" height=\\\"90\\\" src=\\\"\" + ___HTML_LOADER_IMPORT_2___ + \"\\\" alt=\\\"MultiCalendar\\\" title=\\\"MultiCalendar\\\"/> <h1 class=\\\"ms-font-su\\\">Calendar Sync</h1> </header> <section id=\\\"sideload-msg\\\" class=\\\"ms-welcome__main\\\"> <h2 class=\\\"ms-font-xl\\\">Please <a target=\\\"_blank\\\" href=\\\"https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing\\\">sideload</a> your add-in to see app body.</h2> </section> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\" style=\\\"display:none\\\"> <div class=\\\"sync-container\\\"> <h2 class=\\\"ms-font-xl\\\">Multi-Calendar Synchronization</h2> <p class=\\\"ms-font-m\\\">Keep your availability consistent across all calendars</p> <div id=\\\"auth-container\\\" class=\\\"auth-section\\\"> <div class=\\\"diagnostic-section\\\"> <h3>🔍 Calendar Discovery</h3> <p>Let's see what calendars are available in your Outlook:</p> <button id=\\\"run-diagnostic\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\">🔍 Check My Calendars</span> </button> <div id=\\\"diagnostic-results\\\" style=\\\"margin-top:10px\\\"></div> </div> </div> <div class=\\\"status-section\\\" style=\\\"display:none\\\" id=\\\"status-section\\\"> <h3 class=\\\"ms-font-l\\\">Sync Status</h3> <div id=\\\"sync-status\\\" class=\\\"status-indicator\\\"> <span class=\\\"status-dot\\\" id=\\\"status-dot\\\"></span> <span id=\\\"status-text\\\">Checking...</span> </div> <div id=\\\"last-sync\\\" class=\\\"ms-font-s\\\"></div> </div> <div class=\\\"calendar-section\\\" style=\\\"display:none\\\" id=\\\"calendar-section\\\"> <h3 class=\\\"ms-font-l\\\">Connected Calendars</h3> <div id=\\\"calendar-list\\\" class=\\\"calendar-list\\\"> <div class=\\\"loading\\\">Loading calendars...</div> </div> </div> <div class=\\\"controls-section\\\"> <div class=\\\"date-selection\\\"> <label for=\\\"sync-date\\\" class=\\\"ms-font-m\\\">Select Date to Sync:</label> <input type=\\\"date\\\" id=\\\"sync-date\\\" class=\\\"date-picker\\\"/> </div> <div role=\\\"button\\\" id=\\\"sync-now\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\">Sync Selected Date</span> </div> <div role=\\\"button\\\" id=\\\"configure\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\">Settings</span> </div> </div> <div class=\\\"activity-section\\\"> <h3 class=\\\"ms-font-l\\\">Recent Activity</h3> <div id=\\\"activity-log\\\" class=\\\"activity-log\\\"> <div class=\\\"no-activity\\\">No recent activity</div> </div> </div> </div> </main> <\" + \"script id=\\\"context-guidance-template\\\" type=\\\"text/html\\\"> <div class=\\\"context-help\\\">\\n            <h2>🔧 Setup Required</h2>\\n            <p>To use this calendar sync tool, you need to:</p>\\n            <ol>\\n                <li><strong>Open in Outlook:</strong> This add-in works in Outlook desktop, web, or mobile</li>\\n                <li><strong>Install the add-in:</strong> Deploy through Microsoft 365 Admin Center</li>\\n                <li><strong>No Azure registrations needed:</strong> We'll use simplified authentication</li>\\n            </ol>\\n            <button onclick=\\\"window.calendarAuth.useMockMode()\\\" class=\\\"ms-Button ms-Button--primary\\\">\\n                <span class=\\\"ms-Button-label\\\">🧪 Try Demo Mode</span>\\n            </button>\\n        </div> <\" + \"/script> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_3___ + \"\\\"><\" + \"/script> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_4___ + \"\\\"><\" + \"/script> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_5___ + \"\\\"><\" + \"/script> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_6___ + \"\\\"><\" + \"/script> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_7___ + \"\\\"><\" + \"/script> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_8___ + \"\\\"><\" + \"/script> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_defineProperties","_toPropertyKey","key","_typeof","toPrimitive","String","_toPrimitive","CalendarSyncManager","_classCallCheck","syncEnabled","calendars","Map","syncInterval","lastSync","syncInProgress","config","syncIntervalMinutes","busyBlockSubject","busyBlockCategory","lookAheadDays","lookBehindDays","_initialize","_callee","_Office$context","_t","_context","console","log","Office","context","mailbox","warn","requestPermissions","loadConfiguration","discoverCalendars","startAutoSync","error","_requestPermissions","_callee2","_context2","reject","diagnostics","hostName","hostVersion","platform","savedConfig","localStorage","getItem","parsed","JSON","parse","_objectSpread","setItem","stringify","toString","_discoverCalendars","_callee3","_t2","_t3","_this","_context3","getGraphCalendars","clear","forEach","cal","set","id","concat","size","Array","from","values","name","userEmail","isDefaultCalendar","tryAlternativeDiscovery","discoverEnhancedMockCalendars","_tryAlternativeDiscovery","_callee4","accessToken","profileResponse","profile","calResponse","errorText","calData","_this2","_context4","getGraphAccessToken","fetch","headers","ok","status","statusText","json","mail","userPrincipalName","text","map","graphCal","_graphCal$owner","owner","emailAddress","address","type","canEdit","_discoverEnhancedMockCalendars","_callee5","mockCalendars","_this3","_context5","_getGraphCalendars","_callee6","userProfile","primaryEmail","calendarResponse","calendarData","additionalCalendars","groupResponse","_groupData$value","groupData","allCalendars","uniqueCalendars","_t4","_t5","_context6","group","push","_toConsumableArray","message","filter","index","findIndex","_graphCal$owner2","ownerEmail","_getGraphAccessToken","_callee7","_Office","_Office2","_Office3","_Office4","_Office5","_t6","_context7","auth","getAccessToken","host","requirements","tokenOptions","allowSignInPrompt","allowConsentPrompt","forMSGraphAccess","result","AsyncResultStatus","Succeeded","substring","_result$error","_result$error2","_result$error3","_result$error4","_result$error5","_result$error6","_result$error7","_result$error8","_result$error9","_result$error0","_result$error1","code","tracing","errorMsg","_discoverMockCalendars","_callee8","_this4","_context8","_getAvailableCalendars","_callee9","_context9","_toggleCalendarSync","_callee0","calendarId","calendar","_context0","get","saveConfiguration","_x","_performSync","_callee1","targetDate","syncDate","enabledCalendars","busyTimes","removedBlocks","createdBlocks","_t7","_args1","_context1","Date","toLocaleDateString","setHours","getBusyTimesFromCalendars","removeExistingSyncBlocks","createSyncBlocks","blocksCreated","blocksRemoved","syncTime","_getBusyTimesFromCalendars","_callee10","_iterator","_step","calendarBusyTimes","simulatedTimes","_t8","_t9","_context10","_createForOfIteratorHelper","s","getRealBusyTimes","simulateGetBusyTimes","_x2","_getRealBusyTimes","_callee11","startTime","endTime","eventsUrl","response","data","_t0","_context11","toISOString","event","showAs","start","dateTime","end","subject","isPrivate","_x3","_simulateGetBusyTimes","_callee12","now","duration","_context12","setTimeout","Math","floor","random","getTime","_x4","_removeExistingSyncBlocks","_callee13","removedCount","_iterator2","_step2","removed","_t1","_t10","_context13","simulateRemoveSyncBlocks","_x5","_simulateRemoveSyncBlocks","_callee14","_context14","_x6","_createSyncBlocks","_callee15","createdCount","_iterator3","_step3","targetCalendar","blocksToCreate","_iterator4","_step4","_step4$value","sourceCalendarId","times","created","_t11","_t12","_context15","_slicedToArray","err","simulateCreateSyncBlocks","_x7","_x8","_simulateCreateSyncBlocks","_callee16","calendarInfo","_t13","_context16","createRealSyncBlocks","_x9","_x0","_createRealSyncBlocks","_callee17","_iterator5","_step5","busyTime","eventData","_t14","_t15","_context17","timeZone","Intl","DateTimeFormat","resolvedOptions","categories","body","contentType","content","method","toLocaleTimeString","_x1","_x10","_this5","clearInterval","intervalMs","setInterval","performSync","catch","_getSyncStatus","_callee18","enabledCount","_context18","state","minutes","days","syncManager","multiAccountUI","MultiAccountUI","multiTenantManager","manager","currentView","createAccountManagementUI","bindEvents","refreshAccountsList","container","getElementById","createElement","innerHTML","appendChild","_document$getElementB","_document$getElementB2","_document$getElementB3","_document$getElementB4","querySelectorAll","btn","addEventListener","switchTab","target","dataset","tab","card","button","closest","querySelector","click","stopPropagation","accountType","showAccountConfigForm","saveAccountConfiguration","hideAccountConfigForm","syncAllAccounts","loadTestAccounts","tabName","classList","toggle","refreshSyncStatus","form","title","tenantConfig","clientConfig","textContent","style","display","_saveAccountConfiguration","email","tenantId","clientId","alert","addAccount","showMessage","createMockAccounts","accountsList","accounts","getAccountsSummary","account","isAuthenticated","getAccountTypeIcon","calendarCount","join","icons","office365","gmail","outlook_com","exchange","other","_syncAllAccounts","syncBtn","originalText","disabled","messageEl","className","prepend","accountId","_syncAccount","confirm","constructor","showContextGuidance","initializeApp","_initializeApp","statusSection","calendarSection","initialize","calendarAuth","renderAuthenticationOptions","setupEventListeners","updateSyncStatus","diagnosticBtn","runCalendarDiagnostic","runSync","settingsBtn","showSettings","_runCalendarDiagnostic","resultsDiv","diagnostic","results","authSuccess","addExternalBtn","CalendarDiscoveryDiagnostic","runFullDiagnostic","graphApiResults","calendarsFound","accessTokenObtained","showAddExternalCalendar","enabled","toggleCalendarSync","addActivityLog","_updateSyncStatus","getSyncStatus","updateStatus","toLocaleString","statusDot","remove","toLowerCase","add","activityLog","noActivity","activityItem","insertBefore","firstChild","items","showCalendarForm","typeName","fieldsHtml","fields","field","label","required","placeholder","instructions","handleCalendarFormSubmit","_handleCalendarFormSubmit","formData","_step$value","submitBtn","_container","preventDefault","FormData","entries","addExternalCalendarConnection","_addExternalCalendarConnection","existingCalendars","added","onReady","info","HostType","Outlook","defaultDate","split","initError","navigator","userAgent","addGoogleCalendar","addOutlookCalendar","addExchangeCalendar","addICSCalendar","cancelCalendarForm","URL"],"sourceRoot":""}